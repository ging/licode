var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(k){var n=function(){};n.prototype=k;return new n};$jscomp.underscoreProtoCanBeSet=function(){var k={a:!0},n={};try{return n.__proto__=k,n.a}catch(h){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(k,n){k.__proto__=n;if(k.__proto__!==n)throw new TypeError(k+" is not extensible");return k}:null;
$jscomp.inherits=function(k,n){k.prototype=$jscomp.objectCreate(n.prototype);k.prototype.constructor=k;if($jscomp.setPrototypeOf){var h=$jscomp.setPrototypeOf;h(k,n)}else for(h in n)if("prototype"!=h)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(n,h);d&&Object.defineProperty(k,h,d)}else k[h]=n[h];k.superClass_=n.prototype};
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(k,n,h){k!=Array.prototype&&k!=Object.prototype&&(k[n]=h.value)};$jscomp.getGlobal=function(k){return"undefined"!=typeof window&&window===k?k:"undefined"!=typeof global&&null!=global?global:k};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.Symbol=function(){var k=0;return function(n){return $jscomp.SYMBOL_PREFIX+(n||"")+k++}}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var k=$jscomp.global.Symbol.iterator;k||(k=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[k]&&$jscomp.defineProperty(Array.prototype,k,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(k){var n=0;return $jscomp.iteratorPrototype(function(){return n<k.length?{done:!1,value:k[n++]}:{done:!0}})};$jscomp.iteratorPrototype=function(k){$jscomp.initSymbolIterator();k={next:k};k[$jscomp.global.Symbol.iterator]=function(){return this};return k};$jscomp.makeIterator=function(k){$jscomp.initSymbolIterator();var n=k[Symbol.iterator];return n?n.call(k):$jscomp.arrayIterator(k)};
$jscomp.arrayFromIterator=function(k){for(var n,h=[];!(n=k.next()).done;)h.push(n.value);return h};$jscomp.arrayFromIterable=function(k){return k instanceof Array?k:$jscomp.arrayFromIterator($jscomp.makeIterator(k))};$jscomp.polyfill=function(k,n,h,d){if(n){h=$jscomp.global;k=k.split(".");for(d=0;d<k.length-1;d++){var e=k[d];e in h||(h[e]={});h=h[e]}k=k[k.length-1];d=h[k];n=n(d);n!=d&&null!=n&&$jscomp.defineProperty(h,k,{configurable:!0,writable:!0,value:n})}};
$jscomp.polyfill("Array.from",function(k){return k?k:function(k,h,d){$jscomp.initSymbolIterator();h=null!=h?h:function(a){return a};var e=[],b=k[Symbol.iterator];if("function"==typeof b){k=b.call(k);for(var a=0;!(b=k.next()).done;)e.push(h.call(d,b.value,a++))}else for(b=k.length,a=0;a<b;a++)e.push(h.call(d,k[a],a));return e}},"es6","es3");
$jscomp.iteratorFromArray=function(k,n){$jscomp.initSymbolIterator();k instanceof String&&(k+="");var h=0,d={next:function(){if(h<k.length){var e=h++;return{value:n(e,k[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(k){return k?k:function(){return $jscomp.iteratorFromArray(this,function(k){return k})}},"es6","es3");
$jscomp.checkEs6ConformanceViaProxy=function(){try{var k={},n=Object.create(new $jscomp.global.Proxy(k,{get:function(h,d,e){return h==k&&"q"==d&&e==n}}));return!0===n.q}catch(h){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.owns=function(k,n){return Object.prototype.hasOwnProperty.call(k,n)};
$jscomp.polyfill("WeakMap",function(k){function n(){if(!k||!Object.seal)return!1;try{var a=Object.seal({}),g=Object.seal({}),c=new k([[a,2],[g,3]]);if(2!=c.get(a)||3!=c.get(g))return!1;c.delete(a);c.set(g,4);return!c.has(a)&&4==c.get(g)}catch(f){return!1}}function h(a){$jscomp.owns(a,e)||$jscomp.defineProperty(a,e,{value:{}})}function d(a){var g=Object[a];g&&(Object[a]=function(c){h(c);return g(c)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(k&&$jscomp.ES6_CONFORMANCE)return k}else if(n())return k;
var e="$jscomp_hidden_"+Math.random();d("freeze");d("preventExtensions");d("seal");var b=0,a=function(a){this.id_=(b+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var g;!(g=a.next()).done;)g=g.value,this.set(g[0],g[1])}};a.prototype.set=function(a,g){h(a);if(!$jscomp.owns(a,e))throw Error("WeakMap key fail: "+a);a[e][this.id_]=g;return this};a.prototype.get=function(a){return $jscomp.owns(a,e)?a[e][this.id_]:void 0};a.prototype.has=
function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)};a.prototype.delete=function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)?delete a[e][this.id_]:!1};return a},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(k){function n(){if($jscomp.ASSUME_NO_NATIVE_MAP||!k||"function"!=typeof k||!k.prototype.entries||"function"!=typeof Object.seal)return!1;try{var g=Object.seal({x:4}),c=new k($jscomp.makeIterator([[g,"s"]]));if("s"!=c.get(g)||1!=c.size||c.get({x:4})||c.set({x:4},"t")!=c||2!=c.size)return!1;var f=c.entries(),a=f.next();if(a.done||a.value[0]!=g||"s"!=a.value[1])return!1;a=f.next();return a.done||4!=a.value[0].x||"t"!=a.value[1]||!f.next().done?!1:!0}catch(l){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(k&&$jscomp.ES6_CONFORMANCE)return k}else if(n())return k;$jscomp.initSymbol();$jscomp.initSymbolIterator();var h=new WeakMap,d=function(g){this.data_={};this.head_=a();this.size=0;if(g){g=$jscomp.makeIterator(g);for(var c;!(c=g.next()).done;)c=c.value,this.set(c[0],c[1])}};d.prototype.set=function(g,c){g=0===g?0:g;var f=e(this,g);f.list||(f.list=this.data_[f.id]=[]);f.entry?f.entry.value=c:(f.entry={next:this.head_,previous:this.head_.previous,head:this.head_,
key:g,value:c},f.list.push(f.entry),this.head_.previous.next=f.entry,this.head_.previous=f.entry,this.size++);return this};d.prototype.delete=function(g){g=e(this,g);return g.entry&&g.list?(g.list.splice(g.index,1),g.list.length||delete this.data_[g.id],g.entry.previous.next=g.entry.next,g.entry.next.previous=g.entry.previous,g.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=a();this.size=0};d.prototype.has=function(g){return!!e(this,g).entry};
d.prototype.get=function(g){return(g=e(this,g).entry)&&g.value};d.prototype.entries=function(){return b(this,function(g){return[g.key,g.value]})};d.prototype.keys=function(){return b(this,function(g){return g.key})};d.prototype.values=function(){return b(this,function(g){return g.value})};d.prototype.forEach=function(g,c){for(var f=this.entries(),a;!(a=f.next()).done;)a=a.value,g.call(c,a[1],a[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var e=function(a,c){var f=c&&typeof c;"object"==
f||"function"==f?h.has(c)?f=h.get(c):(f=""+ ++w,h.set(c,f)):f="p_"+c;var g=a.data_[f];if(g&&$jscomp.owns(a.data_,f))for(a=0;a<g.length;a++){var l=g[a];if(c!==c&&l.key!==l.key||c===l.key)return{id:f,list:g,index:a,entry:l}}return{id:f,list:g,index:-1,entry:void 0}},b=function(a,c){var f=a.head_;return $jscomp.iteratorPrototype(function(){if(f){for(;f.head!=a.head_;)f=f.previous;for(;f.next!=f.head;)return f=f.next,{done:!1,value:c(f)};f=null}return{done:!0,value:void 0}})},a=function(){var a={};return a.previous=
a.next=a.head=a},w=0;return d},"es6","es3");$jscomp.polyfill("Array.prototype.values",function(k){return k?k:function(){return $jscomp.iteratorFromArray(this,function(k,h){return h})}},"es8","es3");$jscomp.findInternal=function(k,n,h){k instanceof String&&(k=String(k));for(var d=k.length,e=0;e<d;e++){var b=k[e];if(n.call(h,b,e,k))return{i:e,v:b}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(k){return k?k:function(k,h){return $jscomp.findInternal(this,k,h).v}},"es6","es3");
$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(k){function n(){this.batch_=null}function h(a){return a instanceof e?a:new e(function(b,g){b(a)})}if(k&&!$jscomp.FORCE_POLYFILL_PROMISE)return k;n.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};n.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var d=$jscomp.global.setTimeout;n.prototype.asyncExecuteFunction=function(a){d(a,
0)};n.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var g=a[b];a[b]=null;try{g()}catch(c){this.asyncThrow_(c)}}}this.batch_=null};n.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(g){b.reject(g)}};e.prototype.createResolveAndReject_=
function(){function a(c){return function(f){g||(g=!0,c.call(b,f))}}var b=this,g=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(g){this.reject_(g);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
0;a<this.onSettledCallbacks_.length;++a)b.asyncExecute(this.onSettledCallbacks_[a]);this.onSettledCallbacks_=null}};var b=new n;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var g=this.createResolveAndReject_();try{a.call(b,g.resolve,g.reject)}catch(c){g.reject(c)}};e.prototype.then=function(a,b){function g(a,g){return"function"==typeof a?function(g){try{c(a(g))}catch(x){f(x)}}:
g}var c,f,d=new e(function(a,g){c=a;f=g});this.callWhenSettled_(g(a,c),g(b,f));return d};e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,d){function g(){switch(c.state_){case 1:a(c.result_);break;case 2:d(c.result_);break;default:throw Error("Unexpected state: "+c.state_);}}var c=this;null==this.onSettledCallbacks_?b.asyncExecute(g):this.onSettledCallbacks_.push(g)};e.resolve=h;e.reject=function(a){return new e(function(b,g){g(a)})};e.race=function(a){return new e(function(b,
g){for(var c=$jscomp.makeIterator(a),f=c.next();!f.done;f=c.next())h(f.value).callWhenSettled_(b,g)})};e.all=function(a){var b=$jscomp.makeIterator(a),g=b.next();return g.done?h([]):new e(function(c,f){function a(f){return function(a){l[f]=a;d--;0==d&&c(l)}}var l=[],d=0;do l.push(void 0),d++,h(g.value).callWhenSettled_(a(l.length-1),f),g=b.next();while(!g.done)})};return e},"es6","es3");
$jscomp.assign="function"==typeof Object.assign?Object.assign:function(k,n){for(var h=1;h<arguments.length;h++){var d=arguments[h];if(d)for(var e in d)$jscomp.owns(d,e)&&(k[e]=d[e])}return k};$jscomp.polyfill("Object.assign",function(k){return k||$jscomp.assign},"es6","es3");
var Erizo=function(k){function n(d){if(h[d])return h[d].exports;var e=h[d]={i:d,l:!1,exports:{}};return k[d].call(e.exports,e,e.exports,n),e.l=!0,e.exports}var h={};return n.m=k,n.c=h,n.d=function(d,e,b){n.o(d,e)||Object.defineProperty(d,e,{enumerable:!0,get:b})},n.r=function(d){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(d,Symbol.toStringTag,{value:"Module"});Object.defineProperty(d,"__esModule",{value:!0})},
n.t=function(d,e){if((1&e&&(d=n(d)),8&e)||4&e&&"object"==typeof d&&d&&d.__esModule)return d;var b=Object.create(null);if(n.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:d}),2&e&&"string"!=typeof d)for(var a in d)n.d(b,a,function(a){return d[a]}.bind(null,a));return b},n.n=function(d){var e=d&&d.__esModule?function(){return d.default}:function(){return d};return n.d(e,"a",e),e},n.o=function(d,e){return Object.prototype.hasOwnProperty.call(d,e)},n.p="",n(n.s=33)}([function(k,n,h){var d=
function(){var e="";var b=function(a){console.log.apply(console,$jscomp.arrayFromIterable(a))};return{DEBUG:0,TRACE:1,INFO:2,WARNING:3,ERROR:4,NONE:5,setLogLevel:function(a){var b=a;a>d.NONE?b=d.NONE:a<d.DEBUG&&(b=d.DEBUG);d.logLevel=b},setOutputFunction:function(a){b=a},setLogPrefix:function(a){e=a},log:function(a,w){for(var g=[],c=1;c<arguments.length;++c)g[c-1]=arguments[c];c=e;if(!(a<d.logLevel))if(a===d.DEBUG?c+="DEBUG":a===d.TRACE?c+="TRACE":a===d.INFO?c+="INFO":a===d.WARNING?c+="WARNING":a===
d.ERROR&&(c+="ERROR"),g=[c+": "].concat(g),void 0!==d.panel){c="";for(var f=0;f<g.length;f+=1)c+=g[f];d.panel.value=d.panel.value+"\n"+c}else b.apply(d,[g])},debug:function(a){for(var b=[],g=0;g<arguments.length;++g)b[g-0]=arguments[g];d.log.apply(d,[d.DEBUG].concat($jscomp.arrayFromIterable(b)))},trace:function(a){for(var b=[],g=0;g<arguments.length;++g)b[g-0]=arguments[g];d.log.apply(d,[d.TRACE].concat($jscomp.arrayFromIterable(b)))},info:function(a){for(var b=[],g=0;g<arguments.length;++g)b[g-
0]=arguments[g];d.log.apply(d,[d.INFO].concat($jscomp.arrayFromIterable(b)))},warning:function(a){for(var b=[],g=0;g<arguments.length;++g)b[g-0]=arguments[g];d.log.apply(d,[d.WARNING].concat($jscomp.arrayFromIterable(b)))},error:function(a){for(var b=[],g=0;g<arguments.length;++g)b[g-0]=arguments[g];d.log.apply(d,[d.ERROR].concat($jscomp.arrayFromIterable(b)))}}}();n.a=d},function(k,n,h){n=h(20);var d=h(8),e=h(9),b=h(10),a=h(11),w=h(12),g=h(4),c=h(14),f=h(15),q=h(16),l=h(17);h=h(6);k.exports={SDPInfo:n,
CandidateInfo:d,CodecInfo:e,DTLSInfo:b,ICEInfo:a,MediaInfo:w,Setup:g,SourceGroupInfo:c,SourceInfo:f,StreamInfo:q,TrackInfo:l,Direction:h}},function(k,n,h){(function(d){var e=h(0),b=function(){var a="none";return void 0!==d&&d.exports?a="fake":null!==window.navigator.userAgent.match("Firefox")?a="mozilla":null!==window.navigator.userAgent.match("Chrome")?(a="chrome-stable",null!==window.navigator.userAgent.match("Electron")&&(a="electron")):null!==window.navigator.userAgent.match("Safari")?a="safari":
null!==window.navigator.userAgent.match("AppleWebKit")&&(a="safari"),a};n.a={GetUserMedia:function(a,w,g){w=void 0===w?function(){}:w;g=void 0===g?function(){}:g;var c,f=function(c,f,a){navigator.mediaDevices.getUserMedia(c).then(f).catch(a)};a.screen?function(){switch(e.a.debug("Screen access requested"),b()){case "electron":e.a.debug("Screen sharing in Electron");(c={}).video=a.video||{};c.video.mandatory=a.video.mandatory||{};c.video.mandatory.chromeMediaSource="desktop";c.video.mandatory.chromeMediaSourceId=
a.desktopStreamId;f(c,w,g);break;case "mozilla":e.a.debug("Screen sharing in Firefox");c={};void 0!==a.video?(c.video=a.video,c.video.mediaSource||(c.video.mediaSource="window")):c={audio:a.audio,video:{mediaSource:"window"}};f(c,w,g);break;case "chrome-stable":if(e.a.debug("Screen sharing in Chrome"),c={},a.desktopStreamId)c.video=a.video||{mandatory:{}},c.video.mandatory=c.video.mandatory||{},c.video.mandatory.chromeMediaSource="desktop",c.video.mandatory.chromeMediaSourceId=a.desktopStreamId,f(c,
w,g);else{var d="okeephmleflklcdebijnponpabbmmgeo";a.extensionId&&(e.a.debug("extensionId supplied, using "+a.extensionId),d=a.extensionId);e.a.debug("Screen access on chrome stable, looking for extension");try{chrome.runtime.sendMessage(d,{getStream:!0},function(b){if(void 0===b)return e.a.error("Access to screen denied"),void g({code:"Access to screen denied"});b=b.streamId;void 0!==a.video.mandatory?(c.video=a.video||{mandatory:{}},c.video.mandatory.chromeMediaSource="desktop",c.video.mandatory.chromeMediaSourceId=
b):c={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:b}}};f(c,w,g)})}catch(l){e.a.debug("Screensharing plugin is not accessible "),g({code:"no_plugin_present"})}}break;default:e.a.error("This browser does not support ScreenSharing")}}():void 0!==d&&d.exports?e.a.error("Video/audio streams not supported in erizofc yet"):(e.a.debug("Calling getUserMedia with config",a),f(a,w,g))},getBrowser:b}}).call(this,h(27)(k))},function(k,n,h){var d=h(5)("SEND","RECV");d.byValue=function(e){return d[e.toUpperCase()]};
d.toString=function(e){switch(e){case d.SEND:return"send";case d.RECV:return"recv";default:return"unknown"}};d.reverse=function(e){switch(e){case d.SEND:return d.RECV;default:return d.SEND}};k.exports=d},function(k,n,h){var d=h(5)("ACTIVE","PASSIVE","ACTPASS","INACTIVE");d.byValue=function(e){return d[e.toUpperCase()]};d.toString=function(e){switch(e){case d.ACTIVE:return"active";case d.PASSIVE:return"passive";case d.ACTPASS:return"actpass";case d.INACTIVE:return"inactive";default:return null}};d.reverse=
function(e){switch(e){case d.ACTIVE:return d.PASSIVE;case d.PASSIVE:return d.ACTIVE;case d.ACTPASS:return d.PASSIVE;case d.INACTIVE:return d.INACTIVE;default:return d.ACTIVE}};k.exports=d},function(k,n){k.exports=function e(d){for(var b=[],a=0;a<arguments.length;++a)b[a-0]=arguments[a];var w=this;if(!(this instanceof e))return new (Function.prototype.bind.apply(e,[null].concat(Array.prototype.slice.call(b))));Array.from(b).forEach(function(a){$jscomp.initSymbol();w[a]=Symbol.for("LICODE_SEMANTIC_SDP_"+
a)})}},function(k,n,h){var d=h(5)("SENDRECV","SENDONLY","RECVONLY","INACTIVE");d.byValue=function(e){return d[e.toUpperCase()]};d.toString=function(e){switch(e){case d.SENDRECV:return"sendrecv";case d.SENDONLY:return"sendonly";case d.RECVONLY:return"recvonly";case d.INACTIVE:return"inactive";default:return"unknown"}};d.reverse=function(e){switch(e){case d.SENDRECV:return d.SENDRECV;case d.SENDONLY:return d.RECVONLY;case d.RECVONLY:return d.SENDONLY;case d.INACTIVE:return d.INACTIVE;default:return d.SENDRECV}};
k.exports=d},function(k,n){var h=k.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:"username sessionId sessionVersion netType ipVer address".split(" "),format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,
names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(d){return d.encoding?"rtpmap:%d %s/%s/%s":d.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,
names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(d){return null!=d.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(d){return null!=
d.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(d){return"extmap:%d"+(d.direction?"/%s":"%v")+" %s"+(d.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(d){return null!=d.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",
reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},
{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:"foundation component transport priority ip port type raddr rport tcptype generation network-id network-cost".split(" "),format:function(d){var e="candidate:%s %d %s %d %s %d typ %s";return e+=null!=d.raddr?" raddr %s rport %d":"%v%v",e+=null!=d.tcptype?" tcptype %s":"%v",null!=d.generation&&(e+=
" generation %d"),e+=null!=d["network-id"]?" network-id %d":"%v",e+(null!=d["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(d){var e="ssrc:%d";return null!=d.attribute&&(e+=" %s",null!=d.value&&(e+=
":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber",
"app","maxMessageSize"],format:function(d){return null!=d.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(d){return d.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:/^imageattr:(\d+|\*)[\s\t]+(send|recv)[\s\t]+(\*|\[\S+\](?:[\s\t]+\[\S+\])*)(?:[\s\t]+(recv|send)[\s\t]+(\*|\[\S+\](?:[\s\t]+\[\S+\])*))?/,
names:["pt","dir1","attrs1","dir2","attrs2"],format:function(d){return"imageattr:%s %s %s"+(d.dir2?" %s %s":"")}},{name:"simulcast",reg:/^simulcast:(send|recv) ([a-zA-Z0-9\-_~;,]+)(?:\s?(send|recv) ([a-zA-Z0-9\-_~;,]+))?$/,names:["dir1","list1","dir2","list2"],format:function(d){return"simulcast:%s %s"+(d.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},
{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{push:"invalid",names:["value"]}]};Object.keys(h).forEach(function(d){h[d].forEach(function(d){d.reg||(d.reg=/(.*)/);d.format||(d.format="%s")})})},function(k,n){var h=function(d,e,b,a,w,g,c,f,q,l){this.foundation=d;this.componentId=e;this.transport=b;this.priority=a;this.address=w;this.port=g;this.type=
c;this.generation=f;this.relAddr=q;this.relPort=l};h.prototype.clone=function(){return new h(this.foundation,this.componentId,this.transport,this.priority,this.address,this.port,this.type,this.generation,this.relAddr,this.relPort)};h.prototype.plain=function(){var d={foundation:this.foundation,componentId:this.componentId,transport:this.transport,priority:this.priority,address:this.address,port:this.port,type:this.type,generation:this.generation};return this.relAddr&&(d.relAddr=this.relAddr),this.relPort&&
(d.relPort=this.relPort),d};h.prototype.getFoundation=function(){return this.foundation};h.prototype.getComponentId=function(){return this.componentId};h.prototype.getTransport=function(){return this.transport};h.prototype.getPriority=function(){return this.priority};h.prototype.getAddress=function(){return this.address};h.prototype.getPort=function(){return this.port};h.prototype.getType=function(){return this.type};h.prototype.getGeneration=function(){return this.generation};h.prototype.getRelAddr=
function(){return this.relAddr};h.prototype.getRelPort=function(){return this.relPort};k.exports=h},function(k,n){var h=function(d,e,b,a,w,g){this.codec=d;this.type=e;this.rate=b;this.encoding=a;this.params=w||{};this.feedback=g||[]};h.prototype.clone=function(){var d=new h(this.codec,this.type,this.rate,this.encoding,this.params,this.feedback);return this.rtx&&d.setRTX(this.rtx),d};h.prototype.plain=function(){return{codec:this.codec,type:this.type,rate:this.rate,encoding:this.encoding,params:this.params,
feedback:this.feedback}};h.prototype.setRTX=function(d){this.rtx=d};h.prototype.getType=function(){return this.type};h.prototype.setType=function(d){this.type=d};h.prototype.getCodec=function(){return this.codec};h.prototype.getParams=function(){return this.params};h.prototype.setParam=function(d,e){this.params[d]=e};h.prototype.hasRTX=function(){return this.rtx};h.prototype.getRTX=function(){return this.rtx};h.prototype.getRate=function(){return this.rate};h.prototype.getEncoding=function(){return this.encoding};
h.prototype.getFeedback=function(){return this.feedback};h.mapFromNames=function(d,e){var b=new Map,a=96;return d.forEach(function(d){d=d.toLowerCase();var g="pcmu"===d?0:"pcma"===d?8:a+=1;g=new h(d,g);e&&"ulpfec"!==d&&"flexfec-03"!==d&&"red"!==d&&(a+=1,g.setRTX(a));b.set(g.getCodec().toLowerCase(),g)}),b};k.exports=h},function(k,n,h){var d=h(4),e=function(b,a,d){this.setup=b;this.hash=a;this.fingerprint=d};e.prototype.clone=function(){return new e(this.setup,this.hash,this.fingerprint)};e.prototype.plain=
function(){return{setup:d.toString(this.setup),hash:this.hash,fingerprint:this.fingerprint}};e.prototype.getFingerprint=function(){return this.fingerprint};e.prototype.getHash=function(){return this.hash};e.prototype.getSetup=function(){return this.setup};e.prototype.setSetup=function(b){this.setup=b};k.exports=e},function(k,n){function h(b){b=new Uint8Array(b);for(var a=0;a<b.length;a+=1)b[a]=Math.floor(256*Math.random());return b}function d(b){return Array.prototype.map.call(new Uint8Array(b),function(a){return("00"+
a.toString(16)).slice(-2)}).join("")}var e=function(b,a,d){this.ufrag=b;this.pwd=a;this.opts=d;this.endOfCandidates=this.lite=!1};e.prototype.clone=function(){var b=new e(this.ufrag,this.pwd,this.opts);return b.setLite(this.lite),b.setEndOfCandidates(this.endOfCandidates),b};e.prototype.plain=function(){var b={ufrag:this.ufrag,pwd:this.pwd};return this.lite&&(b.lite=this.lite),this.endOfCandidates&&(b.endOfCandidates=this.endOfCandidates),b};e.prototype.getUfrag=function(){return this.ufrag};e.prototype.getPwd=
function(){return this.pwd};e.prototype.isLite=function(){return this.lite};e.prototype.getOpts=function(){return this.opts};e.prototype.setLite=function(b){this.lite=b};e.prototype.isEndOfCandidates=function(){return this.endOfCandidates};e.prototype.setEndOfCandidates=function(b){this.endOfCandidates=b};e.generate=function(){var b=new e,a=h(8),w=h(24);return b.ufrag=d(a),b.pwd=d(w),b};k.exports=e},function(k,n,h){var d=h(13),e=h(6),b=h(3),a=function(a,b,c){this.id=a;this.type=c;this.port=b;this.direction=
e.SENDRECV;this.extensions=new Map;this.codecs=new Map;this.rids=new Map;this.simulcast_03=this.simulcast=null;this.bitrate=0;this.connection=this.dtls=this.ice=null;this.candidates=[]};a.prototype.clone=function(){var b=new a(this.id,this.port,this.type);return b.setDirection(this.direction),b.setBitrate(this.bitrate),b.setConnection(this.connection),this.codecs.forEach(function(a){b.addCodec(a.clone())}),this.extensions.forEach(function(a,c){b.addExtension(c,a)}),this.rids.forEach(function(a,c){b.addRID(c,
a.clone())}),this.simulcast&&b.setSimulcast(this.simulcast.clone()),this.xGoogleFlag&&b.setXGoogleFlag(this.xGoogleFlag),this.ice&&b.setICE(this.ice.clone()),this.dtls&&b.setDTLS(this.dtls.clone()),this.candidates.forEach(function(a){b.addCandidate(a.clone())}),this.setup&&b.setSetup(this.setup),b};a.prototype.plain=function(){var a={id:this.id,port:this.port,type:this.type,connection:this.connection,direction:e.toString(this.direction),xGoogleFlag:this.xGoogleFlag,extensions:{},rids:[],codecs:[],
candidates:[]};return this.bitrate&&(a.bitrate=this.bitrate),this.codecs.forEach(function(b){a.codecs.push(b.plain())}),this.extensions.forEach(function(b){a.extensions.push(b.plain())}),this.rids.forEach(function(b){a.rids.push(b.plain())}),this.simulcast&&(a.simulcast=this.simulcast.plain()),this.candidates.forEach(function(b){a.candidates.push(b.plain())}),a.ice=this.ice&&this.ice.plain(),a.dtls=this.dtls&&this.dtls.plain(),a};a.prototype.getType=function(){return this.type};a.prototype.getPort=
function(){return this.port};a.prototype.getId=function(){return this.id};a.prototype.addExtension=function(a,b){this.extensions.set(a,b)};a.prototype.addRID=function(a){this.rids.set(a.getId(),a)};a.prototype.addCodec=function(a){this.codecs.set(a.getType(),a)};a.prototype.getCodecForType=function(a){return this.codecs.get(a)};a.prototype.getCodec=function(a){var b;return this.codecs.forEach(function(c){c.getCodec().toLowerCase()===a.toLowerCase()&&(b=c)}),b};a.prototype.hasCodec=function(a){return null!==
this.getCodec(a)};a.prototype.getCodecs=function(){return this.codecs};a.prototype.getExtensions=function(){return this.extensions};a.prototype.getRIDs=function(){return this.rids};a.prototype.getRID=function(a){return this.rids.get(a)};a.prototype.getBitrate=function(){return this.bitrate};a.prototype.setBitrate=function(a){this.bitrate=a};a.prototype.getDirection=function(){return this.direction};a.prototype.setDirection=function(a){this.direction=a};a.prototype.getDTLS=function(){return this.dtls};
a.prototype.setDTLS=function(a){this.dtls=a};a.prototype.getICE=function(){return this.ice};a.prototype.setICE=function(a){this.ice=a};a.prototype.addCandidate=function(a){this.candidates.push(a)};a.prototype.addCandidates=function(a){var b=this;a.forEach(function(c){b.addCandidate(c)})};a.prototype.getCandidates=function(){return this.candidates};a.prototype.setXGoogleFlag=function(a){this.xGoogleFlag=a};a.prototype.getXGoogleFlag=function(){return this.xGoogleFlag};a.prototype.getConnection=function(){return this.connection};
a.prototype.setConnection=function(a){this.connection=a};a.prototype.answer=function(w){var g=new a(this.id,this.port,this.type);if(g.setDirection(e.reverse(this.direction)),w.codecs&&this.codecs.forEach(function(c){if(w.codecs.has(c.getCodec().toLowerCase())){var a=w.codecs.get(c.getCodec().toLowerCase()).clone();a.setType(c.getType());a.hasRTX()&&a.setRTX(c.getRTX());g.addCodec(a)}}),this.extensions.forEach(function(c,a){w.extensions.has(a)&&g.addExtension(a,c)}),w.simulcast&&this.simulcast){var c=
new d,f=this.simulcast.getSimulcastStreams(b.SEND);f&&f.forEach(function(a){var f=[];a.forEach(function(c){f.push(c.clone())});c.addSimulcastAlternativeStreams(b.RECV,f)});(f=this.simulcast.getSimulcastStreams(b.RECV))&&f.forEach(function(a){var f=[];a.forEach(function(c){f.push(c.clone())});c.addSimulcastAlternativeStreams(b.SEND,f)});this.rids.forEach(function(c){var a=c.clone();a.setDirection(b.reverse(c.getDirection()));g.addRID(a)});g.setSimulcast(c)}return g};a.prototype.getSimulcast=function(){return this.simulcast};
a.prototype.setSimulcast=function(a){this.simulcast=a};a.prototype.getSimulcast03=function(){return this.simulcast_03};a.prototype.setSimulcast03=function(a){this.simulcast_03=a};a.prototype.getSetup=function(){return this.setup};a.prototype.setSetup=function(a){this.setup=a};k.exports=a},function(k,n,h){var d=h(3),e=function(){this.send=[];this.recv=[];this.plainString=null};e.prototype.clone=function(){var b=new e;return this.send.forEach(function(a){var d=[];a.forEach(function(a){d.push(a.clone())});
b.addSimulcastAlternativeStreams(d)}),this.recv.forEach(function(a){var d=[];a.forEach(function(a){d.push(a.clone())});b.addSimulcastAlternativeStreams(d)}),b};e.prototype.plain=function(){var b={send:[],recv:[]};return this.send.forEach(function(a){var d=[];a.forEach(function(a){d.push(a.plain())});b.send.push(d)}),this.recv.forEach(function(a){var d=[];a.forEach(function(a){d.push(a.plain())});b.recv.push(d)}),b};e.prototype.addSimulcastAlternativeStreams=function(b,a){return b===d.SEND?this.send.push(a):
this.recv.push(a)};e.prototype.addSimulcastStream=function(b,a){return b===d.SEND?this.send.push([a]):this.recv.push([a])};e.prototype.getSimulcastStreams=function(b){return b===d.SEND?this.send:this.recv};e.prototype.setSimulcastPlainString=function(b){this.plainString=b};e.prototype.getSimulcastPlainString=function(){return this.plainString};k.exports=e},function(k,n){var h=function(d,e){var b=this;this.semantics=d;this.ssrcs=[];e.forEach(function(a){b.ssrcs.push(parseInt(a,10))})};h.prototype.clone=
function(){return new h(this.semantics,this.ssrcs)};h.prototype.plain=function(){var d={semantics:this.semantics,ssrcs:[]};return d.ssrcs=this.ssrcs,d};h.prototype.getSemantics=function(){return this.semantics};h.prototype.getSSRCs=function(){return this.ssrcs};k.exports=h},function(k,n){var h=function(d){this.ssrc=d};h.prototype.clone=function(){var d=new h(this.ssrc);d.setCName(this.cname);d.setStreamId(this.streamId);this.setTrackId(this.trackId)};h.prototype.plain=function(){var d={ssrc:this.ssrc};
return this.cname&&(d.cname=this.cname),this.label&&(d.label=this.label),this.mslabel&&(d.mslabel=this.mslabel),this.streamId&&(d.streamId=this.streamId),this.trackId&&(d.trackid=this.trackId),d};h.prototype.getCName=function(){return this.cname};h.prototype.setCName=function(d){this.cname=d};h.prototype.getStreamId=function(){return this.streamId};h.prototype.setStreamId=function(d){this.streamId=d};h.prototype.getTrackId=function(){return this.trackId};h.prototype.setTrackId=function(d){this.trackId=
d};h.prototype.getMSLabel=function(){return this.mslabel};h.prototype.setMSLabel=function(d){this.mslabel=d};h.prototype.getLabel=function(){return this.label};h.prototype.setLabel=function(d){this.label=d};h.prototype.getSSRC=function(){return this.ssrc};k.exports=h},function(k,n){var h=function(d){this.id=d;this.tracks=new Map};h.prototype.clone=function(){var d=new h(this.id);return this.tracks.forEach(function(e){d.addTrack(e.clone())}),d};h.prototype.plain=function(){var d={id:this.id,tracks:[]};
return this.tracks.forEach(function(e){d.tracks.push(e.plain())}),d};h.prototype.getId=function(){return this.id};h.prototype.addTrack=function(d){this.tracks.set(d.getId(),d)};h.prototype.getFirstTrack=function(d){var e;return this.tracks.forEach(function(b){b.getMedia().toLowerCase()===d.toLowerCase()&&(e=b)}),e};h.prototype.getTracks=function(){return this.tracks};h.prototype.removeAllTracks=function(){this.tracks.clear()};h.prototype.getTrack=function(d){return this.tracks.get(d)};k.exports=h},
function(k,n){var h=function(d,e){this.media=d;this.id=e;this.ssrcs=[];this.groups=[];this.encodings=[]};h.prototype.clone=function(){var d=new h(this.media,this.id);return this.mediaId&&d.setMediaId(this.mediaId),this.ssrcs.forEach(function(e){d.addSSRC(e)}),this.groups.forEach(function(e){d.addSourceGroup(e.clone())}),this.encodings.forEach(function(e){var b=[];e.forEach(function(a){b.push(a.cloned())});d.addAlternativeEncoding(b)}),d};h.prototype.plain=function(){var d={media:this.media,id:this.id,
ssrcs:[],groups:[],encodings:[]};return this.mediaId&&(d.mediaId=this.mediaId),this.ssrcs.forEach(function(e){d.ssrcs.push(e)}),this.groups.forEach(function(e){d.groups.push(e.plain())}),this.encodings.forEach(function(e){var b=[];e.forEach(function(a){b.push(a.plain())});d.encodings.push(b)}),d};h.prototype.getMedia=function(){return this.media};h.prototype.setMediaId=function(d){this.mediaId=d};h.prototype.getMediaId=function(){return this.mediaId};h.prototype.getId=function(){return this.id};h.prototype.addSSRC=
function(d){this.ssrcs.push(d)};h.prototype.getSSRCs=function(){return this.ssrcs};h.prototype.addSourceGroup=function(d){this.groups.push(d)};h.prototype.getSourceGroup=function(d){var e;return this.groups.forEach(function(b){b.getSemantics().toLowerCase()===d.toLowerCase()&&(e=b)}),e};h.prototype.getSourceGroups=function(){return this.groups};h.prototype.hasSourceGroup=function(d){var e=!1;return this.groups.forEach(function(b){b.getSemantics().toLowerCase()===d.toLowerCase()&&(e=!0)}),e};h.prototype.getEncodings=
function(){return this.encodings};h.prototype.addAlternaticeEncodings=function(d){this.encodings.push(d)};h.prototype.setEncodings=function(d){this.encodings=d};k.exports=h},function(k,n){n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(h){"object"==typeof window&&(n=window)}k.exports=n},function(k,n,h){k.exports=function(d){function e(a){if(b[a])return b[a].exports;var w=b[a]={exports:{},id:a,loaded:!1};return d[a].call(w.exports,w,w.exports,e),w.loaded=!0,w.exports}
var b={};return e.m=d,e.c=b,e.p="",e(0)}([function(d,e,b){function a(c,a){"object"===(void 0===c?"undefined":w(c))&&(a=c,c=void 0);a=a||{};var b;c=g(c);var m=c.source,r=c.id,p=c.path;p=l[r]&&p in l[r].nsps;return a.forceNew||a["force new connection"]||!1===a.multiplex||p?(q("ignoring socket cache for %s",m),b=f(m,a)):(l[r]||(q("new io instance for %s",m),l[r]=f(m,a)),b=l[r]),c.query&&!a.query&&(a.query=c.query),b.socket(c.path,a)}$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();
var w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(c){return typeof c}:function(c){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return c&&"function"==typeof Symbol&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},g=b(1),c=b(7),f=b(13),q=b(3)("socket.io-client");d.exports=e=a;var l=e.managers={};e.protocol=c.protocol;e.connect=a;e.Manager=b(13);e.Socket=b(39)},function(d,e,b){(function(a){var e=b(2),g=b(3)("socket.io-client:url");d.exports=
function(c,f){var b=c;f=f||a.location;null==c&&(c=f.protocol+"//"+f.host);"string"==typeof c&&("/"===c.charAt(0)&&(c="/"===c.charAt(1)?f.protocol+c:f.host+c),/^(https?|wss?):\/\//.test(c)||(g("protocol-less url %s",c),c=void 0!==f?f.protocol+"//"+c:"https://"+c),g("parse %s",c),b=e(c));b.port||(/^(http|ws)$/.test(b.protocol)?b.port="80":/^(http|ws)s$/.test(b.protocol)&&(b.port="443"));b.path=b.path||"/";c=-1!==b.host.indexOf(":")?"["+b.host+"]":b.host;return b.id=b.protocol+"://"+c+":"+b.port,b.href=
b.protocol+"://"+c+(f&&f.port===b.port?"":":"+b.port),b}}).call(e,function(){return this}())},function(d,e){var b=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,a="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");d.exports=function(d){var g=d,c=d.indexOf("["),
f=d.indexOf("]");-1!=c&&-1!=f&&(d=d.substring(0,c)+d.substring(c,f).replace(/:/g,";")+d.substring(f,d.length));d=b.exec(d||"");for(var e={},l=14;l--;)e[a[l]]=d[l]||"";return-1!=c&&-1!=f&&(e.source=g,e.host=e.host.substring(1,e.host.length-1).replace(/;/g,":"),e.authority=e.authority.replace("[","").replace("]","").replace(/;/g,":"),e.ipv6uri=!0),e}},function(d,e,b){(function(a){function w(){try{var c=e.storage.debug}catch(q){}return!c&&void 0!==a&&"env"in a&&(c=a.env.DEBUG),c}(e=d.exports=b(5)).log=
function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)};e.formatArgs=function(c){var a=this.useColors;if(c[0]=(a?"%c":"")+this.namespace+(a?" %c":" ")+c[0]+(a?"%c ":" ")+"+"+e.humanize(this.diff),a){a="color: "+this.color;c.splice(1,0,a,"color: inherit");var b=0,f=0;c[0].replace(/%[a-zA-Z%]/g,function(c){"%%"!==c&&"%c"===c&&(f=++b)});c.splice(f,0,a)}};e.save=function(c){try{null==c?e.storage.removeItem("debug"):e.storage.debug=c}catch(q){}};
e.load=w;e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,
10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};var g=e;if("undefined"!=typeof chrome&&void 0!==chrome.storage)var c=chrome.storage.local;else a:{try{c=window.localStorage;break a}catch(f){}c=void 0}g.storage=c;e.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" ");e.formatters.j=function(c){try{return JSON.stringify(c)}catch(q){return"[UnexpectedJSONParseError]: "+q.message}};e.enable(w())}).call(e,
b(4))},function(d,e){function b(){throw Error("setTimeout has not been defined");}function a(){throw Error("clearTimeout has not been defined");}function w(c){if(l===setTimeout)return setTimeout(c,0);if((l===b||!l)&&setTimeout)return l=setTimeout,setTimeout(c,0);try{return l(c,0)}catch(z){try{return l.call(null,c,0)}catch(A){return l.call(this,c,0)}}}function g(){m&&y&&(m=!1,y.length?x=y.concat(x):r=-1,x.length&&c())}function c(){if(!m){var c=w(g);m=!0;for(var b=x.length;b;){y=x;for(x=[];++r<b;)y&&
y[r].run();r=-1;b=x.length}y=null;m=!1;(function(c){if(u===clearTimeout)return clearTimeout(c);if((u===a||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(c);try{u(c)}catch(v){try{return u.call(null,c)}catch(D){return u.call(this,c)}}})(c)}}function f(c,a){this.fun=c;this.array=a}function q(){}d=d.exports={};try{var l="function"==typeof setTimeout?setTimeout:b}catch(p){l=b}try{var u="function"==typeof clearTimeout?clearTimeout:a}catch(p){u=a}!0;var y,x=[],m=!1,r=-1;d.nextTick=function(a){var b=
Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)b[r-1]=arguments[r];x.push(new f(a,b));1!==x.length||m||w(c)};f.prototype.run=function(){this.fun.apply(null,this.array)};d.title="browser";d.browser=!0;d.env={};d.argv=[];d.version="";d.versions={};d.on=q;d.addListener=q;d.once=q;d.off=q;d.removeListener=q;d.removeAllListeners=q;d.emit=q;d.prependListener=q;d.prependOnceListener=q;d.listeners=function(c){return[]};d.binding=function(c){throw Error("process.binding is not supported");
};d.cwd=function(){return"/"};d.chdir=function(c){throw Error("process.chdir is not supported");};d.umask=function(){return 0}},function(d,e,b){function a(a){function c(){if(c.enabled){var a=+new Date;c.diff=a-(w||a);c.prev=w;w=c.curr=a;var b=Array(arguments.length);for(a=0;a<b.length;a++)b[a]=arguments[a];b[0]=e.coerce(b[0]);"string"!=typeof b[0]&&b.unshift("%O");var g=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,function(a,f){if("%%"===a)return a;g++;f=e.formatters[f];"function"==typeof f&&(a=f.call(c,b[g]),
b.splice(g,1),g--);return a});e.formatArgs.call(c,b);(c.log||e.log||console.log.bind(console)).apply(c,b)}}return c.namespace=a,c.enabled=e.enabled(a),c.useColors=e.useColors(),c.color=function(c){var a,b=0;for(a in c)b=(b<<5)-b+c.charCodeAt(a),b|=0;return e.colors[Math.abs(b)%e.colors.length]}(a),"function"==typeof e.init&&e.init(c),c}var w;(e=d.exports=a.debug=a.default=a).coerce=function(a){return a instanceof Error?a.stack||a.message:a};e.disable=function(){e.enable("")};e.enable=function(a){e.save(a);
e.names=[];e.skips=[];for(var c=("string"==typeof a?a:"").split(/[\s,]+/),b=c.length,g=0;g<b;g++)c[g]&&("-"===(a=c[g].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+a.substr(1)+"$")):e.names.push(new RegExp("^"+a+"$")))};e.enabled=function(a){var c;var b=0;for(c=e.skips.length;b<c;b++)if(e.skips[b].test(a))return!1;b=0;for(c=e.names.length;b<c;b++)if(e.names[b].test(a))return!0;return!1};e.humanize=b(6);e.names=[];e.skips=[];e.formatters={}},function(d,e){function b(b){return a(b,f,"day")||
a(b,c,"hour")||a(b,g,"minute")||a(b,w,"second")||b+" ms"}function a(c,a,b){if(!(c<a))return c<1.5*a?Math.floor(c/a)+" "+b:Math.ceil(c/a)+" "+b+"s"}var w=1E3,g=60*w,c=60*g,f=24*c,q=365.25*f;d.exports=function(a,d){d=d||{};var l=typeof a;if("string"===l&&0<a.length)return function(a){if(!(100<(a=String(a)).length)&&(a=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(a))){var b=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case "years":case "year":case "yrs":case "yr":case "y":return b*
q;case "days":case "day":case "d":return b*f;case "hours":case "hour":case "hrs":case "hr":case "h":return b*c;case "minutes":case "minute":case "mins":case "min":case "m":return b*g;case "seconds":case "second":case "secs":case "sec":case "s":return b*w;case "milliseconds":case "millisecond":case "msecs":case "msec":case "ms":return b}}}(a);if("number"===l&&!1===isNaN(a))return d.long?b(a):a>=f?Math.round(a/f)+"d":a>=c?Math.round(a/c)+"h":a>=g?Math.round(a/g)+"m":a>=w?Math.round(a/w)+"s":a+"ms";
throw Error("val is not a non-empty string or a valid number. val\x3d"+JSON.stringify(a));}},function(d,e,b){function a(){}function w(a){var c=""+a.type;return e.BINARY_EVENT!==a.type&&e.BINARY_ACK!==a.type||(c+=a.attachments+"-"),a.nsp&&"/"!==a.nsp&&(c+=a.nsp+","),null!=a.id&&(c+=a.id),null!=a.data&&(c+=JSON.stringify(a.data)),q("encoded %j as %s",a,c),c}function g(){this.reconstructor=null}function c(a){this.reconPack=a;this.buffers=[]}function f(){return{type:e.ERROR,data:"parser error"}}var q=
b(3)("socket.io-parser");d=b(8);var l=b(9),u=b(11),y=b(12);e.protocol=4;e.types="CONNECT DISCONNECT EVENT ACK ERROR BINARY_EVENT BINARY_ACK".split(" ");e.CONNECT=0;e.DISCONNECT=1;e.EVENT=2;e.ACK=3;e.ERROR=4;e.BINARY_EVENT=5;e.BINARY_ACK=6;e.Encoder=a;e.Decoder=g;a.prototype.encode=function(a,c){(a.type!==e.EVENT&&a.type!==e.ACK||!l(a.data)||(a.type=a.type===e.EVENT?e.BINARY_EVENT:e.BINARY_ACK),q("encoding packet %j",a),e.BINARY_EVENT===a.type||e.BINARY_ACK===a.type)?!function(a,c){u.removeBlobs(a,
function(a){var b=u.deconstructPacket(a);a=w(b.packet);b=b.buffers;b.unshift(a);c(b)})}(a,c):(a=w(a),c([a]))};d(g.prototype);g.prototype.add=function(a){if("string"==typeof a){var b=0;var r={type:Number(a.charAt(0))};if(null==e.types[r.type])b=f();else{if(e.BINARY_EVENT===r.type||e.BINARY_ACK===r.type){for(var p="";"-"!==a.charAt(++b)&&(p+=a.charAt(b),b!=a.length););if(p!=Number(p)||"-"!==a.charAt(b))throw Error("Illegal attachments");r.attachments=Number(p)}if("/"===a.charAt(b+1))for(r.nsp="";++b;){p=
a.charAt(b);if(","===p)break;if(r.nsp+=p,b===a.length)break}else r.nsp="/";p=a.charAt(b+1);if(""!==p&&Number(p)==p){for(r.id="";++b;){p=a.charAt(b);if(null==p||Number(p)!=p){--b;break}if(r.id+=a.charAt(b),b===a.length)break}r.id=Number(r.id)}if(a.charAt(++b)){b:{b=a.substr(b);try{r.data=JSON.parse(b)}catch(z){b=f();break b}b=r}r=b}b=(q("decoded %s as %j",a,r),r)}e.BINARY_EVENT===b.type||e.BINARY_ACK===b.type?(this.reconstructor=new c(b),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",
b)):this.emit("decoded",b)}else{if(!y(a)&&!a.base64)throw Error("Unknown type: "+a);if(!this.reconstructor)throw Error("got binary data when not reconstructing a packet");(b=this.reconstructor.takeBinaryData(a))&&(this.reconstructor=null,this.emit("decoded",b))}};g.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};c.prototype.takeBinaryData=function(a){return(this.buffers.push(a),this.buffers.length===this.reconPack.attachments)?(a=u.reconstructPacket(this.reconPack,
this.buffers),this.finishedReconstruction(),a):null};c.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]}},function(d,e,b){function a(b){if(b){for(var g in a.prototype)b[g]=a.prototype[g];return b}}d.exports=a;a.prototype.on=a.prototype.addEventListener=function(a,b){return this._callbacks=this._callbacks||{},(this._callbacks["$"+a]=this._callbacks["$"+a]||[]).push(b),this};a.prototype.once=function(a,b){function c(){this.off(a,c);b.apply(this,arguments)}return c.fn=
b,this.on(a,c),this};a.prototype.off=a.prototype.removeListener=a.prototype.removeAllListeners=a.prototype.removeEventListener=function(a,b){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var c=this._callbacks["$"+a];if(!c)return this;if(1==arguments.length)return delete this._callbacks["$"+a],this;for(var f,d=0;d<c.length;d++)if((f=c[d])===b||f.fn===b){c.splice(d,1);break}return this};a.prototype.emit=function(a){this._callbacks=this._callbacks||{};var b=
[].slice.call(arguments,1),c=this._callbacks["$"+a];if(c)for(var f=0,d=(c=c.slice(0)).length;f<d;++f)c[f].apply(this,b);return this};a.prototype.listeners=function(a){return this._callbacks=this._callbacks||{},this._callbacks["$"+a]||[]};a.prototype.hasListeners=function(a){return!!this.listeners(a).length}},function(d,e,b){(function(a){var e=b(10),g=Object.prototype.toString,c="function"==typeof a.Blob||"[object BlobConstructor]"===g.call(a.Blob),f="function"==typeof a.File||"[object FileConstructor]"===
g.call(a.File);d.exports=function u(b){if(!b||"object"!=typeof b)return!1;if(e(b)){for(var d=0,g=b.length;d<g;d++)if(u(b[d]))return!0;return!1}if("function"==typeof a.Buffer&&a.Buffer.isBuffer&&a.Buffer.isBuffer(b)||"function"==typeof a.ArrayBuffer&&b instanceof ArrayBuffer||c&&b instanceof Blob||f&&b instanceof File)return!0;if(b.toJSON&&"function"==typeof b.toJSON&&1===arguments.length)return u(b.toJSON(),!0);for(d in b)if(Object.prototype.hasOwnProperty.call(b,d)&&u(b[d]))return!0;return!1}}).call(e,
function(){return this}())},function(d,e){var b={}.toString;d.exports=Array.isArray||function(a){return"[object Array]"==b.call(a)}},function(d,e,b){(function(a){var d=b(10),g=b(12),c=Object.prototype.toString,f="function"==typeof a.Blob||"[object BlobConstructor]"===c.call(a.Blob),q="function"==typeof a.File||"[object FileConstructor]"===c.call(a.File);e.deconstructPacket=function(a){var c=[];return a.data=function r(a,c){if(!a)return a;if(g(a)){var b={_placeholder:!0,num:c.length};return c.push(a),
b}if(d(a)){b=Array(a.length);for(var m=0;m<a.length;m++)b[m]=r(a[m],c);return b}if("object"==typeof a&&!(a instanceof Date)){b={};for(m in a)b[m]=r(a[m],c);return b}return a}(a.data,c),a.attachments=c.length,{packet:a,buffers:c}};e.reconstructPacket=function(a,c){return a.data=function r(a,c){if(!a)return a;if(a&&a._placeholder)return c[a.num];if(d(a))for(var b=0;b<a.length;b++)a[b]=r(a[b],c);else if("object"==typeof a)for(b in a)a[b]=r(a[b],c);return a}(a.data,c),a.attachments=void 0,a};e.removeBlobs=
function(a,c){var b=0,e=a;(function A(a,p,l){if(!a)return a;if(f&&a instanceof Blob||q&&a instanceof File){b++;var r=new FileReader;r.onload=function(){l?l[p]=this.result:e=this.result;--b||c(e)};r.readAsArrayBuffer(a)}else if(d(a))for(r=0;r<a.length;r++)A(a[r],r,a);else if("object"==typeof a&&!g(a))for(r in a)A(a[r],r,a)})(e);b||c(e)}}).call(e,function(){return this}())},function(d,e){(function(b){d.exports=function(a){return b.Buffer&&b.Buffer.isBuffer(a)||b.ArrayBuffer&&a instanceof ArrayBuffer}}).call(e,
function(){return this}())},function(d,e,b){function a(c,b){if(!(this instanceof a))return new a(c,b);c&&"object"===(void 0===c?"undefined":w(c))&&(b=c,c=void 0);(b=b||{}).path=b.path||"/socket.io";this.nsps={};this.subs=[];this.opts=b;this.reconnection(!1!==b.reconnection);this.reconnectionAttempts(b.reconnectionAttempts||1/0);this.reconnectionDelay(b.reconnectionDelay||1E3);this.reconnectionDelayMax(b.reconnectionDelayMax||5E3);this.randomizationFactor(b.randomizationFactor||.5);this.backoff=new x({min:this.reconnectionDelay(),
max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==b.timeout?2E4:b.timeout);this.readyState="closed";this.uri=c;this.connecting=[];this.lastPing=null;this.encoding=!1;this.packetBuffer=[];c=b.parser||f;this.encoder=new c.Encoder;this.decoder=new c.Decoder;(this.autoConnect=!1!==b.autoConnect)&&this.open()}$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:
function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g=b(14),c=b(39);e=b(8);var f=b(7),q=b(41),l=b(42),u=b(3)("socket.io-client:manager"),h=b(37),x=b(43),m=Object.prototype.hasOwnProperty;d.exports=a;a.prototype.emitAll=function(){for(var a in this.emit.apply(this,arguments),this.nsps)m.call(this.nsps,a)&&this.nsps[a].emit.apply(this.nsps[a],arguments)};a.prototype.updateSocketIds=
function(){for(var a in this.nsps)m.call(this.nsps,a)&&(this.nsps[a].id=this.generateId(a))};a.prototype.generateId=function(a){return("/"===a?"":a+"#")+this.engine.id};e(a.prototype);a.prototype.reconnection=function(a){return arguments.length?(this._reconnection=!!a,this):this._reconnection};a.prototype.reconnectionAttempts=function(a){return arguments.length?(this._reconnectionAttempts=a,this):this._reconnectionAttempts};a.prototype.reconnectionDelay=function(a){return arguments.length?(this._reconnectionDelay=
a,this.backoff&&this.backoff.setMin(a),this):this._reconnectionDelay};a.prototype.randomizationFactor=function(a){return arguments.length?(this._randomizationFactor=a,this.backoff&&this.backoff.setJitter(a),this):this._randomizationFactor};a.prototype.reconnectionDelayMax=function(a){return arguments.length?(this._reconnectionDelayMax=a,this.backoff&&this.backoff.setMax(a),this):this._reconnectionDelayMax};a.prototype.timeout=function(a){return arguments.length?(this._timeout=a,this):this._timeout};
a.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()};a.prototype.open=a.prototype.connect=function(a,c){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri);var b=this.engine=g(this.uri,this.opts),m=this;this.readyState="opening";this.skipReconnect=!1;var f=q(b,"open",function(){m.onopen();a&&a()});c=q(b,"error",function(c){if(u("connect_error"),m.cleanup(),m.readyState=
"closed",m.emitAll("connect_error",c),a){var b=Error("Connection error");b.data=c;a(b)}else m.maybeReconnectOnOpen()});if(!1!==this._timeout){var r=this._timeout;u("connect attempt will timeout after %d",r);var d=setTimeout(function(){u("connect attempt timed out after %d",r);f.destroy();b.close();b.emit("error","timeout");m.emitAll("connect_timeout",r)},r);this.subs.push({destroy:function(){clearTimeout(d)}})}return this.subs.push(f),this.subs.push(c),this};a.prototype.onopen=function(){u("open");
this.cleanup();this.readyState="open";this.emit("open");var a=this.engine;this.subs.push(q(a,"data",l(this,"ondata")));this.subs.push(q(a,"ping",l(this,"onping")));this.subs.push(q(a,"pong",l(this,"onpong")));this.subs.push(q(a,"error",l(this,"onerror")));this.subs.push(q(a,"close",l(this,"onclose")));this.subs.push(q(this.decoder,"decoded",l(this,"ondecoded")))};a.prototype.onping=function(){this.lastPing=new Date;this.emitAll("ping")};a.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)};
a.prototype.ondata=function(a){this.decoder.add(a)};a.prototype.ondecoded=function(a){this.emit("packet",a)};a.prototype.onerror=function(a){u("error",a);this.emitAll("error",a)};a.prototype.socket=function(a,b){function m(){~h(r.connecting,f)||r.connecting.push(f)}var f=this.nsps[a];if(!f){f=new c(this,a,b);this.nsps[a]=f;var r=this;f.on("connecting",m);f.on("connect",function(){f.id=r.generateId(a)});this.autoConnect&&m()}return f};a.prototype.destroy=function(a){a=h(this.connecting,a);~a&&this.connecting.splice(a,
1);this.connecting.length||this.close()};a.prototype.packet=function(a){u("writing packet %j",a);var c=this;a.query&&0===a.type&&(a.nsp+="?"+a.query);c.encoding?c.packetBuffer.push(a):(c.encoding=!0,this.encoder.encode(a,function(b){for(var m=0;m<b.length;m++)c.engine.write(b[m],a.options);c.encoding=!1;c.processPacketQueue()}))};a.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var a=this.packetBuffer.shift();this.packet(a)}};a.prototype.cleanup=function(){u("cleanup");
for(var a=this.subs.length,c=0;c<a;c++)this.subs.shift().destroy();this.packetBuffer=[];this.encoding=!1;this.lastPing=null;this.decoder.destroy()};a.prototype.close=a.prototype.disconnect=function(){u("disconnect");this.skipReconnect=!0;this.reconnecting=!1;"opening"===this.readyState&&this.cleanup();this.backoff.reset();this.readyState="closed";this.engine&&this.engine.close()};a.prototype.onclose=function(a){u("onclose");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",
a);this._reconnection&&!this.skipReconnect&&this.reconnect()};a.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var a=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var c=this.backoff.duration();u("will wait %dms before reconnect attempt",c);this.reconnecting=!0;var b=setTimeout(function(){a.skipReconnect||(u("attempting reconnect"),a.emitAll("reconnect_attempt",
a.backoff.attempts),a.emitAll("reconnecting",a.backoff.attempts),a.skipReconnect||a.open(function(c){c?(u("reconnect attempt error"),a.reconnecting=!1,a.reconnect(),a.emitAll("reconnect_error",c.data)):(u("reconnect success"),a.onreconnect())}))},c);this.subs.push({destroy:function(){clearTimeout(b)}})}};a.prototype.onreconnect=function(){var a=this.backoff.attempts;this.reconnecting=!1;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",a)}},function(d,e,b){d.exports=b(15)},function(d,
e,b){d.exports=b(16);d.exports.parser=b(23)},function(d,e,b){(function(a){function e(c,b){if(!(this instanceof e))return new e(c,b);b=b||{};c&&"object"==typeof c&&(b=c,c=null);c?(c=u(c),b.hostname=c.host,b.secure="https"===c.protocol||"wss"===c.protocol,b.port=c.port,c.query&&(b.query=c.query)):b.host&&(b.hostname=u(b.host).host);this.secure=null!=b.secure?b.secure:a.location&&"https:"===location.protocol;b.hostname&&!b.port&&(b.port=this.secure?"443":"80");this.agent=b.agent||!1;this.hostname=b.hostname||
(a.location?location.hostname:"localhost");this.port=b.port||(a.location&&location.port?location.port:this.secure?443:80);this.query=b.query||{};"string"==typeof this.query&&(this.query=x.decode(this.query));this.upgrade=!1!==b.upgrade;this.path=(b.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!b.forceJSONP;this.jsonp=!1!==b.jsonp;this.forceBase64=!!b.forceBase64;this.enablesXDR=!!b.enablesXDR;this.timestampParam=b.timestampParam||"t";this.timestampRequests=b.timestampRequests;this.transports=
b.transports||["polling","websocket"];this.transportOptions=b.transportOptions||{};this.readyState="";this.writeBuffer=[];this.prevBufferLen=0;this.policyPort=b.policyPort||843;this.rememberUpgrade=b.rememberUpgrade||!1;this.binaryType=null;this.onlyBinaryUpgrades=b.onlyBinaryUpgrades;this.perMessageDeflate=!1!==b.perMessageDeflate&&(b.perMessageDeflate||{});!0===this.perMessageDeflate&&(this.perMessageDeflate={});this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=
1024);this.pfx=b.pfx||null;this.key=b.key||null;this.passphrase=b.passphrase||null;this.cert=b.cert||null;this.ca=b.ca||null;this.ciphers=b.ciphers||null;this.rejectUnauthorized=void 0===b.rejectUnauthorized||b.rejectUnauthorized;this.forceNode=!!b.forceNode;c="object"==typeof a&&a;c.global===c&&(b.extraHeaders&&0<Object.keys(b.extraHeaders).length&&(this.extraHeaders=b.extraHeaders),b.localAddress&&(this.localAddress=b.localAddress));this.pingTimeoutTimer=this.pingIntervalTimer=this.pingTimeout=
this.pingInterval=this.upgrades=this.id=null;this.open()}var g=b(17),c=b(8),f=b(3)("engine.io-client:socket"),q=b(37),l=b(23),u=b(2),h=b(38),x=b(31);d.exports=e;e.priorWebsocketSuccess=!1;c(e.prototype);e.protocol=l.protocol;e.Socket=e;e.Transport=b(22);e.transports=b(17);e.parser=b(23);e.prototype.createTransport=function(a){f('creating transport "%s"',a);var b=this.query,c={},m;for(m in b)b.hasOwnProperty(m)&&(c[m]=b[m]);c.EIO=l.protocol;c.transport=a;b=this.transportOptions[a]||{};this.id&&(c.sid=
this.id);return new g[a]({query:c,socket:this,agent:b.agent||this.agent,hostname:b.hostname||this.hostname,port:b.port||this.port,secure:b.secure||this.secure,path:b.path||this.path,forceJSONP:b.forceJSONP||this.forceJSONP,jsonp:b.jsonp||this.jsonp,forceBase64:b.forceBase64||this.forceBase64,enablesXDR:b.enablesXDR||this.enablesXDR,timestampRequests:b.timestampRequests||this.timestampRequests,timestampParam:b.timestampParam||this.timestampParam,policyPort:b.policyPort||this.policyPort,pfx:b.pfx||
this.pfx,key:b.key||this.key,passphrase:b.passphrase||this.passphrase,cert:b.cert||this.cert,ca:b.ca||this.ca,ciphers:b.ciphers||this.ciphers,rejectUnauthorized:b.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:b.perMessageDeflate||this.perMessageDeflate,extraHeaders:b.extraHeaders||this.extraHeaders,forceNode:b.forceNode||this.forceNode,localAddress:b.localAddress||this.localAddress,requestTimeout:b.requestTimeout||this.requestTimeout,protocols:b.protocols||void 0})};e.prototype.open=
function(){if(this.rememberUpgrade&&e.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))var a="websocket";else{if(0===this.transports.length){var b=this;return void setTimeout(function(){b.emit("error","No transports available")},0)}a=this.transports[0]}this.readyState="opening";try{a=this.createTransport(a)}catch(p){return this.transports.shift(),void this.open()}a.open();this.setTransport(a)};e.prototype.setTransport=function(a){f("setting transport %s",a.name);var b=this;this.transport&&
(f("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners());this.transport=a;a.on("drain",function(){b.onDrain()}).on("packet",function(a){b.onPacket(a)}).on("error",function(a){b.onError(a)}).on("close",function(){b.onClose("transport close")})};e.prototype.probe=function(a){function b(){if(y.onlyBinaryUpgrades){var b=!this.supportsBinary&&y.transport.supportsBinary;h=h||b}h||(f('probe transport "%s" opened',a),u.send([{type:"ping",data:"probe"}]),u.once("packet",
function(b){if(!h)if("pong"===b.type&&"probe"===b.data){if(f('probe transport "%s" pong',a),y.upgrading=!0,y.emit("upgrading",u),u)e.priorWebsocketSuccess="websocket"===u.name,f('pausing current transport "%s"',y.transport.name),y.transport.pause(function(){h||"closed"!==y.readyState&&(f("changing transport and sending upgrade packet"),q(),y.setTransport(u),u.send([{type:"upgrade"}]),y.emit("upgrade",u),u=null,y.upgrading=!1,y.flush())})}else f('probe transport "%s" failed',a),b=Error("probe error"),
b.transport=u.name,y.emit("upgradeError",b)}))}function c(){h||(h=!0,q(),u.close(),u=null)}function m(b){var m=Error("probe error: "+b);m.transport=u.name;c();f('probe transport "%s" failed because of error: %s',a,b);y.emit("upgradeError",m)}function d(){m("transport closed")}function g(){m("socket closed")}function l(a){u&&a.name!==u.name&&(f('"%s" works - aborting "%s"',a.name,u.name),c())}function q(){u.removeListener("open",b);u.removeListener("error",m);u.removeListener("close",d);y.removeListener("close",
g);y.removeListener("upgrading",l)}f('probing transport "%s"',a);var u=this.createTransport(a,{probe:1}),h=!1,y=this;e.priorWebsocketSuccess=!1;u.once("open",b);u.once("error",m);u.once("close",d);this.once("close",g);this.once("upgrading",l);u.open()};e.prototype.onOpen=function(){if(f("socket open"),this.readyState="open",e.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){f("starting upgrade probes");
for(var a=0,b=this.upgrades.length;a<b;a++)this.probe(this.upgrades[a])}};e.prototype.onPacket=function(a){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(f('socket receive: type "%s", data "%s"',a.type,a.data),this.emit("packet",a),this.emit("heartbeat"),a.type){case "open":this.onHandshake(h(a.data));break;case "pong":this.setPing();this.emit("pong");break;case "error":var b=Error("server error");b.code=a.data;this.onError(b);break;case "message":this.emit("data",
a.data),this.emit("message",a.data)}else f('packet received with socket readyState "%s"',this.readyState)};e.prototype.onHandshake=function(a){this.emit("handshake",a);this.id=a.sid;this.transport.query.sid=a.sid;this.upgrades=this.filterUpgrades(a.upgrades);this.pingInterval=a.pingInterval;this.pingTimeout=a.pingTimeout;this.onOpen();"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))};e.prototype.onHeartbeat=function(a){clearTimeout(this.pingTimeoutTimer);
var b=this;b.pingTimeoutTimer=setTimeout(function(){"closed"!==b.readyState&&b.onClose("ping timeout")},a||b.pingInterval+b.pingTimeout)};e.prototype.setPing=function(){var a=this;clearTimeout(a.pingIntervalTimer);a.pingIntervalTimer=setTimeout(function(){f("writing ping packet - expecting pong within %sms",a.pingTimeout);a.ping();a.onHeartbeat(a.pingTimeout)},a.pingInterval)};e.prototype.ping=function(){var a=this;this.sendPacket("ping",function(){a.emit("ping")})};e.prototype.onDrain=function(){this.writeBuffer.splice(0,
this.prevBufferLen);this.prevBufferLen=0;0===this.writeBuffer.length?this.emit("drain"):this.flush()};e.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(f("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))};e.prototype.write=e.prototype.send=function(a,b,c){return this.sendPacket("message",a,b,c),this};e.prototype.sendPacket=
function(a,b,c,f){if("function"==typeof b&&(f=b,b=void 0),"function"==typeof c&&(f=c,c=null),"closing"!==this.readyState&&"closed"!==this.readyState)(c=c||{}).compress=!1!==c.compress,a={type:a,data:b,options:c},this.emit("packetCreate",a),this.writeBuffer.push(a),f&&this.once("flush",f),this.flush()};e.prototype.close=function(){function a(){d.onClose("forced close");f("socket closing - telling transport to close");d.transport.close()}function b(){d.removeListener("upgrade",b);d.removeListener("upgradeError",
b);a()}function c(){d.once("upgrade",b);d.once("upgradeError",b)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var d=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?c():a()}):this.upgrading?c():a()}return this};e.prototype.onError=function(a){f("socket error %j",a);e.priorWebsocketSuccess=!1;this.emit("error",a);this.onClose("transport error",a)};e.prototype.onClose=function(a,b){"opening"!==this.readyState&&"open"!==this.readyState&&
"closing"!==this.readyState||(f('socket close with reason: "%s"',a),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",a,b),this.writeBuffer=[],this.prevBufferLen=0)};e.prototype.filterUpgrades=function(a){for(var b=[],c=0,f=a.length;c<f;c++)~q(this.transports,a[c])&&b.push(a[c]);return b}}).call(e,function(){return this}())},
function(d,e,b){(function(a){var d=b(18),g=b(20),c=b(34),f=b(35);e.polling=function(b){var f=!1,e=!1,q=!1!==b.jsonp;a.location&&(e="https:"===location.protocol,(f=location.port)||(f=e?443:80),f=b.hostname!==location.hostname||f!==b.port,e=b.secure!==e);if(b.xdomain=f,b.xscheme=e,"open"in new d(b)&&!b.forceJSONP)return new g(b);if(!q)throw Error("JSONP disabled");return new c(b)};e.websocket=f}).call(e,function(){return this}())},function(d,e,b){(function(a){var e=b(19);d.exports=function(b){var c=
b.xdomain,f=b.xscheme;b=b.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!c||e))return new XMLHttpRequest}catch(q){}try{if("undefined"!=typeof XDomainRequest&&!f&&b)return new XDomainRequest}catch(q){}if(!c)try{return new (a[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(q){}}}).call(e,function(){return this}())},function(d,e){try{d.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(b){d.exports=!1}},function(d,e,b){(function(a){function e(){}
function g(b){if(l.call(this,b),this.requestTimeout=b.requestTimeout,this.extraHeaders=b.extraHeaders,a.location){var c="https:"===location.protocol,f=location.port;f||(f=c?443:80);this.xd=b.hostname!==a.location.hostname||f!==b.port;this.xs=b.secure!==c}}function c(a){this.method=a.method||"GET";this.uri=a.uri;this.xd=!!a.xd;this.xs=!!a.xs;this.async=!1!==a.async;this.data=void 0!==a.data?a.data:null;this.agent=a.agent;this.isBinary=a.isBinary;this.supportsBinary=a.supportsBinary;this.enablesXDR=
a.enablesXDR;this.requestTimeout=a.requestTimeout;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized;this.extraHeaders=a.extraHeaders;this.create()}function f(){for(var a in c.requests)c.requests.hasOwnProperty(a)&&c.requests[a].abort()}var q=b(18),l=b(21),u=b(8),h=b(32),x=b(3)("engine.io-client:polling-xhr");d.exports=g;d.exports.Request=c;h(g,l);g.prototype.supportsBinary=!0;g.prototype.request=
function(a){return(a=a||{}).uri=this.uri(),a.xd=this.xd,a.xs=this.xs,a.agent=this.agent||!1,a.supportsBinary=this.supportsBinary,a.enablesXDR=this.enablesXDR,a.pfx=this.pfx,a.key=this.key,a.passphrase=this.passphrase,a.cert=this.cert,a.ca=this.ca,a.ciphers=this.ciphers,a.rejectUnauthorized=this.rejectUnauthorized,a.requestTimeout=this.requestTimeout,a.extraHeaders=this.extraHeaders,new c(a)};g.prototype.doWrite=function(a,b){a=this.request({method:"POST",data:a,isBinary:"string"!=typeof a&&void 0!==
a});var c=this;a.on("success",b);a.on("error",function(a){c.onError("xhr post error",a)});this.sendXhr=a};g.prototype.doPoll=function(){x("xhr poll");var a=this.request(),b=this;a.on("data",function(a){b.onData(a)});a.on("error",function(a){b.onError("xhr poll error",a)});this.pollXhr=a};u(c.prototype);c.prototype.create=function(){var b={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};b.pfx=this.pfx;b.key=this.key;b.passphrase=this.passphrase;b.cert=this.cert;b.ca=this.ca;
b.ciphers=this.ciphers;b.rejectUnauthorized=this.rejectUnauthorized;var f=this.xhr=new q(b),d=this;try{x("xhr open %s: %s",this.method,this.uri);f.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var g in f.setDisableHeaderCheck&&f.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(g)&&f.setRequestHeader(g,this.extraHeaders[g])}catch(A){}if("POST"===this.method)try{this.isBinary?f.setRequestHeader("Content-type","application/octet-stream"):f.setRequestHeader("Content-type",
"text/plain;charset\x3dUTF-8")}catch(A){}try{f.setRequestHeader("Accept","*/*")}catch(A){}"withCredentials"in f&&(f.withCredentials=!0);this.requestTimeout&&(f.timeout=this.requestTimeout);this.hasXDR()?(f.onload=function(){d.onLoad()},f.onerror=function(){d.onError(f.responseText)}):f.onreadystatechange=function(){if(2===f.readyState){try{var a=f.getResponseHeader("Content-Type")}catch(v){}"application/octet-stream"===a&&(f.responseType="arraybuffer")}4===f.readyState&&(200===f.status||1223===f.status?
d.onLoad():setTimeout(function(){d.onError(f.status)},0))};x("xhr data %s",this.data);f.send(this.data)}catch(A){return void setTimeout(function(){d.onError(A)},0)}a.document&&(this.index=c.requestsCount++,c.requests[this.index]=this)};c.prototype.onSuccess=function(){this.emit("success");this.cleanup()};c.prototype.onData=function(a){this.emit("data",a);this.onSuccess()};c.prototype.onError=function(a){this.emit("error",a);this.cleanup(!0)};c.prototype.cleanup=function(b){if(void 0!==this.xhr&&null!==
this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=e:this.xhr.onreadystatechange=e,b)try{this.xhr.abort()}catch(r){}a.document&&delete c.requests[this.index];this.xhr=null}};c.prototype.onLoad=function(){try{try{var a=this.xhr.getResponseHeader("Content-Type")}catch(p){}var b="application/octet-stream"===a&&this.xhr.response||this.xhr.responseText}catch(p){this.onError(p)}null!=b&&this.onData(b)};c.prototype.hasXDR=function(){return void 0!==a.XDomainRequest&&!this.xs&&this.enablesXDR};c.prototype.abort=
function(){this.cleanup()};c.requestsCount=0;c.requests={};a.document&&(a.attachEvent?a.attachEvent("onunload",f):a.addEventListener&&a.addEventListener("beforeunload",f,!1))}).call(e,function(){return this}())},function(d,e,b){function a(a){var b=a&&a.forceBase64;l&&!b||(this.supportsBinary=!1);h.call(this,a)}var h=b(22),g=b(31),c=b(23);e=b(32);var f=b(33),q=b(3)("engine.io-client:polling");d.exports=a;var l=null!=(new (b(18))({xdomain:!1})).responseType;e(a,h);a.prototype.name="polling";a.prototype.doOpen=
function(){this.poll()};a.prototype.pause=function(a){function b(){q("paused");c.readyState="paused";a()}var c=this;if(this.readyState="pausing",this.polling||!this.writable){var f=0;this.polling&&(q("we are currently polling - waiting to pause"),f++,this.once("pollComplete",function(){q("pre-pause polling complete");--f||b()}));this.writable||(q("we are currently writing - waiting to pause"),f++,this.once("drain",function(){q("pre-pause writing complete");--f||b()}))}else b()};a.prototype.poll=function(){q("polling");
this.polling=!0;this.doPoll();this.emit("poll")};a.prototype.onData=function(a){var b=this;q("polling got data %s",a);c.decodePayload(a,this.socket.binaryType,function(a,c,f){return"opening"===b.readyState&&b.onOpen(),"close"===a.type?(b.onClose(),!1):void b.onPacket(a)});"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():q('ignoring poll - transport state "%s"',this.readyState))};a.prototype.doClose=function(){function a(){q("writing close packet");
b.write([{type:"close"}])}var b=this;"open"===this.readyState?(q("transport open - closing"),a()):(q("transport not open - deferring close"),this.once("open",a))};a.prototype.write=function(a){var b=this;this.writable=!1;var f=function(){b.writable=!0;b.emit("drain")};c.encodePayload(a,this.supportsBinary,function(a){b.doWrite(a,f)})};a.prototype.uri=function(){var a=this.query||{},b=this.secure?"https":"http",c="";!1!==this.timestampRequests&&(a[this.timestampParam]=f());this.supportsBinary||a.sid||
(a.b64=1);a=g.encode(a);this.port&&("https"===b&&443!==Number(this.port)||"http"===b&&80!==Number(this.port))&&(c=":"+this.port);a.length&&(a="?"+a);var d=-1!==this.hostname.indexOf(":");return b+"://"+(d?"["+this.hostname+"]":this.hostname)+c+this.path+a}},function(d,e,b){function a(a){this.path=a.path;this.hostname=a.hostname;this.port=a.port;this.secure=a.secure;this.query=a.query;this.timestampParam=a.timestampParam;this.timestampRequests=a.timestampRequests;this.readyState="";this.agent=a.agent||
!1;this.socket=a.socket;this.enablesXDR=a.enablesXDR;this.pfx=a.pfx;this.key=a.key;this.passphrase=a.passphrase;this.cert=a.cert;this.ca=a.ca;this.ciphers=a.ciphers;this.rejectUnauthorized=a.rejectUnauthorized;this.forceNode=a.forceNode;this.extraHeaders=a.extraHeaders;this.localAddress=a.localAddress}var h=b(23);e=b(8);d.exports=a;e(a.prototype);a.prototype.onError=function(a,b){a=Error(a);return a.type="TransportError",a.description=b,this.emit("error",a),this};a.prototype.open=function(){return"closed"!==
this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this};a.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this};a.prototype.send=function(a){if("open"!==this.readyState)throw Error("Transport not open");this.write(a)};a.prototype.onOpen=function(){this.readyState="open";this.writable=!0;this.emit("open")};a.prototype.onData=function(a){a=h.decodePacket(a,this.socket.binaryType);this.onPacket(a)};
a.prototype.onPacket=function(a){this.emit("packet",a)};a.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},function(d,e,b){(function(a){function d(a,b,c){if(!b)return e.encodeBase64Packet(a,c);if(r)return function(a,b,c){if(!b)return e.encodeBase64Packet(a,c);var f=new FileReader;return f.onload=function(){a.data=f.result;e.encodePacket(a,b,!0,c)},f.readAsArrayBuffer(a.data)}(a,b,c);b=new Uint8Array(1);b[0]=p[a.type];a=new v([b.buffer,a.data]);return c(a)}function g(a,b,
c){var f=Array(a.length);c=u(a.length,c);for(var d=function(a,c,t){b(c,function(b,c){f[a]=c;t(b,f)})},e=0;e<a.length;e++)d(e,a[e],c)}var c,f=b(24),q=b(9),l=b(25),u=b(26),h=b(27);a&&a.ArrayBuffer&&(c=b(29));var x="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),m="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),r=x||m;e.protocol=3;var p=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},z=f(p),A={type:"error",data:"parser error"},v=b(30);e.encodePacket=
function(b,c,f,g){"function"==typeof c&&(g=c,c=!1);"function"==typeof f&&(g=f,f=null);var m=void 0===b.data?void 0:b.data.buffer||b.data;if(a.ArrayBuffer&&m instanceof ArrayBuffer){f=g;if(c){g=b.data;c=new Uint8Array(g);g=new Uint8Array(1+g.byteLength);g[0]=p[b.type];for(b=0;b<c.length;b++)g[b+1]=c[b];b=f(g.buffer)}else b=e.encodeBase64Packet(b,f);return b}if(v&&m instanceof a.Blob)return d(b,c,g);if(m&&m.base64)return g("b"+e.packets[b.type]+b.data.data);c=p[b.type];return void 0!==b.data&&(c+=f?
h.encode(String(b.data),{strict:!1}):String(b.data)),g(""+c)};e.encodeBase64Packet=function(b,c){var f="b"+e.packets[b.type];if(v&&b.data instanceof a.Blob){var d=new FileReader;return d.onload=function(){var a=d.result.split(",")[1];c(f+a)},d.readAsDataURL(b.data)}try{var g=String.fromCharCode.apply(null,new Uint8Array(b.data))}catch(J){b=new Uint8Array(b.data);g=Array(b.length);for(var m=0;m<b.length;m++)g[m]=b[m];g=String.fromCharCode.apply(null,g)}return f+=a.btoa(g),c(f)};e.decodePacket=function(a,
b,c){if(void 0===a)return A;if("string"==typeof a){if("b"===a.charAt(0))return e.decodeBase64Packet(a.substr(1),b);if(b=c){try{a=h.decode(a,{strict:!1})}catch(E){a=!1}b=!1===a}if(b)return A;c=a.charAt(0);return Number(c)==c&&z[c]?1<a.length?{type:z[c],data:a.substring(1)}:{type:z[c]}:A}c=(new Uint8Array(a))[0];a=l(a,1);return v&&"blob"===b&&(a=new v([a])),{type:z[c],data:a}};e.decodeBase64Packet=function(a,b){var f=z[a.charAt(0)];if(!c)return{type:f,data:{base64:!0,data:a.substr(1)}};a=c.decode(a.substr(1));
return"blob"===b&&v&&(a=new v([a])),{type:f,data:a}};e.encodePayload=function(a,b,c){"function"==typeof b&&(c=b,b=null);var f=q(a);return b&&f?v&&!r?e.encodePayloadAsBlob(a,c):e.encodePayloadAsArrayBuffer(a,c):a.length?void g(a,function(a,c){e.encodePacket(a,!!f&&b,!1,function(a){c(null,a.length+":"+a)})},function(a,b){return c(b.join(""))}):c("0:")};e.decodePayload=function(a,b,c){if("string"!=typeof a)return e.decodePayloadAsBinary(a,b,c);var f;if("function"==typeof b&&(c=b,b=null),""===a)return c(A,
0,1);for(var d,g,m="",p=0,t=a.length;p<t;p++){var l=a.charAt(p);if(":"===l){if(""===m||m!=(d=Number(m))||(g=a.substr(p+1,d),m!=g.length))return c(A,0,1);if(g.length){if(f=e.decodePacket(g,b,!1),A.type===f.type&&A.data===f.data)return c(A,0,1);if(!1===c(f,p+d,t))return}p+=d;m=""}else m+=l}return""!==m?c(A,0,1):void 0};e.encodePayloadAsArrayBuffer=function(a,b){return a.length?void g(a,function(a,b){e.encodePacket(a,!0,!0,function(a){return b(null,a)})},function(a,c){a=c.reduce(function(a,b){var c;
return c="string"==typeof b?b.length:b.byteLength,a+c.toString().length+c+2},0);var f=new Uint8Array(a),d=0;return c.forEach(function(a){var b="string"==typeof a,c=a;if(b){c=new Uint8Array(a.length);for(var e=0;e<a.length;e++)c[e]=a.charCodeAt(e);c=c.buffer}f[d++]=b?0:1;a=c.byteLength.toString();for(e=0;e<a.length;e++)f[d++]=parseInt(a[e]);f[d++]=255;c=new Uint8Array(c);for(e=0;e<c.length;e++)f[d++]=c[e]}),b(f.buffer)}):b(new ArrayBuffer(0))};e.encodePayloadAsBlob=function(a,b){g(a,function(a,b){e.encodePacket(a,
!0,!0,function(a){var c=new Uint8Array(1);if(c[0]=1,"string"==typeof a){for(var f=new Uint8Array(a.length),d=0;d<a.length;d++)f[d]=a.charCodeAt(d);a=f.buffer;c[0]=0}f=(a instanceof ArrayBuffer?a.byteLength:a.size).toString();var t=new Uint8Array(f.length+1);for(d=0;d<f.length;d++)t[d]=parseInt(f[d]);if(t[f.length]=255,v)a=new v([c.buffer,t.buffer,a]),b(null,a)})},function(a,c){return b(new v(c))})};e.decodePayloadAsBinary=function(a,b,c){"function"==typeof b&&(c=b,b=null);for(var f=[];0<a.byteLength;){for(var d=
new Uint8Array(a),g=0===d[0],m="",p=1;255!==d[p];p++){if(310<m.length)return c(A,0,1);m+=d[p]}a=l(a,2+m.length);m=parseInt(m);d=l(a,0,m);if(g)try{d=String.fromCharCode.apply(null,new Uint8Array(d))}catch(C){for(g=new Uint8Array(d),d="",p=0;p<g.length;p++)d+=String.fromCharCode(g[p])}f.push(d);a=l(a,m)}var t=f.length;f.forEach(function(a,f){c(e.decodePacket(a,b,!0),f,t)})}}).call(e,function(){return this}())},function(d,e){d.exports=Object.keys||function(b){var a=[],d=Object.prototype.hasOwnProperty,
e;for(e in b)d.call(b,e)&&a.push(e);return a}},function(d,e){d.exports=function(b,a,d){var e=b.byteLength;if(a=a||0,d=d||e,b.slice)return b.slice(a,d);if(0>a&&(a+=e),0>d&&(d+=e),d>e&&(d=e),a>=e||a>=d||0===e)return new ArrayBuffer(0);b=new Uint8Array(b);e=new Uint8Array(d-a);for(var c=0;a<d;a++,c++)e[c]=b[a];return e.buffer}},function(d,e){function b(){}d.exports=function(a,d,e){function c(a,b){if(0>=c.count)throw Error("after called too many times");--c.count;a?(f=!0,d(a),d=e):0!==c.count||f||d(null,
b)}var f=!1;return e=e||b,c.count=a,0===a?d():c}},function(d,e,b){var a;(function(b,d){!function(c){function f(a){for(var b,c,f=[],d=0,e=a.length;d<e;)55296<=(b=a.charCodeAt(d++))&&56319>=b&&d<e?56320==(64512&(c=a.charCodeAt(d++)))?f.push(((1023&b)<<10)+(1023&c)+65536):(f.push(b),d--):f.push(b);return f}function e(a,b){if(55296<=a&&57343>=a){if(b)throw Error("Lone surrogate U+"+a.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function g(){if(m>=x)throw Error("Invalid byte index");
var a=255&h[m];if(m++,128==(192&a))return 63&a;throw Error("Invalid continuation byte");}function u(a){var b,c,f,d,p;if(m>x)throw Error("Invalid byte index");if(m==x)return!1;if(b=255&h[m],m++,0==(128&b))return b;if(192==(224&b)){if(c=g(),128<=(p=(31&b)<<6|c))return p;throw Error("Invalid continuation byte");}if(224==(240&b)){if(c=g(),f=g(),2048<=(p=(15&b)<<12|c<<6|f))return e(p,a)?p:65533;throw Error("Invalid continuation byte");}if(240==(248&b)&&(c=g(),f=g(),d=g(),65536<=(p=(7&b)<<18|c<<12|f<<6|
d)&&1114111>=p))return p;throw Error("Invalid UTF-8 detected");}c=("object"==typeof b&&b&&b.exports,"object"==typeof d&&d);c.global!==c&&c.window;var h,x,m,r=String.fromCharCode;void 0===(a={version:"2.1.2",encode:function(a,b){b=!1!==(b||{}).strict;a=f(a);for(var c=a.length,d=-1,g="";++d<c;){var m=a[d];var p=b;if(0==(4294967168&m))p=r(m);else{var l="";p=(0==(4294965248&m)?l=r(m>>6&31|192):0==(4294901760&m)?(e(m,p)||(m=65533),l=r(m>>12&15|224),l+=r(m>>6&63|128)):0==(4292870144&m)&&(l=r(m>>18&7|240),
l+=r(m>>12&63|128),l+=r(m>>6&63|128)),l+r(63&m|128))}g+=p}return g},decode:function(a,b){b=!1!==(b||{}).strict;h=f(a);x=h.length;m=0;var c;for(a=[];!1!==(c=u(b));)a.push(c);var d;b=a.length;c=-1;for(var e="";++c<b;)65535<(d=a[c])&&(e+=r((d-=65536)>>>10&1023|55296),d=56320|1023&d),e+=r(d);return e}})||(b.exports=a)}()}).call(e,b(28)(d),function(){return this}())},function(d,e){d.exports=function(b){return b.webpackPolyfill||(b.deprecate=function(){},b.paths=[],b.children=[],b.webpackPolyfill=1),b}},
function(d,e){!function(){for(var b=new Uint8Array(256),a=0;64>a;a++)b["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(a)]=a;e.encode=function(a){var b=new Uint8Array(a),c=b.length,f="";for(a=0;a<c;a+=3)f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[b[a]>>2],f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(3&b[a])<<4|b[a+1]>>4],f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(15&b[a+1])<<2|b[a+2]>>6],
f+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&b[a+2]];return 2==c%3?f=f.substring(0,f.length-1)+"\x3d":1==c%3&&(f=f.substring(0,f.length-2)+"\x3d\x3d"),f};e.decode=function(a){var d=.75*a.length;var c=a.length,f=0;"\x3d"===a[a.length-1]&&(d--,"\x3d"===a[a.length-2]&&d--);var e=new ArrayBuffer(d),l=new Uint8Array(e);for(d=0;d<c;d+=4){var u=b[a.charCodeAt(d)];var h=b[a.charCodeAt(d+1)];var x=b[a.charCodeAt(d+2)];var m=b[a.charCodeAt(d+3)];l[f++]=u<<2|h>>4;l[f++]=(15&h)<<4|
x>>2;l[f++]=(3&x)<<6|63&m}return e}}()},function(d,e){(function(b){function a(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.buffer instanceof ArrayBuffer){var f=c.buffer;if(c.byteLength!==f.byteLength){var d=new Uint8Array(c.byteLength);d.set(new Uint8Array(f,c.byteOffset,c.byteLength));f=d.buffer}a[b]=f}}}function e(b,f){f=f||{};var d=new c;a(b);for(var e=0;e<b.length;e++)d.append(b[e]);return f.type?d.getBlob(f.type):d.getBlob()}function g(b,c){return a(b),new Blob(b,c||{})}var c=b.BlobBuilder||
b.WebKitBlobBuilder||b.MSBlobBuilder||b.MozBlobBuilder;try{var f=2===(new Blob(["hi"])).size}catch(u){f=!1}var q;if(q=f)try{q=2===(new Blob([new Uint8Array([1,2])])).size}catch(u){q=!1}var l=c&&c.prototype.append&&c.prototype.getBlob;d.exports=f?q?b.Blob:g:l?e:void 0}).call(e,function(){return this}())},function(d,e){e.encode=function(b){var a="",d;for(d in b)b.hasOwnProperty(d)&&(a.length&&(a+="\x26"),a+=encodeURIComponent(d)+"\x3d"+encodeURIComponent(b[d]));return a};e.decode=function(b){var a=
{};b=b.split("\x26");for(var d=0,e=b.length;d<e;d++){var c=b[d].split("\x3d");a[decodeURIComponent(c[0])]=decodeURIComponent(c[1])}return a}},function(d,e){d.exports=function(b,a){var d=function(){};d.prototype=a.prototype;b.prototype=new d;b.prototype.constructor=b}},function(d,e){function b(a){var b="";do b=g[a%c]+b,a=Math.floor(a/c);while(0<a);return b}function a(){var a=b(+new Date);return a!==h?(q=0,h=a):a+"."+b(q++)}for(var h,g="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),
c=64,f={},q=0,l=0;l<c;l++)f[g[l]]=l;a.encode=b;a.decode=function(a){var b=0;for(l=0;l<a.length;l++)b=b*c+f[a.charAt(l)];return b};d.exports=a},function(d,e,b){(function(a){function e(){}function g(b){c.call(this,b);this.query=this.query||{};q||(a.___eio||(a.___eio=[]),q=a.___eio);this.index=q.length;var f=this;q.push(function(a){f.onData(a)});this.query.j=this.index;a.document&&a.addEventListener&&a.addEventListener("beforeunload",function(){f.script&&(f.script.onerror=e)},!1)}var c=b(21),f=b(32);
d.exports=g;var q,l=/\n/g,h=/\\n/g;f(g,c);g.prototype.supportsBinary=!1;g.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null);c.prototype.doClose.call(this)};g.prototype.doPoll=function(){var a=this,b=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null);b.async=!0;b.src=this.uri();b.onerror=function(b){a.onError("jsonp poll error",
b)};var c=document.getElementsByTagName("script")[0];c?c.parentNode.insertBefore(b,c):(document.head||document.body).appendChild(b);this.script=b;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var a=document.createElement("iframe");document.body.appendChild(a);document.body.removeChild(a)},100)};g.prototype.doWrite=function(a,b){function c(){f();b()}function f(){if(d.iframe)try{d.form.removeChild(d.iframe)}catch(H){d.onError("jsonp polling iframe removal error",
H)}try{e=document.createElement('\x3ciframe src\x3d"javascript:0" name\x3d"'+d.iframeId+'"\x3e')}catch(H){(e=document.createElement("iframe")).name=d.iframeId,e.src="javascript:0"}e.id=d.iframeId;d.form.appendChild(e);d.iframe=e}var d=this;if(!this.form){var e,g=document.createElement("form"),q=document.createElement("textarea"),u=this.iframeId="eio_iframe_"+this.index;g.className="socketio";g.style.position="absolute";g.style.top="-1000px";g.style.left="-1000px";g.target=u;g.method="POST";g.setAttribute("accept-charset",
"utf-8");q.name="d";g.appendChild(q);document.body.appendChild(g);this.form=g;this.area=q}this.form.action=this.uri();f();a=a.replace(h,"\\\n");this.area.value=a.replace(l,"\\n");try{this.form.submit()}catch(H){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===d.iframe.readyState&&c()}:this.iframe.onload=c}}).call(e,function(){return this}())},function(d,e,b){(function(a){function e(a){a&&a.forceBase64&&(this.supportsBinary=!1);this.perMessageDeflate=a.perMessageDeflate;
this.usingBrowserWebSocket=k&&!a.forceNode;this.protocols=a.protocols;this.usingBrowserWebSocket||(m=x);g.call(this,a)}var g=b(22),c=b(23),f=b(31),q=b(32),l=b(33),h=b(3)("engine.io-client:websocket"),k=a.WebSocket||a.MozWebSocket;if("undefined"==typeof window)try{var x=b(36)}catch(r){}var m=k;m||"undefined"!=typeof window||(m=x);d.exports=e;q(e,g);e.prototype.name="websocket";e.prototype.supportsBinary=!0;e.prototype.doOpen=function(){if(this.check()){var a=this.uri(),b=this.protocols,c={agent:this.agent,
perMessageDeflate:this.perMessageDeflate};c.pfx=this.pfx;c.key=this.key;c.passphrase=this.passphrase;c.cert=this.cert;c.ca=this.ca;c.ciphers=this.ciphers;c.rejectUnauthorized=this.rejectUnauthorized;this.extraHeaders&&(c.headers=this.extraHeaders);this.localAddress&&(c.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?b?new m(a,b):new m(a):new m(a,b,c)}catch(A){return this.emit("error",A)}void 0===this.ws.binaryType&&(this.supportsBinary=!1);this.ws.supports&&this.ws.supports.binary?
(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer";this.addEventListeners()}};e.prototype.addEventListeners=function(){var a=this;this.ws.onopen=function(){a.onOpen()};this.ws.onclose=function(){a.onClose()};this.ws.onmessage=function(b){a.onData(b.data)};this.ws.onerror=function(b){a.onError("websocket error",b)}};e.prototype.write=function(b){var f=this;this.writable=!1;for(var d=b.length,e=0,g=d;e<g;e++)!function(b){c.encodePacket(b,f.supportsBinary,function(c){if(!f.usingBrowserWebSocket){var e=
{};(b.options&&(e.compress=b.options.compress),f.perMessageDeflate)&&("string"==typeof c?a.Buffer.byteLength(c):c.length)<f.perMessageDeflate.threshold&&(e.compress=!1)}try{f.usingBrowserWebSocket?f.ws.send(c):f.ws.send(c,e)}catch(E){h("websocket closed before onclose event")}--d||(f.emit("flush"),setTimeout(function(){f.writable=!0;f.emit("drain")},0))})}(b[e])};e.prototype.onClose=function(){g.prototype.onClose.call(this)};e.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()};e.prototype.uri=
function(){var a=this.query||{},b=this.secure?"wss":"ws",c="";this.port&&("wss"===b&&443!==Number(this.port)||"ws"===b&&80!==Number(this.port))&&(c=":"+this.port);this.timestampRequests&&(a[this.timestampParam]=l());this.supportsBinary||(a.b64=1);(a=f.encode(a)).length&&(a="?"+a);var d=-1!==this.hostname.indexOf(":");return b+"://"+(d?"["+this.hostname+"]":this.hostname)+c+this.path+a};e.prototype.check=function(){return!(!m||"__initialize"in m&&this.name===e.prototype.name)}}).call(e,function(){return this}())},
function(d,e){},function(d,e){var b=[].indexOf;d.exports=function(a,d){if(b)return a.indexOf(d);for(var e=0;e<a.length;++e)if(a[e]===d)return e;return-1}},function(d,e){(function(b){var a=/^[\],:{}\s]*$/,e=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,g=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,c=/(?:^|:|,)(?:\s*\[)+/g,f=/^\s+/,q=/\s+$/;d.exports=function(d){return"string"==typeof d&&d?(d=d.replace(f,"").replace(q,""),b.JSON&&JSON.parse?JSON.parse(d):a.test(d.replace(e,"@").replace(g,
"]").replace(c,""))?(new Function("return "+d))():void 0):null}}).call(e,function(){return this}())},function(d,e,b){function a(a,b,c){this.io=a;this.nsp=b;this.json=this;this.ids=0;this.acks={};this.receiveBuffer=[];this.sendBuffer=[];this.connected=!1;this.disconnected=!0;c&&c.query&&(this.query=c.query);this.io.autoConnect&&this.open()}$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbolIterator();var h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:
function(a){$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},g=b(7);e=b(8);var c=b(40),f=b(41),q=b(42),l=b(3)("socket.io-client:socket"),u=b(31);d.exports=a;var k={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},x=e.prototype.emit;e(a.prototype);a.prototype.subEvents=
function(){if(!this.subs){var a=this.io;this.subs=[f(a,"open",q(this,"onopen")),f(a,"packet",q(this,"onpacket")),f(a,"close",q(this,"onclose"))]}};a.prototype.open=a.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)};a.prototype.send=function(){var a=c(arguments);return a.unshift("message"),this.emit.apply(this,a),this};a.prototype.emit=function(a){if(k.hasOwnProperty(a))return x.apply(this,
arguments),this;var b=c(arguments),f={type:g.EVENT,data:b,options:{}};return f.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof b[b.length-1]&&(l("emitting packet with ack id %d",this.ids),this.acks[this.ids]=b.pop(),f.id=this.ids++),this.connected?this.packet(f):this.sendBuffer.push(f),delete this.flags,this};a.prototype.packet=function(a){a.nsp=this.nsp;this.io.packet(a)};a.prototype.onopen=function(){if(l("transport is open - connecting"),"/"!==this.nsp)if(this.query){var a=
"object"===h(this.query)?u.encode(this.query):this.query;l("sending connect packet with query %s",a);this.packet({type:g.CONNECT,query:a})}else this.packet({type:g.CONNECT})};a.prototype.onclose=function(a){l("close (%s)",a);this.connected=!1;this.disconnected=!0;delete this.id;this.emit("disconnect",a)};a.prototype.onpacket=function(a){if(a.nsp===this.nsp)switch(a.type){case g.CONNECT:this.onconnect();break;case g.EVENT:case g.BINARY_EVENT:this.onevent(a);break;case g.ACK:case g.BINARY_ACK:this.onack(a);
break;case g.DISCONNECT:this.ondisconnect();break;case g.ERROR:this.emit("error",a.data)}};a.prototype.onevent=function(a){var b=a.data||[];l("emitting event %j",b);null!=a.id&&(l("attaching ack callback to event"),b.push(this.ack(a.id)));this.connected?x.apply(this,b):this.receiveBuffer.push(b)};a.prototype.ack=function(a){var b=this,f=!1;return function(){if(!f){f=!0;var d=c(arguments);l("sending ack %j",d);b.packet({type:g.ACK,id:a,data:d})}}};a.prototype.onack=function(a){var b=this.acks[a.id];
"function"==typeof b?(l("calling ack %s with %j",a.id,a.data),b.apply(this,a.data),delete this.acks[a.id]):l("bad ack %s",a.id)};a.prototype.onconnect=function(){this.connected=!0;this.disconnected=!1;this.emit("connect");this.emitBuffered()};a.prototype.emitBuffered=function(){var a;for(a=0;a<this.receiveBuffer.length;a++)x.apply(this,this.receiveBuffer[a]);this.receiveBuffer=[];for(a=0;a<this.sendBuffer.length;a++)this.packet(this.sendBuffer[a]);this.sendBuffer=[]};a.prototype.ondisconnect=function(){l("server disconnect (%s)",
this.nsp);this.destroy();this.onclose("io server disconnect")};a.prototype.destroy=function(){if(this.subs){for(var a=0;a<this.subs.length;a++)this.subs[a].destroy();this.subs=null}this.io.destroy(this)};a.prototype.close=a.prototype.disconnect=function(){return this.connected&&(l("performing disconnect (%s)",this.nsp),this.packet({type:g.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this};a.prototype.compress=function(a){return this.flags=this.flags||{},this.flags.compress=
a,this}},function(d,e){d.exports=function(b,a){for(var d=[],e=(a=a||0)||0;e<b.length;e++)d[e-a]=b[e];return d}},function(d,e){d.exports=function(b,a,d){return b.on(a,d),{destroy:function(){b.removeListener(a,d)}}}},function(d,e){var b=[].slice;d.exports=function(a,d){if("string"==typeof d&&(d=a[d]),"function"!=typeof d)throw Error("bind() requires a function");var e=b.call(arguments,2);return function(){return d.apply(a,e.concat(b.call(arguments)))}}},function(d,e){function b(a){a=a||{};this.ms=a.min||
100;this.max=a.max||1E4;this.factor=a.factor||2;this.jitter=0<a.jitter&&1>=a.jitter?a.jitter:0;this.attempts=0}d.exports=b;b.prototype.duration=function(){var a=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var b=Math.random(),d=Math.floor(b*this.jitter*a);a=0==(1&Math.floor(10*b))?a-d:a+d}return 0|Math.min(a,this.max)};b.prototype.reset=function(){this.attempts=0};b.prototype.setMin=function(a){this.ms=a};b.prototype.setMax=function(a){this.max=a};b.prototype.setJitter=function(a){this.jitter=
a}}])},function(k,n,h){function d(a,b,c){var f=b.simulcast["dir"+a];a=b.simulcast["list"+a];if(f){var d=l.byValue(f);e.parseSimulcastStreamList(a).forEach(function(a){var b=[];a.forEach(function(a){b.push(new z(a.scid,a.paused))});c.addSimulcastAlternativeStreams(d,b)})}}var e=h(21),b=h(8),a=h(9),w=h(10),g=h(11),c=h(12),f=h(4),q=h(6),l=h(3),u=h(14),y=h(15),x=h(16),m=h(17),r=h(24),p=h(13),z=h(25),A=h(26),v=function(a){this.version=a||1;this.name="sdp-semantic";this.streams=new Map;this.medias=[];this.candidates=
[];this.dtls=this.ice=this.connection=null};v.prototype.clone=function(){var a=new v(this.version);return a.name=this.name,a.setConnection(this.connection),this.medias.forEach(function(b){a.addMedia(b.clone())}),this.streams.forEach(function(b){a.addStream(b.clone())}),this.candidates.forEach(function(b){a.addCandidate(b.clone())}),a.setICE(this.ice.clone()),a.setDTLS(this.dtls.clone()),a};v.prototype.plain=function(){var a={version:this.version,name:this.name,streams:[],medias:[],candidates:[],connection:this.connection};
return this.medias.forEach(function(b){a.medias.push(b.plain())}),this.streams.forEach(function(b){a.streams.push(b.plain())}),this.candidates.forEach(function(b){a.candidates.push(b.plain())}),a.ice=this.ice&&this.ice.plain(),a.dtls=this.dtls&&this.dtls.plain(),a};v.prototype.setVersion=function(a){this.version=a};v.prototype.setOrigin=function(a){this.origin=a};v.prototype.setName=function(a){this.name=a};v.prototype.getConnection=function(){return this.connection};v.prototype.setConnection=function(a){this.connection=
a};v.prototype.setTiming=function(a){this.timing=a};v.prototype.addMedia=function(a){this.medias.push(a)};v.prototype.getMedia=function(a){var b;return this.medias.forEach(function(c){c.getType().toLowerCase()===a.toLowerCase()&&(b=c)}),b};v.prototype.getMedias=function(a){if(!a)return this.medias;var b=[];return this.medias.forEach(function(c){c.getType().toLowerCase()===a.toLowerCase()&&b.push(c)}),b};v.prototype.getMediaById=function(a){var b;return this.medias.forEach(function(c){c.getId().toLowerCase()===
a.toLowerCase()&&(b=c)}),b};v.prototype.getVersion=function(){return this.version};v.prototype.getDTLS=function(){return this.dtls};v.prototype.setDTLS=function(a){this.dtls=a};v.prototype.getICE=function(){return this.ice};v.prototype.setICE=function(a){this.ice=a};v.prototype.addCandidate=function(a){this.candidates.push(a)};v.prototype.addCandidates=function(a){var b=this;a.forEach(function(a){b.addCandidate(a)})};v.prototype.getCandidates=function(){return this.candidates};v.prototype.getStream=
function(a){return this.streams.get(a)};v.prototype.getStreams=function(){return this.streams};v.prototype.getFirstStream=function(){return 0<this.streams.values().length?this.streams.values()[0]:null};v.prototype.addStream=function(a){this.streams.set(a.getId(),a)};v.prototype.removeStream=function(a){this.streams.delete(a.getId())};v.prototype.toJSON=function(){var a={version:0,media:[]};a.version=this.version||0;a.origin=this.origin||{username:"-",sessionId:(new Date).getTime(),sessionVersion:this.version,
netType:"IN",ipVer:4,address:"127.0.0.1"};a.name=this.name||"semantic-sdp";a.connection=this.getConnection();a.timing=this.timing||{start:0,stop:0};var b=this.getICE();b&&(b.isLite()&&(a.icelite="ice-lite"),a.iceOptions=b.getOpts(),a.iceUfrag=b.getUfrag(),a.icePwd=b.getPwd());a.msidSemantic=this.msidSemantic||{semantic:"WMS",token:"*"};a.groups=[];var c={type:"BUNDLE",mids:[]},d=this.getDTLS();d&&(a.fingerprint={type:d.getHash(),hash:d.getFingerprint()},a.setup=f.toString(d.getSetup()));this.medias.forEach(function(c){var e=
{type:c.getType(),port:c.getPort(),protocol:"UDP/TLS/RTP/SAVPF",fmtp:[],rtp:[],rtcpFb:[],ext:[],bandwidth:[],candidates:[],ssrcGroups:[],ssrcs:[],rids:[]};e.direction=q.toString(c.getDirection());e.rtcpMux="rtcp-mux";e.connection=c.getConnection();e.xGoogleFlag=c.getXGoogleFlag();e.mid=c.getId();m.mids.push(c.getId());e.rtcp=c.rtcp;0<c.getBitrate()&&e.bandwidth.push({type:"AS",limit:c.getBitrate()});c.getCandidates().forEach(function(a){e.candidates.push({foundation:a.getFoundation(),component:a.getComponentId(),
transport:a.getTransport(),priority:a.getPriority(),ip:a.getAddress(),port:a.getPort(),type:a.getType(),relAddr:a.getRelAddr(),relPort:a.getRelPort(),generation:a.getGeneration()})});(b=c.getICE())&&(b.isLite()&&(e.icelite="ice-lite"),e.iceOptions=b.getOpts(),e.iceUfrag=b.getUfrag(),e.icePwd=b.getPwd(),b.isEndOfCandidates()&&(e.endOfCandidates=b.isEndOfCandidates()));(d=c.getDTLS())&&(e.fingerprint={type:d.getHash(),hash:d.getFingerprint()},e.setup=f.toString(d.getSetup()));c.setup&&(e.setup=f.toString(c.setup));
c.getCodecs().forEach(function(a){e.rtp.push({payload:a.getType(),codec:a.getCodec(),rate:a.getRate(),encoding:a.getEncoding()});var b=a.getParams();0<Object.keys(b).length&&e.fmtp.push({payload:a.getType(),config:Object.keys(b).map(function(a){return a+(b[a]?"\x3d"+b[a]:"")}).join(";")});a.getFeedback().forEach(function(b){e.rtcpFb.push({payload:a.getType(),type:b.type,subtype:b.subtype})});a.hasRTX()&&(e.rtp.push({payload:a.getRTX(),codec:"rtx",rate:a.getRate(),encoding:a.getEncoding()}),e.fmtp.push({payload:a.getRTX(),
config:"apt\x3d"+a.getType()}))});var t=[];e.rtp.forEach(function(a){t.push(a.payload)});e.payloads=t.join(" ");c.getExtensions().forEach(function(a,b){e.ext.push({value:b,uri:a})});c.getRIDs().forEach(function(a){var b={id:a.getId(),direction:l.toString(a.getDirection()),params:""};a.getFormats().length&&(b.params="pt\x3d"+a.getFormats().join(","));a.getParams().forEach(function(a,c){b.params+=(b.params.length?";":"")+c+"\x3d"+a});e.rids.push(b)});m=c.getSimulcast();c=c.getSimulcast03();if(m){var g=
1;e.simulcast={};var p=m.getSimulcastStreams(l.SEND),m=m.getSimulcastStreams(l.RECV);if(p&&p.length){var C="";p.forEach(function(a){var b="";a.forEach(function(a){b+=(b.length?",":"")+(a.isPaused()?"~":"")+a.getId()});C+=(C.length?";":"")+b});e.simulcast["dir"+g]="send";e.simulcast["list"+g]=C;g+=1}if(m&&m.length){var r=[];m.forEach(function(a){var b="";a.forEach(function(a){b+=(b.length?",":"")+(a.isPaused()?"~":"")+a.getId()});r+=(r.length?";":"")+b});e.simulcast["dir"+g]="recv";e.simulcast["list"+
g]=r;g+=1}}c&&(e.simulcast_03={value:c.getSimulcastPlainString()});a.media.push(e)});c.mids.sort();a.media.sort(function(a,b){return a.mid<b.mid?-1:a.mid>b.mid?1:0});for(var e=$jscomp.makeIterator(this.streams.values()),g=e.next();!g.done;g=e.next()){g=g.value;for(var m=$jscomp.makeIterator(g.getTracks().values()),p=m.next();!p.done;p=m.next()){p=p.value;for(var t={},C=$jscomp.makeIterator(a.media),r=C.next();!r.done;t={n$60:t.n$60},r=C.next())if(t.n$60=r.value,p.getMediaId()){if(p.getMediaId()===
t.n$60.mid){p.getSourceGroups().forEach(function(a){return function(b){a.n$60.ssrcGroups.push({semantics:b.getSemantics(),ssrcs:b.getSSRCs().join(" ")})}}(t));p.getSSRCs().forEach(function(a){return function(b){a.n$60.ssrcs.push({id:b.ssrc,attribute:"cname",value:b.getCName()})}}(t));g.getId()&&p.getId()&&(t.n$60.msid=g.getId()+" "+p.getId());break}}else if(t.n$60.type.toLowerCase()===p.getMedia().toLowerCase()){p.getSourceGroups().forEach(function(a){return function(b){a.n$60.ssrcGroups.push({semantics:b.getSemantics(),
ssrcs:b.getSSRCs().join(" ")})}}(t));p.getSSRCs().forEach(function(a){return function(b){a.n$60.ssrcs.push({id:b.ssrc,attribute:"cname",value:b.getCName()});b.getStreamId()&&b.getTrackId()&&a.n$60.ssrcs.push({id:b.ssrc,attribute:"msid",value:b.getStreamId()+" "+b.getTrackId()});b.getMSLabel()&&a.n$60.ssrcs.push({id:b.ssrc,attribute:"mslabel",value:b.getMSLabel()});b.getLabel()&&a.n$60.ssrcs.push({id:b.ssrc,attribute:"label",value:b.getLabel()})}}(t));break}}}return c.mids=c.mids.join(" "),a.groups.push(c),
a};v.prototype.toString=function(){var a=this.toJSON();return e.write(a)};v.processString=function(a){a=e.parse(a);return v.process(a)};v.process=function(e){var h=new v;h.setVersion(e.version);h.setTiming(e.timing);h.setConnection(e.connection);h.setOrigin(e.origin);h.msidSemantic=e.msidSemantic;h.name=e.name;var z=e.iceUfrag,k=e.icePwd,n=e.iceOptions;(z||k||n)&&h.setICE(new g(z,k,n));var D=e.fingerprint;if(D){z=D.type;var J=D.hash,B=null;e.setup&&(B=f.byValue(e.setup));h.setDTLS(new w(B,z,J))}return e.media.forEach(function(e){var t=
new c(e.mid,e.port,e.type);if(t.setXGoogleFlag(e.xGoogleFlag),t.rtcp=e.rtcp,t.setConnection(e.connection),e.bandwidth&&0<e.bandwidth.length&&e.bandwidth.forEach(function(a){"AS"===a.type&&t.setBitrate(a.limit)}),v=e.iceUfrag,k=e.icePwd,n=e.iceOptions,v||k||n){var B=new g(v,k,n);e.endOfCandidates&&B.setEndOfCandidates("end-of-candidates");t.setICE(B)}if(D=e.fingerprint){B=D.type;var v=D.hash,z=f.ACTPASS;e.setup&&(z=f.byValue(e.setup));t.setDTLS(new w(z,B,v))}e.setup&&t.setSetup(f.byValue(e.setup));
B=q.SENDRECV;e.direction&&(B=q.byValue(e.direction.toUpperCase()));t.setDirection(B);(B=e.candidates)&&B.forEach(function(a){t.addCandidate(new b(a.foundation,a.component,a.transport,a.priority,a.ip,a.port,a.type,a.generation,a.relAddr,a.relPort))});(function(b,c){var f=new Map;c.rtp.forEach(function(d){var e=d.payload,t=d.codec,g=d.rate;d=d.encoding;var l={},m=[];c.fmtp.forEach(function(a){a.payload===e&&a.config.split(";").forEach(function(a){a=a.split("\x3d");l[a[0].trim()]=(a[1]||"").trim()})});
c.rtcpFb&&c.rtcpFb.forEach(function(a){a.payload===e&&m.push({type:a.type,subtype:a.subtype})});"RTX"===t.toUpperCase()?f.set(parseInt(l.apt,10),e):b.addCodec(new a(t,e,g,d,l,m))});f.forEach(function(a,c){(c=b.getCodecForType(c))&&c.setRTX(a)})})(t,e);(B=e.ext)&&B.forEach(function(a){t.addExtension(a.value,a.uri)});(function(a,b){(b=b.rids)&&b.forEach(function(b){var c=new A(b.id,l.byValue(b.direction)),f=[],d=new Map;if(b.params){var e=J.parseParams(b.params);Object.keys(e).forEach(function(a){"pt"===
a?f=e[a].split(","):d.set(a,e[a])});c.setFormats(f);c.setParams(d)}a.addRID(c)})})(t,e);(function(a,b,c){var f=new Map,d=c.type;if(c.ssrcs){var e;c.ssrcs.forEach(function(c){var f=c.id,t=c.attribute;c=c.value;if((l=p.get(f))||(l=new y(f),p.set(l.getSSRC(),l)),"cname"===t.toLowerCase())l.setCName(c);else if("mslabel"===t.toLowerCase())l.setMSLabel(c);else if("label"===t.toLowerCase())l.setLabel(c);else if("msid"===t.toLowerCase()){f=c.split(" ");var p=f[0];f=f[1];l.setStreamId(p);l.setTrackId(f);(g=
b.getStream(p))||(g=new x(p),b.addStream(g));(e=g.getTrack(f))||((e=new m(d,f)).setEncodings(a),g.addTrack(e));e.addSSRC(l)}})}if(c.msid){var t=c.msid.split(" ");var g=t[0];var l=t[1];(t=b.getStream(g))||(t=new x(g),b.addStream(t));var p=t.getTrack(l);p||((p=new m(d,l)).setMediaId(c.mid),p.setEncodings(a),t.addTrack(p));f.forEach(function(a,b){a=f.get(b);a.getStreamId()||(a.setStreamId(g),a.setTrackId(l),p.addSSRC(a))})}c.ssrcGroups&&c.ssrcGroups.forEach(function(a){var c=a.ssrcs.split(" ");a=new u(a.semantics,
c);c=f.get(parseInt(c[0],10));b.getStream(c.getStreamId()).getTrack(c.getTrackId()).addSourceGroup(a)})})(function(a,b){var c=[];if(b.simulcast){var f=new p;d("1",b,f);d("2",b,f);f.getSimulcastStreams(l.SEND).forEach(function(b){var f=[];b.forEach(function(b){var c=new r(b.getId(),b.isPaused());(b=a.getRID(c.getId()))&&(b.getFormats().forEach(function(b){(b=a.getCodecForType(b))&&c.addCodec(b)}),c.setParams(b.getParams()),f.push(c))});f.length&&c.push(f)});a.setSimulcast(f)}b.simulcast_03&&(f=new p,
f.setSimulcastPlainString(b.simulcast_03.value),!0,a.setSimulcast03(f));return c}(t,e),h,e);h.addMedia(t)}),h};k.exports=v},function(k,n,h){k=h(22);h=h(23);n.write=h;n.parse=k.parse;n.parseFmtpConfig=k.parseFmtpConfig;n.parseParams=k.parseParams;n.parsePayloads=k.parsePayloads;n.parseRemoteCandidates=k.parseRemoteCandidates;n.parseImageAttributes=k.parseImageAttributes;n.parseSimulcastStreamList=k.parseSimulcastStreamList},function(k,n,h){var d=function(a){return String(Number(a))===a?Number(a):a},
e=h(7),b=RegExp.prototype.test.bind(/^([a-z])=(.*)/);n.parse=function(a){var g={},c=[],f=g;return a.split(/(\r\n|\r|\n)/).filter(b).forEach(function(a){var b=a[0],g=a.slice(2);"m"===b&&(c.push({rtp:[],fmtp:[]}),f=c[c.length-1]);for(a=0;a<(e[b]||[]).length;a+=1){var h=e[b][a];if(h.reg.test(g)){b=h;a=f;h=g;g=b.name&&b.names;b.push&&!a[b.push]?a[b.push]=[]:g&&!a[b.name]&&(a[b.name]={});g=b.push?{}:g?a[b.name]:a;h=h.match(b.reg);var q=b.names,m=b.name;if(m&&!q)g[m]=d(h[1]);else for(m=0;m<q.length;m+=
1)null!=h[m+1]&&(g[q[m]]=d(h[m+1]));!0;b.push&&a[b.push].push(g);break}}}),g.media=c,g};var a=function(a,b){var c=b.split(/=(.+)/,2);return 2===c.length?a[c[0]]=d(c[1]):1===c.length&&1<b.length&&(a[c[0]]=void 0),a};n.parseParams=function(b){return b.split(/;\s?/).reduce(a,{})};n.parseFmtpConfig=n.parseParams;n.parsePayloads=function(a){return a.split(" ").map(Number)};n.parseRemoteCandidates=function(a){var b=[];a=a.split(" ").map(d);for(var c=0;c<a.length;c+=3)b.push({component:a[c],ip:a[c+1],port:a[c+
2]});return b};n.parseImageAttributes=function(b){return b.split(" ").map(function(b){return b.substring(1,b.length-1).split(",").reduce(a,{})})};n.parseSimulcastStreamList=function(a){return a.split(";").map(function(a){return a.split(",").map(function(a){var b,c=!1;return"~"!==a[0]?b=d(a):(b=d(a.substring(1,a.length)),c=!0),{scid:b,paused:c}})})}},function(k,n,h){var d=h(7),e=/%[sdv%]/g,b=function(a,b,f){a=[a+"\x3d"+(b.format instanceof Function?b.format(b.push?f:f[b.name]):b.format)];if(b.names)for(var c=
0;c<b.names.length;c+=1){var d=b.names[c];b.name?a.push(f[b.name][d]):a.push(f[b.names[c]])}else a.push(f[b.name]);return function(a){var b=1,c=arguments,f=c.length;return a.replace(e,function(a){if(b>=f)return a;var d=c[b];switch(b+=1,a){case "%%":return"%";case "%s":return String(d);case "%d":return Number(d);case "%v":return""}})}.apply(null,a)},a="vosiuepcbtrza".split(""),w=["i","c","b","a"];k.exports=function(e,c){c=c||{};null==e.version&&(e.version=0);null==e.name&&(e.name=" ");e.media.forEach(function(a){null==
a.payloads&&(a.payloads="")});var f=c.innerOrder||w,g=[];return(c.outerOrder||a).forEach(function(a){d[a].forEach(function(c){c.name in e&&null!=e[c.name]?g.push(b(a,c,e)):c.push in e&&null!=e[c.push]&&e[c.push].forEach(function(f){g.push(b(a,c,f))})})}),e.media.forEach(function(a){g.push(b("m",d.m[0],a));f.forEach(function(c){d[c].forEach(function(f){f.name in a&&null!=a[f.name]?g.push(b(c,f,a)):f.push in a&&null!=a[f.push]&&a[f.push].forEach(function(a){g.push(b(c,f,a))})})})}),g.join("\r\n")+"\r\n"}},
function(k,n){var h=function(d,e){this.id=d;this.paused=e;this.codecs=new Map;this.params=new Map};h.prototype.clone=function(){var d=new h(this.id,this.paused);return this.codecs.forEach(function(e){d.addCodec(e.cloned())}),d.setParams(this.params),d};h.prototype.plain=function(){var d=this,e={id:this.id,paused:this.paused,codecs:{},params:{}};return this.codecs.keys().forEach(function(b){e.codecs[b]=d.codecs.get(b).plain()}),this.params.keys().forEach(function(b){e.params[b]=d.params.get(b).param}),
e};h.prototype.getId=function(){return this.id};h.prototype.getCodecs=function(){return this.codecs};h.prototype.addCodec=function(d){this.codecs.set(d.getType(),d)};h.prototype.getParams=function(){return this.params};h.prototype.setParams=function(d){this.params=new Map(d)};h.prototype.isPaused=function(){return this.paused};k.exports=h},function(k,n){var h=function(d,e){this.paused=e;this.id=d};h.prototype.clone=function(){return new h(this.id,this.paused)};h.prototype.plain=function(){return{id:this.id,
paused:this.paused}};h.prototype.isPaused=function(){return this.paused};h.prototype.getId=function(){return this.id};k.exports=h},function(k,n,h){var d=h(3),e=function(b,a){this.id=b;this.direction=a;this.formats=[];this.params=new Map};e.prototype.clone=function(){var b=new e(this.id,this.direction);return b.setFormats(this.formats),b.setParams(this.params),b};e.prototype.plain=function(){var b={id:this.id,direction:d.toString(this.direction),formats:this.formats,params:{}};return this.params.forEach(function(a,
d){b.params[d]=a}),b};e.prototype.getId=function(){return this.id};e.prototype.getDirection=function(){return this.direction};e.prototype.setDirection=function(b){this.direction=b};e.prototype.getFormats=function(){return this.formats};e.prototype.setFormats=function(b){var a=this;this.formats=[];b.forEach(function(b){a.formats.push(parseInt(b,10))})};e.prototype.getParams=function(){return this.params};e.prototype.setParams=function(b){this.params=new Map(b)};k.exports=e},function(k,n){k.exports=
function(h){if(!h.webpackPolyfill){var d=Object.create(h);d.children||(d.children=[]);Object.defineProperty(d,"loaded",{enumerable:!0,get:function(){return d.l}});Object.defineProperty(d,"id",{enumerable:!0,get:function(){return d.i}});Object.defineProperty(d,"exports",{enumerable:!0});d.webpackPolyfill=1}return d}},function(k,n,h){n=h(18);k.exports=n.adapter=h(29)},function(k,n,h){(function(d){k.exports=function g(b,a,d){function c(l,h){if(!a[l]){if(!b[l]){if(f)return f(l,!0);h=Error("Cannot find module '"+
l+"'");throw h.code="MODULE_NOT_FOUND",h;}h=a[l]={exports:{}};b[l][0].call(h.exports,function(a){return c(b[l][1][a]||a)},h,h.exports,g,b,a,d)}return a[l].exports}for(var f=!1,h=0;h<d.length;h++)c(d[h]);return c}({1:[function(b,a,d){function g(a,b,c,f,d){b=l.writeRtpDescription(a.kind,b);if(b+=l.writeIceParameters(a.iceGatherer.getLocalParameters()),b+=l.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===c?"actpass":d||"active"),b+="a\x3dmid:"+a.mid+"\r\n",a.direction?b+="a\x3d"+a.direction+
"\r\n":a.rtpSender&&a.rtpReceiver?b+="a\x3dsendrecv\r\n":a.rtpSender?b+="a\x3dsendonly\r\n":a.rtpReceiver?b+="a\x3drecvonly\r\n":b+="a\x3dinactive\r\n",a.rtpSender)c="msid:"+f.id+" "+a.rtpSender.track.id+"\r\n",b=b+("a\x3d"+c)+("a\x3dssrc:"+a.sendEncodingParameters[0].ssrc+" "+c),a.sendEncodingParameters[0].rtx&&(b+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+c,b+="a\x3dssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n");return b+="a\x3dssrc:"+
a.sendEncodingParameters[0].ssrc+" cname:"+l.localCName+"\r\n",a.rtpSender&&a.sendEncodingParameters[0].rtx&&(b+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" cname:"+l.localCName+"\r\n"),b}function c(a,b){var c={codecs:[],headerExtensions:[],fecMechanisms:[]},f=function(a,b){a=parseInt(a,10);for(var c=0;c<b.length;c++)if(b[c].payloadType===a||b[c].preferredPayloadType===a)return b[c]},d=function(a,b,c,d){a=f(a.parameters.apt,c);b=f(b.parameters.apt,d);return a&&b&&a.name.toLowerCase()===b.name.toLowerCase()};
return a.codecs.forEach(function(f){for(var g=0;g<b.codecs.length;g++){var m=b.codecs[g];if(f.name.toLowerCase()===m.name.toLowerCase()&&f.clockRate===m.clockRate&&("rtx"!==f.name.toLowerCase()||!f.parameters||!m.parameters.apt||d(f,m,a.codecs,b.codecs))){(m=JSON.parse(JSON.stringify(m))).numChannels=Math.min(f.numChannels,m.numChannels);c.codecs.push(m);m.rtcpFeedback=m.rtcpFeedback.filter(function(a){for(var b=0;b<f.rtcpFeedback.length;b++)if(f.rtcpFeedback[b].type===a.type&&f.rtcpFeedback[b].parameter===
a.parameter)return!0;return!1});break}}}),a.headerExtensions.forEach(function(a){for(var f=0;f<b.headerExtensions.length;f++){var d=b.headerExtensions[f];if(a.uri===d.uri){c.headerExtensions.push(d);break}}}),c}function f(a,b,c){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[b][a].indexOf(c)}
function h(a,b){var c=a.getRemoteCandidates().find(function(a){return b.foundation===a.foundation&&b.ip===a.ip&&b.port===a.port&&b.priority===a.priority&&b.protocol===a.protocol&&b.type===a.type});return c||a.addRemoteCandidate(b),!c}var l=b("sdp");a.exports=function(a,b){var d=function(c){var f=this,d=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(a){f[a]=d[a].bind(d)}),this.onicecandidate=null,this.onaddstream=null,this.ontrack=null,
this.onremovestream=null,this.onsignalingstatechange=null,this.oniceconnectionstatechange=null,this.onicegatheringstatechange=null,this.onnegotiationneeded=null,this.ondatachannel=null,this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this.localDescription=null,this.remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.iceGatheringState="new",c=JSON.parse(JSON.stringify(c||{})),this.usingBundle="max-bundle"===c.bundlePolicy,
"negotiate"===c.rtcpMuxPolicy)throw c=Error("rtcpMuxPolicy 'negotiate' is not supported"),c.name="NotSupportedError",c;switch(c.rtcpMuxPolicy||(c.rtcpMuxPolicy="require"),c.iceTransportPolicy){case "all":case "relay":break;default:c.iceTransportPolicy="all"}switch(c.bundlePolicy){case "balanced":case "max-compat":case "max-bundle":break;default:c.bundlePolicy="balanced"}if(c.iceServers=function(a,b){var c=!1;return(a=JSON.parse(JSON.stringify(a))).filter(function(a){if(a&&(a.urls||a.url)){var f=a.urls||
a.url;a.url&&!a.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var d="string"==typeof f;return d&&(f=[f]),f=f.filter(function(a){return 0!==a.indexOf("turn:")||-1===a.indexOf("transport\x3dudp")||-1!==a.indexOf("turn:[")||c?0===a.indexOf("stun:")&&14393<=b&&-1===a.indexOf("?transport\x3dudp"):(c=!0,!0)}),delete a.url,a.urls=d?f[0]:f,!!f.length}return!1})}(c.iceServers||[],b),this._iceGatherers=[],c.iceCandidatePoolSize)for(var g=c.iceCandidatePoolSize;0<g;g--)this._iceGatherers=
new a.RTCIceGatherer({iceServers:c.iceServers,gatherPolicy:c.iceTransportPolicy});else c.iceCandidatePoolSize=0;this._config=c;this.transceivers=[];this._sdpSessionId=l.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=void 0};return d.prototype._emitGatheringStateChange=function(){var a=new Event("icegatheringstatechange");this.dispatchEvent(a);"function"==typeof this.onicegatheringstatechange&&this.onicegatheringstatechange(a)},d.prototype.getConfiguration=function(){return this._config},
d.prototype.getLocalStreams=function(){return this.localStreams},d.prototype.getRemoteStreams=function(){return this.remoteStreams},d.prototype._createTransceiver=function(a){var b=0<this.transceivers.length;a={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:a,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,wantReceive:!0};this.usingBundle&&b?(a.iceTransport=this.transceivers[0].iceTransport,
a.dtlsTransport=this.transceivers[0].dtlsTransport):(b=this._createIceAndDtlsTransports(),a.iceTransport=b.iceTransport,a.dtlsTransport=b.dtlsTransport);return this.transceivers.push(a),a},d.prototype.addTrack=function(b,c){for(var f,d=0;d<this.transceivers.length;d++)this.transceivers[d].track||this.transceivers[d].kind!==b.kind||(f=this.transceivers[d]);return f||(f=this._createTransceiver(b.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(c)&&this.localStreams.push(c),f.track=
b,f.stream=c,f.rtpSender=new a.RTCRtpSender(b,f.dtlsTransport),f.rtpSender},d.prototype.addStream=function(a){var c=this;if(15025<=b)a.getTracks().forEach(function(b){c.addTrack(b,a)});else{var f=a.clone();a.getTracks().forEach(function(a,b){var c=f.getTracks()[b];a.addEventListener("enabled",function(a){c.enabled=a.enabled})});f.getTracks().forEach(function(a){c.addTrack(a,f)})}},d.prototype.removeStream=function(a){a=this.localStreams.indexOf(a);-1<a&&(this.localStreams.splice(a,1),this._maybeFireNegotiationNeeded())},
d.prototype.getSenders=function(){return this.transceivers.filter(function(a){return!!a.rtpSender}).map(function(a){return a.rtpSender})},d.prototype.getReceivers=function(){return this.transceivers.filter(function(a){return!!a.rtpReceiver}).map(function(a){return a.rtpReceiver})},d.prototype._createIceGatherer=function(b,c){var f=this;if(c&&0<b)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var d=new a.RTCIceGatherer({iceServers:this._config.iceServers,
gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(d,"state",{value:"new",writable:!0}),this.transceivers[b].candidates=[],this.transceivers[b].bufferCandidates=function(a){var c=!a.candidate||0===Object.keys(a.candidate).length;d.state=c?"completed":"gathering";null!==f.transceivers[b].candidates&&f.transceivers[b].candidates.push(a.candidate)},d.addEventListener("localcandidate",this.transceivers[b].bufferCandidates),d},d.prototype._gather=function(b,c){var f=this,d=this.transceivers[c].iceGatherer;
if(!d.onlocalcandidate){var g=this.transceivers[c].candidates;this.transceivers[c].candidates=null;d.removeEventListener("localcandidate",this.transceivers[c].bufferCandidates);d.onlocalcandidate=function(a){if(!(f.usingBundle&&0<c)){var g=new Event("icecandidate");g.candidate={sdpMid:b,sdpMLineIndex:c};var p=a.candidate;(a=!p||0===Object.keys(p).length)?"new"!==d.state&&"gathering"!==d.state||(d.state="completed"):("new"===d.state&&(d.state="gathering"),p.component=1,g.candidate.candidate=l.writeCandidate(p));
p=l.splitSections(f.localDescription.sdp);p[g.candidate.sdpMLineIndex+1]+=a?"a\x3dend-of-candidates\r\n":"a\x3d"+g.candidate.candidate+"\r\n";f.localDescription.sdp=p.join("");p=f.transceivers.every(function(a){return a.iceGatherer&&"completed"===a.iceGatherer.state});"gathering"!==f.iceGatheringState&&(f.iceGatheringState="gathering",f._emitGatheringStateChange());a||(f.dispatchEvent(g),"function"==typeof f.onicecandidate&&f.onicecandidate(g));p&&(f.dispatchEvent(new Event("icecandidate")),"function"==
typeof f.onicecandidate&&f.onicecandidate(new Event("icecandidate")),f.iceGatheringState="complete",f._emitGatheringStateChange())}};a.setTimeout(function(){g.forEach(function(a){var b=new Event("RTCIceGatherEvent");b.candidate=a;d.onlocalcandidate(b)})},0)}},d.prototype._createIceAndDtlsTransports=function(){var b=this,c=new a.RTCIceTransport(null);c.onicestatechange=function(){b._updateConnectionState()};var f=new a.RTCDtlsTransport(c);return f.ondtlsstatechange=function(){b._updateConnectionState()},
f.onerror=function(){Object.defineProperty(f,"state",{value:"failed",writable:!0});b._updateConnectionState()},{iceTransport:c,dtlsTransport:f}},d.prototype._disposeIceAndDtlsTransports=function(a){var b=this.transceivers[a].iceGatherer;b&&(delete b.onlocalcandidate,delete this.transceivers[a].iceGatherer);(b=this.transceivers[a].iceTransport)&&(delete b.onicestatechange,delete this.transceivers[a].iceTransport);(b=this.transceivers[a].dtlsTransport)&&(delete b.ondtlsstatechange,delete b.onerror,
delete this.transceivers[a].dtlsTransport)},d.prototype._transceive=function(a,f,d){var g=c(a.localCapabilities,a.remoteCapabilities);f&&a.rtpSender&&(g.encodings=a.sendEncodingParameters,g.rtcp={cname:l.localCName,compound:a.rtcpParameters.compound},a.recvEncodingParameters.length&&(g.rtcp.ssrc=a.recvEncodingParameters[0].ssrc),a.rtpSender.send(g));d&&a.rtpReceiver&&0<g.codecs.length&&("video"===a.kind&&a.recvEncodingParameters&&15019>b&&a.recvEncodingParameters.forEach(function(a){delete a.rtx}),
g.encodings=a.recvEncodingParameters,g.rtcp={cname:a.rtcpParameters.cname,compound:a.rtcpParameters.compound},a.sendEncodingParameters.length&&(g.rtcp.ssrc=a.sendEncodingParameters[0].ssrc),a.rtpReceiver.receive(g))},d.prototype.setLocalDescription=function(a){var b=this,d=arguments;if(!f("setLocalDescription",a.type,this.signalingState))return new Promise(function(c,f){c=Error("Can not set local "+a.type+" in state "+b.signalingState);c.name="InvalidStateError";2<d.length&&"function"==typeof d[2]&&
d[2].apply(null,[c]);f(c)});if("offer"===a.type){var g=l.splitSections(a.sdp);var h=g.shift();g.forEach(function(a,c){a=l.parseRtpParameters(a);b.transceivers[c].localCapabilities=a});this.transceivers.forEach(function(a,c){b._gather(a.mid,c)})}else if("answer"===a.type){g=l.splitSections(b.remoteDescription.sdp);h=g.shift();var m=0<l.matchPrefix(h,"a\x3dice-lite").length;g.forEach(function(a,f){var d=b.transceivers[f],g=d.iceGatherer,p=d.iceTransport,q=d.dtlsTransport,B=d.localCapabilities,t=d.remoteCapabilities;
if(!(l.isRejected(a)&&1===!l.matchPrefix(a,"a\x3dbundle-only").length||d.isDatachannel)){var C=l.getIceParameters(a,h);a=l.getDtlsParameters(a,h);m&&(a.role="server");b.usingBundle&&0!==f||(b._gather(d.mid,f),"new"===p.state&&p.start(g,C,m?"controlling":"controlled"),"new"===q.state&&q.start(a));f=c(B,t);b._transceive(d,0<f.codecs.length,!1)}})}switch(this.localDescription={type:a.type,sdp:a.sdp},a.type){case "offer":this._updateSignalingState("have-local-offer");break;case "answer":this._updateSignalingState("stable");
break;default:throw new TypeError('unsupported type "'+a.type+'"');}var q=1<arguments.length&&"function"==typeof arguments[1]&&arguments[1];return new Promise(function(a){q&&q.apply(null);a()})},d.prototype.setRemoteDescription=function(c){var d=this,g=arguments;if(!f("setRemoteDescription",c.type,this.signalingState))return new Promise(function(a,b){a=Error("Can not set remote "+c.type+" in state "+d.signalingState);a.name="InvalidStateError";2<g.length&&"function"==typeof g[2]&&g[2].apply(null,
[a]);b(a)});var m={};this.remoteStreams.forEach(function(a){m[a.id]=a});var q=[],v=l.splitSections(c.sdp),k=v.shift(),u=0<l.matchPrefix(k,"a\x3dice-lite").length,n=0<l.matchPrefix(k,"a\x3dgroup:BUNDLE ").length;this.usingBundle=n;var x=l.matchPrefix(k,"a\x3dice-options:")[0];switch(this.canTrickleIceCandidates=!!x&&0<=x.substr(14).split(" ").indexOf("trickle"),v.forEach(function(f,g){var p=l.splitLines(f),B=l.getKind(f),t=l.isRejected(f)&&1===!l.matchPrefix(f,"a\x3dbundle-only").length,C=p[0].substr(2).split(" ")[2];
p=l.getDirection(f,k);var v=l.parseMsid(f),r=l.getMid(f)||l.generateIdentifier();if("application"!==B||"DTLS/SCTP"!==C){var z,A,x,y,F,G,D,H,M=l.parseRtpParameters(f);t||(D=l.getIceParameters(f,k),(H=l.getDtlsParameters(f,k)).role="client");C=l.parseRtpEncodingParameters(f);var w=l.parseRtcpParameters(f),I=0<l.matchPrefix(f,"a\x3dend-of-candidates",k).length;f=l.matchPrefix(f,"a\x3dcandidate:").map(function(a){return l.parseCandidate(a)}).filter(function(a){return 1===a.component});if(("offer"===c.type||
"answer"===c.type)&&!t&&n&&0<g&&d.transceivers[g]&&(d._disposeIceAndDtlsTransports(g),d.transceivers[g].iceGatherer=d.transceivers[0].iceGatherer,d.transceivers[g].iceTransport=d.transceivers[0].iceTransport,d.transceivers[g].dtlsTransport=d.transceivers[0].dtlsTransport,d.transceivers[g].rtpSender&&d.transceivers[g].rtpSender.setTransport(d.transceivers[0].dtlsTransport),d.transceivers[g].rtpReceiver&&d.transceivers[g].rtpReceiver.setTransport(d.transceivers[0].dtlsTransport)),"offer"!==c.type||
t)"answer"!==c.type||t||(z=d.transceivers[g],A=z.iceGatherer,x=z.iceTransport,y=z.dtlsTransport,F=z.rtpReceiver,t=z.sendEncodingParameters,r=z.localCapabilities,d.transceivers[g].recvEncodingParameters=C,d.transceivers[g].remoteCapabilities=M,d.transceivers[g].rtcpParameters=w,f.length&&"new"===x.state&&(!u&&!I||n&&0!==g?f.forEach(function(a){h(z.iceTransport,a)}):x.setRemoteCandidates(f)),n&&0!==g||("new"===x.state&&x.start(A,D,"controlling"),"new"===y.state&&y.start(H)),d._transceive(z,"sendrecv"===
p||"recvonly"===p,"sendrecv"===p||"sendonly"===p),!F||"sendrecv"!==p&&"sendonly"!==p?delete z.rtpReceiver:(G=F.track,v?(m[v.stream]||(m[v.stream]=new a.MediaStream),m[v.stream].addTrack(G),q.push([G,F,m[v.stream]])):(m.default||(m.default=new a.MediaStream),m.default.addTrack(G),q.push([G,F,m.default]))));else{(z=d.transceivers[g]||d._createTransceiver(B)).mid=r;z.iceGatherer||(z.iceGatherer=d._createIceGatherer(g,n));f.length&&"new"===z.iceTransport.state&&(!I||n&&0!==g?f.forEach(function(a){h(z.iceTransport,
a)}):z.iceTransport.setRemoteCandidates(f));r=a.RTCRtpReceiver.getCapabilities(B);15019>b&&(r.codecs=r.codecs.filter(function(a){return"rtx"!==a.name}));t=z.sendEncodingParameters||[{ssrc:1001*(2*g+2)}];var E;A=!1;"sendrecv"!==p&&"sendonly"!==p||(A=!z.rtpReceiver,F=z.rtpReceiver||new a.RTCRtpReceiver(z.dtlsTransport,B),A&&(G=F.track,v?(m[v.stream]||(m[v.stream]=new a.MediaStream,Object.defineProperty(m[v.stream],"id",{get:function(){return v.stream}})),Object.defineProperty(G,"id",{get:function(){return v.track}}),
E=m[v.stream]):(m.default||(m.default=new a.MediaStream),E=m.default),E.addTrack(G),q.push([G,F,E])));z.localCapabilities=r;z.remoteCapabilities=M;z.rtpReceiver=F;z.rtcpParameters=w;z.sendEncodingParameters=t;z.recvEncodingParameters=C;d._transceive(d.transceivers[g],!1,A)}}else d.transceivers[g]={mid:r,isDatachannel:!0}}),void 0===this._dtlsRole&&(this._dtlsRole="offer"===c.type?"active":"passive"),this.remoteDescription={type:c.type,sdp:c.sdp},c.type){case "offer":this._updateSignalingState("have-remote-offer");
break;case "answer":this._updateSignalingState("stable");break;default:throw new TypeError('unsupported type "'+c.type+'"');}return Object.keys(m).forEach(function(b){var c=m[b];if(c.getTracks().length){if(-1===d.remoteStreams.indexOf(c)){d.remoteStreams.push(c);var f=new Event("addstream");f.stream=c;a.setTimeout(function(){d.dispatchEvent(f);"function"==typeof d.onaddstream&&d.onaddstream(f)})}q.forEach(function(b){var f=b[0],g=b[1];if(c.id===b[2].id){var l=new Event("track");l.track=f;l.receiver=
g;l.transceiver={receiver:g};l.streams=[c];a.setTimeout(function(){d.dispatchEvent(l);"function"==typeof d.ontrack&&d.ontrack(l)})}})}}),a.setTimeout(function(){d&&d.transceivers&&d.transceivers.forEach(function(a){a.iceTransport&&"new"===a.iceTransport.state&&0<a.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),a.iceTransport.addRemoteCandidate({}))})},4E3),new Promise(function(a){1<g.length&&"function"==
typeof g[1]&&g[1].apply(null);a()})},d.prototype.close=function(){this.transceivers.forEach(function(a){a.iceTransport&&a.iceTransport.stop();a.dtlsTransport&&a.dtlsTransport.stop();a.rtpSender&&a.rtpSender.stop();a.rtpReceiver&&a.rtpReceiver.stop()});this._updateSignalingState("closed")},d.prototype._updateSignalingState=function(a){this.signalingState=a;a=new Event("signalingstatechange");this.dispatchEvent(a);"function"==typeof this.onsignalingstatechange&&this.onsignalingstatechange(a)},d.prototype._maybeFireNegotiationNeeded=
function(){var b=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,a.setTimeout(function(){if(!1!==b.needNegotiation){b.needNegotiation=!1;var a=new Event("negotiationneeded");b.dispatchEvent(a);"function"==typeof b.onnegotiationneeded&&b.onnegotiationneeded(a)}},0))},d.prototype._updateConnectionState=function(){var a,b={new:0,closed:0,connecting:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach(function(a){b[a.iceTransport.state]++;
b[a.dtlsTransport.state]++}),b.connected+=b.completed,a="new",0<b.failed?a="failed":0<b.connecting||0<b.checking?a="connecting":0<b.disconnected?a="disconnected":0<b.new?a="new":(0<b.connected||0<b.completed)&&(a="connected"),a!==this.iceConnectionState)this.iceConnectionState=a,a=new Event("iceconnectionstatechange"),this.dispatchEvent(a),"function"==typeof this.oniceconnectionstatechange&&this.oniceconnectionstatechange(a)},d.prototype.createOffer=function(){var c,f=this,d=arguments;1===arguments.length&&
"function"!=typeof arguments[0]?c=arguments[0]:3===arguments.length&&(c=arguments[2]);var h=this.transceivers.filter(function(a){return"audio"===a.kind}).length,q=this.transceivers.filter(function(a){return"video"===a.kind}).length;if(c){if(c.mandatory||c.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==c.offerToReceiveAudio&&(h=!0===c.offerToReceiveAudio?1:!1===c.offerToReceiveAudio?0:c.offerToReceiveAudio);void 0!==c.offerToReceiveVideo&&(q=!0===c.offerToReceiveVideo?
1:!1===c.offerToReceiveVideo?0:c.offerToReceiveVideo)}for(this.transceivers.forEach(function(a){"audio"===a.kind?0>--h&&(a.wantReceive=!1):"video"===a.kind&&0>--q&&(a.wantReceive=!1)});0<h||0<q;)0<h&&(this._createTransceiver("audio"),h--),0<q&&(this._createTransceiver("video"),q--);var v=l.writeSessionBoilerplate(this._sdpSessionId,this._sdpSessionVersion++);this.transceivers.forEach(function(c,d){var g=c.track,p=c.kind,h=l.generateIdentifier();c.mid=h;c.iceGatherer||(c.iceGatherer=f._createIceGatherer(d,
f.usingBundle));h=a.RTCRtpSender.getCapabilities(p);15019>b&&(h.codecs=h.codecs.filter(function(a){return"rtx"!==a.name}));h.codecs.forEach(function(a){"H264"===a.name&&void 0===a.parameters["level-asymmetry-allowed"]&&(a.parameters["level-asymmetry-allowed"]="1")});d=c.sendEncodingParameters||[{ssrc:1001*(2*d+1)}];g&&15019<=b&&"video"===p&&!d[0].rtx&&(d[0].rtx={ssrc:d[0].ssrc+1});c.wantReceive&&(c.rtpReceiver=new a.RTCRtpReceiver(c.dtlsTransport,p));c.localCapabilities=h;c.sendEncodingParameters=
d});"max-compat"!==this._config.bundlePolicy&&(v+="a\x3dgroup:BUNDLE "+this.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");v+="a\x3dice-options:trickle\r\n";this.transceivers.forEach(function(a,b){v+=g(a,a.localCapabilities,"offer",a.stream,f._dtlsRole);v+="a\x3drtcp-rsize\r\n";!a.iceGatherer||"new"===f.iceGatheringState||0!==b&&f.usingBundle||(a.iceGatherer.getLocalCandidates().forEach(function(a){a.component=1;v+="a\x3d"+l.writeCandidate(a)+"\r\n"}),"completed"===a.iceGatherer.state&&
(v+="a\x3dend-of-candidates\r\n"))});var k=new a.RTCSessionDescription({type:"offer",sdp:v});return new Promise(function(a){if(0<d.length&&"function"==typeof d[0])return d[0].apply(null,[k]),void a();a(k)})},d.prototype.createAnswer=function(){var f=this,d=arguments,p=l.writeSessionBoilerplate(this._sdpSessionId,this._sdpSessionVersion++);this.usingBundle&&(p+="a\x3dgroup:BUNDLE "+this.transceivers.map(function(a){return a.mid}).join(" ")+"\r\n");var h=l.splitSections(this.remoteDescription.sdp).length-
1;this.transceivers.forEach(function(a,d){if(!(d+1>h))if(a.isDatachannel)p+="m\x3dapplication 0 DTLS/SCTP 5000\r\nc\x3dIN IP4 0.0.0.0\r\na\x3dmid:"+a.mid+"\r\n";else{var l;a.stream&&("audio"===a.kind?l=a.stream.getAudioTracks()[0]:"video"===a.kind&&(l=a.stream.getVideoTracks()[0]),l&&15019<=b&&"video"===a.kind&&!a.sendEncodingParameters[0].rtx&&(a.sendEncodingParameters[0].rtx={ssrc:a.sendEncodingParameters[0].ssrc+1}));d=c(a.localCapabilities,a.remoteCapabilities);!d.codecs.filter(function(a){return"rtx"===
a.name.toLowerCase()}).length&&a.sendEncodingParameters[0].rtx&&delete a.sendEncodingParameters[0].rtx;p+=g(a,d,"answer",a.stream,f._dtlsRole);a.rtcpParameters&&a.rtcpParameters.reducedSize&&(p+="a\x3drtcp-rsize\r\n")}});var q=new a.RTCSessionDescription({type:"answer",sdp:p});return new Promise(function(a){if(0<d.length&&"function"==typeof d[0])return d[0].apply(null,[q]),void a();a(q)})},d.prototype.addIceCandidate=function(a){var b,c;if(a&&""!==a.candidate){if(void 0===a.sdpMLineIndex&&!a.sdpMid)throw new TypeError("sdpMLineIndex or sdpMid required");
if(this.remoteDescription){var f=a.sdpMLineIndex;if(a.sdpMid)for(c=0;c<this.transceivers.length;c++)if(this.transceivers[c].mid===a.sdpMid){f=c;break}if(c=this.transceivers[f]){if(c.isDatachannel)return Promise.resolve();var d=0<Object.keys(a.candidate).length?l.parseCandidate(a.candidate):{};if("tcp"===d.protocol&&(0===d.port||9===d.port)||d.component&&1!==d.component)return Promise.resolve();if((0===f||0<f&&c.iceTransport!==this.transceivers[0].iceTransport)&&(h(c.iceTransport,d)||((b=Error("Can not add ICE candidate")).name=
"OperationError")),!b){var g=a.candidate.trim();0===g.indexOf("a\x3d")&&(g=g.substr(2));(c=l.splitSections(this.remoteDescription.sdp))[f+1]+="a\x3d"+(d.type?g:"end-of-candidates")+"\r\n";this.remoteDescription.sdp=c.join("")}}else(b=Error("Can not add ICE candidate")).name="OperationError"}else(b=Error("Can not add ICE candidate without a remote description")).name="InvalidStateError"}else for(f=0;f<this.transceivers.length&&(this.transceivers[f].isDatachannel||(this.transceivers[f].iceTransport.addRemoteCandidate({}),
(c=l.splitSections(this.remoteDescription.sdp))[f+1]+="a\x3dend-of-candidates\r\n",this.remoteDescription.sdp=c.join(""),!this.usingBundle));f++);var q=arguments;return new Promise(function(a,c){b?(2<q.length&&"function"==typeof q[2]&&q[2].apply(null,[b]),c(b)):(1<q.length&&"function"==typeof q[1]&&q[1].apply(null),a())})},d.prototype.getStats=function(){var a=[];this.transceivers.forEach(function(b){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(c){b[c]&&
a.push(b[c].getStats())})});var b=1<arguments.length&&"function"==typeof arguments[1]&&arguments[1];return new Promise(function(c){var f=new Map;Promise.all(a).then(function(a){a.forEach(function(a){Object.keys(a).forEach(function(b){var c=a[b];a[b].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[c.type]||c.type;f.set(b,a[b])})});b&&b.apply(null,f);c(f)})})},d}},{sdp:2}],2:[function(b,a,d){var g=
{generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};g.localCName=g.generateIdentifier();g.splitLines=function(a){return a.trim().split("\n").map(function(a){return a.trim()})};g.splitSections=function(a){return a.split("\nm\x3d").map(function(a,b){return(0<b?"m\x3d"+a:a).trim()+"\r\n"})};g.matchPrefix=function(a,b){return g.splitLines(a).filter(function(a){return 0===a.indexOf(b)})};g.parseCandidate=function(a){var b;a={foundation:(b=0===a.indexOf("a\x3dcandidate:")?a.substring(12).split(" "):
a.substring(10).split(" "))[0],component:parseInt(b[1],10),protocol:b[2].toLowerCase(),priority:parseInt(b[3],10),ip:b[4],port:parseInt(b[5],10),type:b[7]};for(var c=8;c<b.length;c+=2)switch(b[c]){case "raddr":a.relatedAddress=b[c+1];break;case "rport":a.relatedPort=parseInt(b[c+1],10);break;case "tcptype":a.tcpType=b[c+1];break;case "ufrag":a.ufrag=b[c+1];a.usernameFragment=b[c+1];break;default:a[b[c]]=b[c+1]}return a};g.writeCandidate=function(a){var b=[];b.push(a.foundation);b.push(a.component);
b.push(a.protocol.toUpperCase());b.push(a.priority);b.push(a.ip);b.push(a.port);var c=a.type;return b.push("typ"),b.push(c),"host"!==c&&a.relatedAddress&&a.relatedPort&&(b.push("raddr"),b.push(a.relatedAddress),b.push("rport"),b.push(a.relatedPort)),a.tcpType&&"tcp"===a.protocol.toLowerCase()&&(b.push("tcptype"),b.push(a.tcpType)),a.ufrag&&(b.push("ufrag"),b.push(a.ufrag)),"candidate:"+b.join(" ")};g.parseIceOptions=function(a){return a.substr(14).split(" ")};g.parseRtpMap=function(a){a=a.substr(9).split(" ");
var b={payloadType:parseInt(a.shift(),10)};return a=a[0].split("/"),b.name=a[0],b.clockRate=parseInt(a[1],10),b.numChannels=3===a.length?parseInt(a[2],10):1,b};g.writeRtpMap=function(a){var b=a.payloadType;return void 0!==a.preferredPayloadType&&(b=a.preferredPayloadType),"a\x3drtpmap:"+b+" "+a.name+"/"+a.clockRate+(1!==a.numChannels?"/"+a.numChannels:"")+"\r\n"};g.parseExtmap=function(a){a=a.substr(9).split(" ");return{id:parseInt(a[0],10),direction:0<a[0].indexOf("/")?a[0].split("/")[1]:"sendrecv",
uri:a[1]}};g.writeExtmap=function(a){return"a\x3dextmap:"+(a.id||a.preferredId)+(a.direction&&"sendrecv"!==a.direction?"/"+a.direction:"")+" "+a.uri+"\r\n"};g.parseFmtp=function(a){for(var b={},c=a.substr(a.indexOf(" ")+1).split(";"),d=0;d<c.length;d++)a=c[d].trim().split("\x3d"),b[a[0].trim()]=a[1];return b};g.writeFmtp=function(a){var b="",c=a.payloadType;if(void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType),a.parameters&&Object.keys(a.parameters).length){var d=[];Object.keys(a.parameters).forEach(function(b){d.push(b+
"\x3d"+a.parameters[b])});b+="a\x3dfmtp:"+c+" "+d.join(";")+"\r\n"}return b};g.parseRtcpFb=function(a){a=a.substr(a.indexOf(" ")+1).split(" ");return{type:a.shift(),parameter:a.join(" ")}};g.writeRtcpFb=function(a){var b="",c=a.payloadType;return void 0!==a.preferredPayloadType&&(c=a.preferredPayloadType),a.rtcpFeedback&&a.rtcpFeedback.length&&a.rtcpFeedback.forEach(function(a){b+="a\x3drtcp-fb:"+c+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+"\r\n"}),b};g.parseSsrcMedia=function(a){var b=
a.indexOf(" "),c={ssrc:parseInt(a.substr(7,b-7),10)},d=a.indexOf(":",b);return-1<d?(c.attribute=a.substr(b+1,d-b-1),c.value=a.substr(d+1)):c.attribute=a.substr(b+1),c};g.getMid=function(a){if(a=g.matchPrefix(a,"a\x3dmid:")[0])return a.substr(6)};g.parseFingerprint=function(a){a=a.substr(14).split(" ");return{algorithm:a[0].toLowerCase(),value:a[1]}};g.getDtlsParameters=function(a,b){return{role:"auto",fingerprints:g.matchPrefix(a+b,"a\x3dfingerprint:").map(g.parseFingerprint)}};g.writeDtlsParameters=
function(a,b){var c="a\x3dsetup:"+b+"\r\n";return a.fingerprints.forEach(function(a){c+="a\x3dfingerprint:"+a.algorithm+" "+a.value+"\r\n"}),c};g.getIceParameters=function(a,b){a=g.splitLines(a);return{usernameFragment:(a=a.concat(g.splitLines(b))).filter(function(a){return 0===a.indexOf("a\x3dice-ufrag:")})[0].substr(12),password:a.filter(function(a){return 0===a.indexOf("a\x3dice-pwd:")})[0].substr(10)}};g.writeIceParameters=function(a){return"a\x3dice-ufrag:"+a.usernameFragment+"\r\na\x3dice-pwd:"+
a.password+"\r\n"};g.parseRtpParameters=function(a){for(var b={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},c=g.splitLines(a)[0].split(" "),d=3;d<c.length;d++){var h=c[d],k=g.matchPrefix(a,"a\x3drtpmap:"+h+" ")[0];if(k){k=g.parseRtpMap(k);var n=g.matchPrefix(a,"a\x3dfmtp:"+h+" ");switch(k.parameters=n.length?g.parseFmtp(n[0]):{},k.rtcpFeedback=g.matchPrefix(a,"a\x3drtcp-fb:"+h+" ").map(g.parseRtcpFb),b.codecs.push(k),k.name.toUpperCase()){case "RED":case "ULPFEC":b.fecMechanisms.push(k.name.toUpperCase())}}}return g.matchPrefix(a,
"a\x3dextmap:").forEach(function(a){b.headerExtensions.push(g.parseExtmap(a))}),b};g.writeRtpDescription=function(a,b){var c="";c+="m\x3d"+a+" ";c+=0<b.codecs.length?"9":"0";c+=" UDP/TLS/RTP/SAVPF ";c+=b.codecs.map(function(a){return void 0!==a.preferredPayloadType?a.preferredPayloadType:a.payloadType}).join(" ")+"\r\n";c+="c\x3dIN IP4 0.0.0.0\r\n";c+="a\x3drtcp:9 IN IP4 0.0.0.0\r\n";b.codecs.forEach(function(a){c+=g.writeRtpMap(a);c+=g.writeFmtp(a);c+=g.writeRtcpFb(a)});var d=0;return b.codecs.forEach(function(a){a.maxptime>
d&&(d=a.maxptime)}),0<d&&(c+="a\x3dmaxptime:"+d+"\r\n"),c+="a\x3drtcp-mux\r\n",b.headerExtensions.forEach(function(a){c+=g.writeExtmap(a)}),c};g.parseRtpEncodingParameters=function(a){var b,c=[],d=g.parseRtpParameters(a),h=-1!==d.fecMechanisms.indexOf("RED"),k=-1!==d.fecMechanisms.indexOf("ULPFEC"),n=g.matchPrefix(a,"a\x3dssrc:").map(function(a){return g.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute}),m=0<n.length&&n[0].ssrc;n=g.matchPrefix(a,"a\x3dssrc-group:FID").map(function(a){a=
a.split(" ");return a.shift(),a.map(function(a){return parseInt(a,10)})});0<n.length&&1<n[0].length&&n[0][0]===m&&(b=n[0][1]);d.codecs.forEach(function(a){"RTX"===a.name.toUpperCase()&&a.parameters.apt&&(a={ssrc:m,codecPayloadType:parseInt(a.parameters.apt,10),rtx:{ssrc:b}},c.push(a),h&&((a=JSON.parse(JSON.stringify(a))).fec={ssrc:b,mechanism:k?"red+ulpfec":"red"},c.push(a)))});0===c.length&&m&&c.push({ssrc:m});var r=g.matchPrefix(a,"b\x3d");return r.length&&(r=0===r[0].indexOf("b\x3dTIAS:")?parseInt(r[0].substr(7),
10):0===r[0].indexOf("b\x3dAS:")?950*parseInt(r[0].substr(5),10)-16E3:void 0,c.forEach(function(a){a.maxBitrate=r})),c};g.parseRtcpParameters=function(a){var b={},c=g.matchPrefix(a,"a\x3dssrc:").map(function(a){return g.parseSsrcMedia(a)}).filter(function(a){return"cname"===a.attribute})[0];c&&(b.cname=c.value,b.ssrc=c.ssrc);c=g.matchPrefix(a,"a\x3drtcp-rsize");b.reducedSize=0<c.length;b.compound=0===c.length;a=g.matchPrefix(a,"a\x3drtcp-mux");return b.mux=0<a.length,b};g.parseMsid=function(a){var b,
c=g.matchPrefix(a,"a\x3dmsid:");if(1===c.length)return{stream:(b=c[0].substr(7).split(" "))[0],track:b[1]};a=g.matchPrefix(a,"a\x3dssrc:").map(function(a){return g.parseSsrcMedia(a)}).filter(function(a){return"msid"===a.attribute});return 0<a.length?{stream:(b=a[0].value.split(" "))[0],track:b[1]}:void 0};g.generateSessionId=function(){return Math.random().toString().substr(2,21)};g.writeSessionBoilerplate=function(a,b){b=void 0!==b?b:2;return"v\x3d0\r\no\x3dthisisadapterortc "+(a||g.generateSessionId())+
" "+b+" IN IP4 127.0.0.1\r\ns\x3d-\r\nt\x3d0 0\r\n"};g.writeMediaSection=function(a,b,d,l){b=g.writeRtpDescription(a.kind,b);if(b+=g.writeIceParameters(a.iceGatherer.getLocalParameters()),b+=g.writeDtlsParameters(a.dtlsTransport.getLocalParameters(),"offer"===d?"actpass":"active"),b+="a\x3dmid:"+a.mid+"\r\n",a.direction?b+="a\x3d"+a.direction+"\r\n":a.rtpSender&&a.rtpReceiver?b+="a\x3dsendrecv\r\n":a.rtpSender?b+="a\x3dsendonly\r\n":a.rtpReceiver?b+="a\x3drecvonly\r\n":b+="a\x3dinactive\r\n",a.rtpSender)d=
"msid:"+l.id+" "+a.rtpSender.track.id+"\r\n",b=b+("a\x3d"+d)+("a\x3dssrc:"+a.sendEncodingParameters[0].ssrc+" "+d),a.sendEncodingParameters[0].rtx&&(b+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+" "+d,b+="a\x3dssrc-group:FID "+a.sendEncodingParameters[0].ssrc+" "+a.sendEncodingParameters[0].rtx.ssrc+"\r\n");return b+="a\x3dssrc:"+a.sendEncodingParameters[0].ssrc+" cname:"+g.localCName+"\r\n",a.rtpSender&&a.sendEncodingParameters[0].rtx&&(b+="a\x3dssrc:"+a.sendEncodingParameters[0].rtx.ssrc+
" cname:"+g.localCName+"\r\n"),b};g.getDirection=function(a,b){a=g.splitLines(a);for(var c=0;c<a.length;c++)switch(a[c]){case "a\x3dsendrecv":case "a\x3dsendonly":case "a\x3drecvonly":case "a\x3dinactive":return a[c].substr(2)}return b?g.getDirection(b):"sendrecv"};g.getKind=function(a){return g.splitLines(a)[0].split(" ")[0].substr(2)};g.isRejected=function(a){return"0"===a.split(" ",2)[1]};g.parseMLine=function(a){a=g.splitLines(a)[0].split(" ");return{kind:a[0].substr(2),port:parseInt(a[1],10),
protocol:a[2],fmt:a.slice(3).join(" ")}};"object"==typeof a&&(a.exports=g)},{}],3:[function(b,a,h){h=void 0!==d?d:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};b=b("./adapter_factory.js");a.exports=b({window:h.window})},{"./adapter_factory.js":4}],4:[function(b,a,d){var g=b("./utils");a.exports=function(a,d){a=a&&a.window;var c={shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0};for(f in d)hasOwnProperty.call(d,f)&&(c[f]=d[f]);d=g.log;var f=g.detectBrowser(a);var h={browserDetails:f,
extractVersion:g.extractVersion,disableLog:g.disableLog,disableWarnings:g.disableWarnings},k=b("./chrome/chrome_shim")||null,n=b("./edge/edge_shim")||null,m=b("./firefox/firefox_shim")||null,r=b("./safari/safari_shim")||null,p=b("./common_shim")||null;switch(f.browser){case "chrome":if(!k||!k.shimPeerConnection||!c.shimChrome)return d("Chrome shim is not included in this adapter release."),h;d("adapter.js shimming chrome.");h.browserShim=k;p.shimCreateObjectURL(a);k.shimGetUserMedia(a);k.shimMediaStream(a);
k.shimSourceObject(a);k.shimPeerConnection(a);k.shimOnTrack(a);k.shimAddTrackRemoveTrack(a);k.shimGetSendersWithDtmf(a);p.shimRTCIceCandidate(a);break;case "firefox":if(!m||!m.shimPeerConnection||!c.shimFirefox)return d("Firefox shim is not included in this adapter release."),h;d("adapter.js shimming firefox.");h.browserShim=m;p.shimCreateObjectURL(a);m.shimGetUserMedia(a);m.shimSourceObject(a);m.shimPeerConnection(a);m.shimOnTrack(a);p.shimRTCIceCandidate(a);break;case "edge":if(!n||!n.shimPeerConnection||
!c.shimEdge)return d("MS edge shim is not included in this adapter release."),h;d("adapter.js shimming edge.");h.browserShim=n;p.shimCreateObjectURL(a);n.shimGetUserMedia(a);n.shimPeerConnection(a);n.shimReplaceTrack(a);break;case "safari":if(!r||!c.shimSafari)return d("Safari shim is not included in this adapter release."),h;d("adapter.js shimming safari.");h.browserShim=r;p.shimCreateObjectURL(a);r.shimRTCIceServerUrls(a);r.shimCallbacksAPI(a);r.shimLocalStreamsAPI(a);r.shimRemoteStreamsAPI(a);
r.shimTrackEventTransceiver(a);r.shimGetUserMedia(a);r.shimCreateOfferLegacy(a);p.shimRTCIceCandidate(a);break;default:d("Unsupported browser!")}return h}},{"./chrome/chrome_shim":5,"./common_shim":7,"./edge/edge_shim":8,"./firefox/firefox_shim":10,"./safari/safari_shim":12,"./utils":13}],5:[function(b,a,d){var g=b("../utils.js"),c=g.log;a.exports={shimMediaStream:function(a){a.MediaStream=a.MediaStream||a.webkitMediaStream},shimOnTrack:function(a){if("object"==typeof a&&a.RTCPeerConnection&&!("ontrack"in
a.RTCPeerConnection.prototype)){Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&this.removeEventListener("track",this._ontrack);this.addEventListener("track",this._ontrack=a)}});var b=a.RTCPeerConnection.prototype.setRemoteDescription;a.RTCPeerConnection.prototype.setRemoteDescription=function(){var c=this;return c._ontrackpoly||(c._ontrackpoly=function(b){b.stream.addEventListener("addtrack",function(d){var f=a.RTCPeerConnection.prototype.getReceivers?
c.getReceivers().find(function(a){return a.track&&a.track.id===d.track.id}):{track:d.track};var g=new Event("track");g.track=d.track;g.receiver=f;g.transceiver={receiver:f};g.streams=[b.stream];c.dispatchEvent(g)});b.stream.getTracks().forEach(function(d){var f=a.RTCPeerConnection.prototype.getReceivers?c.getReceivers().find(function(a){return a.track&&a.track.id===d.id}):{track:d};var g=new Event("track");g.track=d;g.receiver=f;g.transceiver={receiver:f};g.streams=[b.stream];c.dispatchEvent(g)})},
c.addEventListener("addstream",c._ontrackpoly)),b.apply(c,arguments)}}},shimAddTrackRemoveTrack:function(a){function b(a,b){var c=b.sdp;return Object.keys(a._reverseStreams||[]).forEach(function(b){b=a._reverseStreams[b];c=c.replace(new RegExp(a._streams[b.id].id,"g"),b.id)}),new RTCSessionDescription({type:b.type,sdp:c})}var c=g.detectBrowser(a);if(!(a.RTCPeerConnection.prototype.addTrack&&63<=c.version)){var d=a.RTCPeerConnection.prototype.getLocalStreams;a.RTCPeerConnection.prototype.getLocalStreams=
function(){var a=this,b=d.apply(this);return a._reverseStreams=a._reverseStreams||{},b.map(function(b){return a._reverseStreams[b.id]})};var f=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(b){var c=this;if(c._streams=c._streams||{},c._reverseStreams=c._reverseStreams||{},b.getTracks().forEach(function(a){if(c.getSenders().find(function(b){return b.track===a}))throw new DOMException("Track already exists.","InvalidAccessError");}),!c._reverseStreams[b.id]){var d=
new a.MediaStream(b.getTracks());c._streams[b.id]=d;c._reverseStreams[d.id]=b;b=d}f.apply(c,[b])};var h=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){this._streams=this._streams||{};this._reverseStreams=this._reverseStreams||{};h.apply(this,[this._streams[a.id]||a]);delete this._reverseStreams[this._streams[a.id]?this._streams[a.id].id:a.id];delete this._streams[a.id]};a.RTCPeerConnection.prototype.addTrack=function(b,c){var d=this;if("closed"===
d.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var f=[].slice.call(arguments,1);if(1!==f.length||!f[0].getTracks().find(function(a){return a===b}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(d.getSenders().find(function(a){return a.track===b}))throw new DOMException("Track already exists.","InvalidAccessError");d._streams=
d._streams||{};d._reverseStreams=d._reverseStreams||{};(f=d._streams[c.id])?(f.addTrack(b),Promise.resolve().then(function(){d.dispatchEvent(new Event("negotiationneeded"))})):(f=new a.MediaStream([b]),d._streams[c.id]=f,d._reverseStreams[f.id]=c,d.addStream(f));return d.getSenders().find(function(a){return a.track===b})};["createOffer","createAnswer"].forEach(function(c){var d=a.RTCPeerConnection.prototype[c];a.RTCPeerConnection.prototype[c]=function(){var a=this,c=arguments;return arguments.length&&
"function"==typeof arguments[0]?d.apply(a,[function(d){d=b(a,d);c[0].apply(null,[d])},function(a){c[1]&&c[1].apply(null,a)},arguments[2]]):d.apply(a,arguments).then(function(c){return b(a,c)})}});var k=a.RTCPeerConnection.prototype.setLocalDescription;a.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(a,b){var c=b.sdp;return Object.keys(a._reverseStreams||[]).forEach(function(b){b=a._reverseStreams[b];c=c.replace(new RegExp(b.id,
"g"),a._streams[b.id].id)}),new RTCSessionDescription({type:b.type,sdp:c})}(this,arguments[0]),k.apply(this,arguments)):k.apply(this,arguments)};var r=Object.getOwnPropertyDescriptor(a.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(a.RTCPeerConnection.prototype,"localDescription",{get:function(){var a=r.get.apply(this);return""===a.type?a:b(this,a)}});a.RTCPeerConnection.prototype.removeTrack=function(a){var b=this;if("closed"===b.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.",
"InvalidStateError");if(!a._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");var c;if(a._pc!==b)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");b._streams=b._streams||{};Object.keys(b._streams).forEach(function(d){b._streams[d].getTracks().find(function(b){return a.track===b})&&(c=b._streams[d])});c&&(1===c.getTracks().length?b.removeStream(b._reverseStreams[c.id]):c.removeTrack(a.track),
b.dispatchEvent(new Event("negotiationneeded")))}}},shimGetSendersWithDtmf:function(a){if("object"==typeof a&&a.RTCPeerConnection&&!("getSenders"in a.RTCPeerConnection.prototype)&&"createDTMFSender"in a.RTCPeerConnection.prototype){var b=function(a,b){return{track:b,get dtmf(){return void 0===this._dtmf&&("audio"===b.kind?this._dtmf=a.createDTMFSender(b):this._dtmf=null),this._dtmf},_pc:a}};if(!a.RTCPeerConnection.prototype.getSenders){a.RTCPeerConnection.prototype.getSenders=function(){return this._senders=
this._senders||[],this._senders.slice()};var c=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addTrack=function(a,d){var f=c.apply(this,arguments);return f||(f=b(this,a),this._senders.push(f)),f};var d=a.RTCPeerConnection.prototype.removeTrack;a.RTCPeerConnection.prototype.removeTrack=function(a){d.apply(this,arguments);var b=this._senders.indexOf(a);-1!==b&&this._senders.splice(b,1)}}var f=a.RTCPeerConnection.prototype.addStream;a.RTCPeerConnection.prototype.addStream=function(a){var c=
this;c._senders=c._senders||[];f.apply(c,[a]);a.getTracks().forEach(function(a){c._senders.push(b(c,a))})};var g=a.RTCPeerConnection.prototype.removeStream;a.RTCPeerConnection.prototype.removeStream=function(a){var b=this;b._senders=b._senders||[];g.apply(b,[a]);a.getTracks().forEach(function(a){var c=b._senders.find(function(b){return b.track===a});c&&b._senders.splice(b._senders.indexOf(c),1)})}}else if("object"==typeof a&&a.RTCPeerConnection&&"getSenders"in a.RTCPeerConnection.prototype&&"createDTMFSender"in
a.RTCPeerConnection.prototype&&a.RTCRtpSender&&!("dtmf"in a.RTCRtpSender.prototype)){var h=a.RTCPeerConnection.prototype.getSenders;a.RTCPeerConnection.prototype.getSenders=function(){var a=this,b=h.apply(a,[]);return b.forEach(function(b){b._pc=a}),b};Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},shimSourceObject:function(a){var b=a&&a.URL;
"object"==typeof a&&(!a.HTMLMediaElement||"srcObject"in a.HTMLMediaElement.prototype||Object.defineProperty(a.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(a){var c=this;this._srcObject=a;this.src&&b.revokeObjectURL(this.src);a?(this.src=b.createObjectURL(a),a.addEventListener("addtrack",function(){c.src&&b.revokeObjectURL(c.src);c.src=b.createObjectURL(a)}),a.addEventListener("removetrack",function(){c.src&&b.revokeObjectURL(c.src);c.src=b.createObjectURL(a)})):
this.src=""}}))},shimPeerConnection:function(a){var b=g.detectBrowser(a);if(a.RTCPeerConnection){var d=a.RTCPeerConnection;a.RTCPeerConnection=function(a,b){if(a&&a.iceServers){for(var c=[],f=0;f<a.iceServers.length;f++){var h=a.iceServers[f];!h.hasOwnProperty("urls")&&h.hasOwnProperty("url")?(g.deprecated("RTCIceServer.url","RTCIceServer.urls"),(h=JSON.parse(JSON.stringify(h))).urls=h.url,c.push(h)):c.push(a.iceServers[f])}a.iceServers=c}return new d(a,b)};a.RTCPeerConnection.prototype=d.prototype;
Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return d.generateCertificate}})}else a.RTCPeerConnection=function(b,d){return c("PeerConnection"),b&&b.iceTransportPolicy&&(b.iceTransports=b.iceTransportPolicy),new a.webkitRTCPeerConnection(b,d)},a.RTCPeerConnection.prototype=a.webkitRTCPeerConnection.prototype,a.webkitRTCPeerConnection.generateCertificate&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return a.webkitRTCPeerConnection.generateCertificate}});
var f=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(a,b,c){var d=this,g=arguments;if(0<arguments.length&&"function"==typeof a)return f.apply(this,arguments);if(0===f.length&&(0===arguments.length||"function"!=typeof arguments[0]))return f.apply(this,[]);var h=function(a){var b={};return a.result().forEach(function(a){var c={id:a.id,timestamp:a.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[a.type]||a.type};a.names().forEach(function(b){c[b]=
a.stat(b)});b[c.id]=c}),b},l=function(a){return new Map(Object.keys(a).map(function(b){return[b,a[b]]}))};return 2<=arguments.length?f.apply(this,[function(a){g[1](l(h(a)))},arguments[0]]):(new Promise(function(a,b){f.apply(d,[function(b){a(l(h(b)))},b])})).then(b,c)};51>b.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=function(){var a=arguments,b=this,d=new Promise(function(d,f){c.apply(b,
[a[0],d,f])});return 2>a.length?d:d.then(function(){a[1].apply(null,[])},function(b){3<=a.length&&a[2].apply(null,[b])})}});52>b.version&&["createOffer","createAnswer"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=function(){var a=this;if(1>arguments.length||1===arguments.length&&"object"==typeof arguments[0]){var b=1===arguments.length?arguments[0]:void 0;return new Promise(function(d,f){c.apply(a,[d,f,b])})}return c.apply(this,arguments)}});["setLocalDescription",
"setRemoteDescription","addIceCandidate"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=function(){return arguments[0]=new ("addIceCandidate"===b?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)}});var h=a.RTCPeerConnection.prototype.addIceCandidate;a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?h.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}},shimGetUserMedia:b("./getusermedia")}},
{"../utils.js":13,"./getusermedia":6}],6:[function(b,a,d){var g=b("../utils.js"),c=g.log;a.exports=function(a){var b=g.detectBrowser(a),d=a&&a.navigator,f=function(a){if("object"!=typeof a||a.mandatory||a.optional)return a;var b={};return Object.keys(a).forEach(function(c){if("require"!==c&&"advanced"!==c&&"mediaSource"!==c){var d="object"==typeof a[c]?a[c]:{ideal:a[c]};void 0!==d.exact&&"number"==typeof d.exact&&(d.min=d.max=d.exact);var f=function(a,b){return a?a+b.charAt(0).toUpperCase()+b.slice(1):
"deviceId"===b?"sourceId":b};if(void 0!==d.ideal){b.optional=b.optional||[];var g={};"number"==typeof d.ideal?(g[f("min",c)]=d.ideal,b.optional.push(g),(g={})[f("max",c)]=d.ideal,b.optional.push(g)):(g[f("",c)]=d.ideal,b.optional.push(g))}void 0!==d.exact&&"number"!=typeof d.exact?(b.mandatory=b.mandatory||{},b.mandatory[f("",c)]=d.exact):["min","max"].forEach(function(a){void 0!==d[a]&&(b.mandatory=b.mandatory||{},b.mandatory[f(a,c)]=d[a])})}}),a.advanced&&(b.optional=(b.optional||[]).concat(a.advanced)),
b},h=function(a,g){if((a=JSON.parse(JSON.stringify(a)))&&"object"==typeof a.audio){var h=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])};a=JSON.parse(JSON.stringify(a));h(a.audio,"autoGainControl","googAutoGainControl");h(a.audio,"noiseSuppression","googNoiseSuppression");a.audio=f(a.audio)}if(a&&"object"==typeof a.video){var l=a.video.facingMode;l=l&&("object"==typeof l?l:{ideal:l});var k;h=66>b.version;if(!(!l||"user"!==l.exact&&"environment"!==l.exact&&"user"!==l.ideal&&"environment"!==
l.ideal||d.mediaDevices.getSupportedConstraints&&d.mediaDevices.getSupportedConstraints().facingMode&&!h)&&(delete a.video.facingMode,"environment"===l.exact||"environment"===l.ideal?k=["back","rear"]:"user"!==l.exact&&"user"!==l.ideal||(k=["front"]),k))return d.mediaDevices.enumerateDevices().then(function(b){var d=(b=b.filter(function(a){return"videoinput"===a.kind})).find(function(a){return k.some(function(b){return-1!==a.label.toLowerCase().indexOf(b)})});return!d&&b.length&&-1!==k.indexOf("back")&&
(d=b[b.length-1]),d&&(a.video.deviceId=l.exact?{exact:d.deviceId}:{ideal:d.deviceId}),a.video=f(a.video),c("chrome: "+JSON.stringify(a)),g(a)});a.video=f(a.video)}return c("chrome: "+JSON.stringify(a)),g(a)},k=function(a){return{name:{PermissionDeniedError:"NotAllowedError",InvalidStateError:"NotReadableError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotReadableError",MediaDeviceKillSwitchOn:"NotReadableError"}[a.name]||
a.name,message:a.message,constraint:a.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};d.getUserMedia=function(a,b,c){h(a,function(a){d.webkitGetUserMedia(a,b,function(a){c&&c(k(a))})})};var m=function(a){return new Promise(function(b,c){d.getUserMedia(a,b,c)})};if(d.mediaDevices||(d.mediaDevices={getUserMedia:m,enumerateDevices:function(){return new Promise(function(b){var c={audio:"audioinput",video:"videoinput"};return a.MediaStreamTrack.getSources(function(a){b(a.map(function(a){return{label:a.label,
kind:c[a.kind],deviceId:a.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:!0,echoCancellation:!0,facingMode:!0,frameRate:!0,height:!0,width:!0}}}),d.mediaDevices.getUserMedia){var n=d.mediaDevices.getUserMedia.bind(d.mediaDevices);d.mediaDevices.getUserMedia=function(a){return h(a,function(a){return n(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),new DOMException("","NotFoundError");
return b},function(a){return Promise.reject(k(a))})})}}else d.mediaDevices.getUserMedia=function(a){return m(a)};void 0===d.mediaDevices.addEventListener&&(d.mediaDevices.addEventListener=function(){c("Dummy mediaDevices.addEventListener called.")});void 0===d.mediaDevices.removeEventListener&&(d.mediaDevices.removeEventListener=function(){c("Dummy mediaDevices.removeEventListener called.")})}},{"../utils.js":13}],7:[function(b,a,d){var g=b("sdp"),c=b("./utils");a.exports={shimRTCIceCandidate:function(a){if(!(a.RTCIceCandidate&&
"foundation"in a.RTCIceCandidate.prototype)){var b=a.RTCIceCandidate;a.RTCIceCandidate=function(a){"object"==typeof a&&a.candidate&&0===a.candidate.indexOf("a\x3d")&&((a=JSON.parse(JSON.stringify(a))).candidate=a.candidate.substr(2));var c=new b(a);a=g.parseCandidate(a.candidate);var d=Object.assign(c,a);return d.toJSON=function(){return{candidate:d.candidate,sdpMid:d.sdpMid,sdpMLineIndex:d.sdpMLineIndex,usernameFragment:d.usernameFragment}},d};(function(a,b,c){if(a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;
var d=a.addEventListener;a.addEventListener=function(a,f){if(a!==b)return d.apply(this,arguments);var g=function(a){f(c(a))};return this._eventMap=this._eventMap||{},this._eventMap[f]=g,d.apply(this,[a,g])};var f=a.removeEventListener;a.removeEventListener=function(a,c){if(a!==b||!this._eventMap||!this._eventMap[c])return f.apply(this,arguments);var d=this._eventMap[c];return delete this._eventMap[c],f.apply(this,[a,d])};Object.defineProperty(a,"on"+b,{get:function(){return this["_on"+b]},set:function(a){this["_on"+
b]&&(this.removeEventListener(b,this["_on"+b]),delete this["_on"+b]);a&&this.addEventListener(b,this["_on"+b]=a)}})}})(a,"icecandidate",function(b){return b.candidate&&Object.defineProperty(b,"candidate",{value:new a.RTCIceCandidate(b.candidate),writable:"false"}),b})}},shimCreateObjectURL:function(a){var b=a&&a.URL;if("object"==typeof a&&a.HTMLMediaElement&&"srcObject"in a.HTMLMediaElement.prototype&&b.createObjectURL&&b.revokeObjectURL){var d=b.createObjectURL.bind(b),f=b.revokeObjectURL.bind(b),
g=new Map,h=0;b.createObjectURL=function(a){if("getTracks"in a){var b="polyblob:"+ ++h;return g.set(b,a),c.deprecated("URL.createObjectURL(stream)","elem.srcObject \x3d stream"),b}return d(a)};b.revokeObjectURL=function(a){f(a);g.delete(a)};var k=Object.getOwnPropertyDescriptor(a.HTMLMediaElement.prototype,"src");Object.defineProperty(a.HTMLMediaElement.prototype,"src",{get:function(){return k.get.apply(this)},set:function(a){return this.srcObject=g.get(a)||null,k.set.apply(this,[a])}});var n=a.HTMLMediaElement.prototype.setAttribute;
a.HTMLMediaElement.prototype.setAttribute=function(){return 2===arguments.length&&"src"===(""+arguments[0]).toLowerCase()&&(this.srcObject=g.get(arguments[1])||null),n.apply(this,arguments)}}}}},{"./utils":13,sdp:2}],8:[function(b,a,d){var g=b("../utils"),c=b("rtcpeerconnection-shim");a.exports={shimGetUserMedia:b("./getusermedia"),shimPeerConnection:function(a){var b=g.detectBrowser(a);if(a.RTCIceGatherer&&(a.RTCIceCandidate||(a.RTCIceCandidate=function(a){return a}),a.RTCSessionDescription||(a.RTCSessionDescription=
function(a){return a}),15025>b.version)){var d=Object.getOwnPropertyDescriptor(a.MediaStreamTrack.prototype,"enabled");Object.defineProperty(a.MediaStreamTrack.prototype,"enabled",{set:function(a){d.set.call(this,a);var b=new Event("enabled");b.enabled=a;this.dispatchEvent(b)}})}!a.RTCRtpSender||"dtmf"in a.RTCRtpSender.prototype||Object.defineProperty(a.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new a.RTCDtmfSender(this):"video"===
this.track.kind&&(this._dtmf=null)),this._dtmf}});a.RTCPeerConnection=c(a,b.version)},shimReplaceTrack:function(a){!a.RTCRtpSender||"replaceTrack"in a.RTCRtpSender.prototype||(a.RTCRtpSender.prototype.replaceTrack=a.RTCRtpSender.prototype.setTrack)}}},{"../utils":13,"./getusermedia":9,"rtcpeerconnection-shim":1}],9:[function(b,a,d){a.exports=function(a){a=a&&a.navigator;var b=a.mediaDevices.getUserMedia.bind(a.mediaDevices);a.mediaDevices.getUserMedia=function(a){return b(a).catch(function(a){return Promise.reject(function(a){return{name:{PermissionDeniedError:"NotAllowedError"}[a.name]||
a.name,message:a.message,constraint:a.constraint,toString:function(){return this.name}}}(a))})}}},{}],10:[function(b,a,d){var g=b("../utils");a.exports={shimOnTrack:function(a){"object"!=typeof a||!a.RTCPeerConnection||"ontrack"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(a){this._ontrack&&(this.removeEventListener("track",this._ontrack),this.removeEventListener("addstream",this._ontrackpoly));this.addEventListener("track",
this._ontrack=a);this.addEventListener("addstream",this._ontrackpoly=function(a){a.stream.getTracks().forEach(function(b){var c=new Event("track");c.track=b;c.receiver={track:b};c.transceiver={receiver:c.receiver};c.streams=[a.stream];this.dispatchEvent(c)}.bind(this))}.bind(this))}});"object"==typeof a&&a.RTCTrackEvent&&"receiver"in a.RTCTrackEvent.prototype&&!("transceiver"in a.RTCTrackEvent.prototype)&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},
shimSourceObject:function(a){"object"==typeof a&&(!a.HTMLMediaElement||"srcObject"in a.HTMLMediaElement.prototype||Object.defineProperty(a.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(a){this.mozSrcObject=a}}))},shimPeerConnection:function(a){var b=g.detectBrowser(a);if("object"==typeof a&&(a.RTCPeerConnection||a.mozRTCPeerConnection)){a.RTCPeerConnection||(a.RTCPeerConnection=function(c,d){if(38>b.version&&c&&c.iceServers){for(var f=[],g=0;g<c.iceServers.length;g++){var h=
c.iceServers[g];if(h.hasOwnProperty("urls"))for(var l=0;l<h.urls.length;l++){var k={url:h.urls[l]};0===h.urls[l].indexOf("turn")&&(k.username=h.username,k.credential=h.credential);f.push(k)}else f.push(c.iceServers[g])}c.iceServers=f}return new a.mozRTCPeerConnection(c,d)},a.RTCPeerConnection.prototype=a.mozRTCPeerConnection.prototype,a.mozRTCPeerConnection.generateCertificate&&Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return a.mozRTCPeerConnection.generateCertificate}}),
a.RTCSessionDescription=a.mozRTCSessionDescription,a.RTCIceCandidate=a.mozRTCIceCandidate);["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(b){var c=a.RTCPeerConnection.prototype[b];a.RTCPeerConnection.prototype[b]=function(){return arguments[0]=new ("addIceCandidate"===b?a.RTCIceCandidate:a.RTCSessionDescription)(arguments[0]),c.apply(this,arguments)}});var c=a.RTCPeerConnection.prototype.addIceCandidate;a.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?
c.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var d={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},h=a.RTCPeerConnection.prototype.getStats;a.RTCPeerConnection.prototype.getStats=function(a,c,f){return h.apply(this,[a||null]).then(function(a){if(48>b.version&&(a=function(a){var b=new Map;return Object.keys(a).forEach(function(c){b.set(c,a[c]);b[c]=a[c]}),
b}(a)),53>b.version&&!c)try{a.forEach(function(a){a.type=d[a.type]||a.type})}catch(p){if("TypeError"!==p.name)throw p;a.forEach(function(b,c){a.set(c,Object.assign({},b,{type:d[b.type]||b.type}))})}return a}).then(c,f)}}},shimGetUserMedia:b("./getusermedia")}},{"../utils":13,"./getusermedia":11}],11:[function(b,a,d){var g=b("../utils"),c=g.log;a.exports=function(a){var b=g.detectBrowser(a),d=a&&a.navigator;a=a&&a.MediaStreamTrack;var f=function(a){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",
PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[a.name]||a.name,message:{"The operation is insecure.":"The request is not allowed by the user agent or the platform in the current context."}[a.message]||a.message,constraint:a.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}},h=function(a,g,h){var l=function(a){if("object"!=typeof a||a.require)return a;var b=[];return Object.keys(a).forEach(function(c){if("require"!==c&&"advanced"!==c&&"mediaSource"!==
c){var d=a[c]="object"==typeof a[c]?a[c]:{ideal:a[c]};if(void 0===d.min&&void 0===d.max&&void 0===d.exact||b.push(c),void 0!==d.exact&&("number"==typeof d.exact?d.min=d.max=d.exact:a[c]=d.exact,delete d.exact),void 0!==d.ideal){a.advanced=a.advanced||[];var f={};"number"==typeof d.ideal?f[c]={min:d.ideal,max:d.ideal}:f[c]=d.ideal;a.advanced.push(f);delete d.ideal;Object.keys(d).length||delete a[c]}}}),b.length&&(a.require=b),a};return a=JSON.parse(JSON.stringify(a)),38>b.version&&(c("spec: "+JSON.stringify(a)),
a.audio&&(a.audio=l(a.audio)),a.video&&(a.video=l(a.video)),c("ff37: "+JSON.stringify(a))),d.mozGetUserMedia(a,g,function(a){h(f(a))})};if(d.mediaDevices||(d.mediaDevices={getUserMedia:function(a){return new Promise(function(b,c){h(a,b,c)})},addEventListener:function(){},removeEventListener:function(){}}),d.mediaDevices.enumerateDevices=d.mediaDevices.enumerateDevices||function(){return new Promise(function(a){a([{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",
label:"",groupId:""}])})},41>b.version){var k=d.mediaDevices.enumerateDevices.bind(d.mediaDevices);d.mediaDevices.enumerateDevices=function(){return k().then(void 0,function(a){if("NotFoundError"===a.name)return[];throw a;})}}if(49>b.version){var m=d.mediaDevices.getUserMedia.bind(d.mediaDevices);d.mediaDevices.getUserMedia=function(a){return m(a).then(function(b){if(a.audio&&!b.getAudioTracks().length||a.video&&!b.getVideoTracks().length)throw b.getTracks().forEach(function(a){a.stop()}),new DOMException("The object can not be found here.",
"NotFoundError");return b},function(a){return Promise.reject(f(a))})}}if(!(55<b.version&&"autoGainControl"in d.mediaDevices.getSupportedConstraints())){var n=function(a,b,c){b in a&&!(c in a)&&(a[c]=a[b],delete a[b])},p=d.mediaDevices.getUserMedia.bind(d.mediaDevices);if(d.mediaDevices.getUserMedia=function(a){return"object"==typeof a&&"object"==typeof a.audio&&(a=JSON.parse(JSON.stringify(a)),n(a.audio,"autoGainControl","mozAutoGainControl"),n(a.audio,"noiseSuppression","mozNoiseSuppression")),p(a)},
a&&a.prototype.getSettings){var w=a.prototype.getSettings;a.prototype.getSettings=function(){var a=w.apply(this,arguments);return n(a,"mozAutoGainControl","autoGainControl"),n(a,"mozNoiseSuppression","noiseSuppression"),a}}if(a&&a.prototype.applyConstraints){var A=a.prototype.applyConstraints;a.prototype.applyConstraints=function(a){return"audio"===this.kind&&"object"==typeof a&&(a=JSON.parse(JSON.stringify(a)),n(a,"autoGainControl","mozAutoGainControl"),n(a,"noiseSuppression","mozNoiseSuppression")),
A.apply(this,[a])}}}d.getUserMedia=function(a,c,f){if(44>b.version)return h(a,c,f);g.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");d.mediaDevices.getUserMedia(a).then(c,f)}}},{"../utils":13}],12:[function(b,a,d){var g=b("../utils");a.exports={shimCallbacksAPI:function(a){if("object"==typeof a&&a.RTCPeerConnection){a=a.RTCPeerConnection.prototype;var b=a.createOffer,c=a.createAnswer,d=a.setLocalDescription,g=a.setRemoteDescription,h=a.addIceCandidate;a.createOffer=function(a,
c){var d=b.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);return c?(d.then(a,c),Promise.resolve()):d};a.createAnswer=function(a,b){var d=c.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);return b?(d.then(a,b),Promise.resolve()):d};var k=function(a,b,c){a=d.apply(this,[a]);return c?(a.then(b,c),Promise.resolve()):a};a.setLocalDescription=k;k=function(a,b,c){a=g.apply(this,[a]);return c?(a.then(b,c),Promise.resolve()):a};a.setRemoteDescription=k;k=function(a,b,c){a=h.apply(this,
[a]);return c?(a.then(b,c),Promise.resolve()):a};a.addIceCandidate=k}},shimLocalStreamsAPI:function(a){if("object"==typeof a&&a.RTCPeerConnection){if("getLocalStreams"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),"getStreamById"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getStreamById=function(a){var b=null;return this._localStreams&&this._localStreams.forEach(function(c){c.id===
a&&(b=c)}),this._remoteStreams&&this._remoteStreams.forEach(function(c){c.id===a&&(b=c)}),b}),!("addStream"in a.RTCPeerConnection.prototype)){var b=a.RTCPeerConnection.prototype.addTrack;a.RTCPeerConnection.prototype.addStream=function(a){this._localStreams||(this._localStreams=[]);-1===this._localStreams.indexOf(a)&&this._localStreams.push(a);var c=this;a.getTracks().forEach(function(d){b.call(c,d,a)})};a.RTCPeerConnection.prototype.addTrack=function(a,c){c&&(this._localStreams?-1===this._localStreams.indexOf(c)&&
this._localStreams.push(c):this._localStreams=[c]);b.call(this,a,c)}}"removeStream"in a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.removeStream=function(a){this._localStreams||(this._localStreams=[]);var b=this._localStreams.indexOf(a);if(-1!==b){this._localStreams.splice(b,1);var c=this,d=a.getTracks();this.getSenders().forEach(function(a){-1!==d.indexOf(a.track)&&c.removeTrack(a)})}})}},shimRemoteStreamsAPI:function(a){"object"==typeof a&&a.RTCPeerConnection&&("getRemoteStreams"in
a.RTCPeerConnection.prototype||(a.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),"onaddstream"in a.RTCPeerConnection.prototype||Object.defineProperty(a.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(a){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly));this.addEventListener("addstream",this._onaddstream=a);
this.addEventListener("track",this._onaddstreampoly=function(a){var b=a.streams[0];(this._remoteStreams||(this._remoteStreams=[]),0<=this._remoteStreams.indexOf(b))||(this._remoteStreams.push(b),b=new Event("addstream"),b.stream=a.streams[0],this.dispatchEvent(b))}.bind(this))}}))},shimGetUserMedia:function(a){var b=a&&a.navigator;b.getUserMedia||(b.webkitGetUserMedia?b.getUserMedia=b.webkitGetUserMedia.bind(b):b.mediaDevices&&b.mediaDevices.getUserMedia&&(b.getUserMedia=function(a,c,d){b.mediaDevices.getUserMedia(a).then(c,
d)}.bind(b)))},shimRTCIceServerUrls:function(a){var b=a.RTCPeerConnection;a.RTCPeerConnection=function(a,c){if(a&&a.iceServers){for(var d=[],f=0;f<a.iceServers.length;f++){var h=a.iceServers[f];!h.hasOwnProperty("urls")&&h.hasOwnProperty("url")?(g.deprecated("RTCIceServer.url","RTCIceServer.urls"),(h=JSON.parse(JSON.stringify(h))).urls=h.url,delete h.url,d.push(h)):d.push(a.iceServers[f])}a.iceServers=d}return new b(a,c)};a.RTCPeerConnection.prototype=b.prototype;"generateCertificate"in a.RTCPeerConnection&&
Object.defineProperty(a.RTCPeerConnection,"generateCertificate",{get:function(){return b.generateCertificate}})},shimTrackEventTransceiver:function(a){"object"==typeof a&&a.RTCPeerConnection&&"receiver"in a.RTCTrackEvent.prototype&&!a.RTCTransceiver&&Object.defineProperty(a.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},shimCreateOfferLegacy:function(a){var b=a.RTCPeerConnection.prototype.createOffer;a.RTCPeerConnection.prototype.createOffer=function(a){if(a){var c=
this.getTransceivers().find(function(a){return a.sender.track&&"audio"===a.sender.track.kind});!1===a.offerToReceiveAudio&&c?"sendrecv"===c.direction?c.setDirection("sendonly"):"recvonly"===c.direction&&c.setDirection("inactive"):!0!==a.offerToReceiveAudio||c||this.addTransceiver("audio");c=this.getTransceivers().find(function(a){return a.sender.track&&"video"===a.sender.track.kind});!1===a.offerToReceiveVideo&&c?"sendrecv"===c.direction?c.setDirection("sendonly"):"recvonly"===c.direction&&c.setDirection("inactive"):
!0!==a.offerToReceiveVideo||c||this.addTransceiver("video")}return b.apply(this,arguments)}}}},{"../utils":13}],13:[function(b,a,d){var g=!0,c=!0;b={disableLog:function(a){return"boolean"!=typeof a?Error("Argument type: "+typeof a+". Please use a boolean."):(g=a,a?"adapter.js logging disabled":"adapter.js logging enabled")},disableWarnings:function(a){return"boolean"!=typeof a?Error("Argument type: "+typeof a+". Please use a boolean."):(c=!a,"adapter.js deprecation warnings "+(a?"disabled":"enabled"))},
log:function(){"object"!=typeof window||g||"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)},deprecated:function(a,b){c&&console.warn(a+" is deprecated, please use "+b+" instead.")},extractVersion:function(a,b,c){return(a=a.match(b))&&a.length>=c&&parseInt(a[c],10)},detectBrowser:function(a){var b=a&&a.navigator,c={browser:null,version:null};if(void 0===a||!a.navigator)return c.browser="Not a browser.",c;if(b.mozGetUserMedia)c.browser="firefox",c.version=
this.extractVersion(b.userAgent,/Firefox\/(\d+)\./,1);else if(b.webkitGetUserMedia)if(a.webkitRTCPeerConnection)c.browser="chrome",c.version=this.extractVersion(b.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!b.userAgent.match(/Version\/(\d+).(\d+)/))return c.browser="Unsupported webkit-based browser with GUM support but no WebRTC support.",c;c.browser="safari";c.version=this.extractVersion(b.userAgent,/AppleWebKit\/(\d+)\./,1)}else if(b.mediaDevices&&b.userAgent.match(/Edge\/(\d+).(\d+)$/))c.browser=
"edge",c.version=this.extractVersion(b.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!b.mediaDevices||!b.userAgent.match(/AppleWebKit\/(\d+)\./))return c.browser="Not a supported browser.",c;c.browser="safari";c.version=this.extractVersion(b.userAgent,/AppleWebKit\/(\d+)\./,1)}return c}};a.exports={log:b.log,deprecated:b.deprecated,disableLog:b.disableLog,disableWarnings:b.disableWarnings,extractVersion:b.extractVersion,shimCreateObjectURL:b.shimCreateObjectURL,detectBrowser:b.detectBrowser.bind(b)}},
{}]},{},[3])(3)}).call(this,h(18))},function(k,n,h){h(31)(h(32))},function(k,n){k.exports=function(h){function d(d){"undefined"!=typeof console&&(console.error||console.log)("[Script Loader]",d)}try{"undefined"!=typeof execScript&&"undefined"!=typeof attachEvent&&"undefined"==typeof addEventListener?execScript(h):"undefined"!=typeof eval?eval.call(null,h):d("EvalError: No eval function available")}catch(e){d(e)}}},function(k,n){k.exports="/* globals $$, jQuery, Elements, document, window, L */\r\n\r\n/**\r\n* Copyright 2013 Marc J. Schmidt. See the LICENSE file at the top-level\r\n* directory of this distribution and at\r\n* https://github.com/marcj/css-element-queries/blob/master/LICENSE.\r\n*/\r\nthis.L \x3d this.L || {};\r\n\r\n/**\r\n * @param {HTMLElement} element\r\n * @param {String}      prop\r\n * @returns {String|Number}\r\n */\r\nL.GetComputedStyle \x3d (computedElement, prop) \x3d\x3e {\r\n  if (computedElement.currentStyle) {\r\n    return computedElement.currentStyle[prop];\r\n  } else if (window.getComputedStyle) {\r\n    return window.getComputedStyle(computedElement, null).getPropertyValue(prop);\r\n  }\r\n  return computedElement.style[prop];\r\n};\r\n\r\n  /**\r\n   *\r\n   * @type {Function}\r\n   * @constructor\r\n   */\r\nL.ElementQueries \x3d function ElementQueries() {\r\n      /**\r\n       *\r\n       * @param element\r\n       * @returns {Number}\r\n       */\r\n  function getEmSize(element \x3d document.documentElement) {\r\n    const fontSize \x3d L.GetComputedStyle(element, 'fontSize');\r\n    return parseFloat(fontSize) || 16;\r\n  }\r\n\r\n      /**\r\n       *\r\n       * @copyright https://github.com/Mr0grog/element-query/blob/master/LICENSE\r\n       *\r\n       * @param element\r\n       * @param value\r\n       * @param units\r\n       * @returns {*}\r\n       */\r\n  function convertToPx(element, originalValue) {\r\n    let vh;\r\n    let vw;\r\n    let chooser;\r\n    const units \x3d originalValue.replace(/[0-9]*/, '');\r\n    const value \x3d parseFloat(originalValue);\r\n    switch (units) {\r\n      case 'px':\r\n        return value;\r\n      case 'em':\r\n        return value * getEmSize(element);\r\n      case 'rem':\r\n        return value * getEmSize();\r\n              // Viewport units!\r\n              // According to http://quirksmode.org/mobile/tableViewport.html\r\n              // documentElement.clientWidth/Height gets us the most reliable info\r\n      case 'vw':\r\n        return (value * document.documentElement.clientWidth) / 100;\r\n      case 'vh':\r\n        return (value * document.documentElement.clientHeight) / 100;\r\n      case 'vmin':\r\n      case 'vmax':\r\n        vw \x3d document.documentElement.clientWidth / 100;\r\n        vh \x3d document.documentElement.clientHeight / 100;\r\n        chooser \x3d Math[units \x3d\x3d\x3d 'vmin' ? 'min' : 'max'];\r\n        return value * chooser(vw, vh);\r\n      default:\r\n        return value;\r\n              // for now, not supporting physical units (since they are just a set number of px)\r\n              // or ex/ch (getting accurate measurements is hard)\r\n    }\r\n  }\r\n\r\n      /**\r\n       *\r\n       * @param {HTMLElement} element\r\n       * @constructor\r\n       */\r\n  function SetupInformation(element) {\r\n    this.element \x3d element;\r\n    this.options \x3d [];\r\n    let i;\r\n    let j;\r\n    let option;\r\n    let width \x3d 0;\r\n    let height \x3d 0;\r\n    let value;\r\n    let actualValue;\r\n    let attrValues;\r\n    let attrValue;\r\n    let attrName;\r\n\r\n          /**\r\n           * @param option {mode: 'min|max', property: 'width|height', value: '123px'}\r\n           */\r\n    this.addOption \x3d (newOption) \x3d\x3e {\r\n      this.options.push(newOption);\r\n    };\r\n\r\n    const attributes \x3d ['min-width', 'min-height', 'max-width', 'max-height'];\r\n\r\n          /**\r\n           * Extracts the computed width/height and sets to min/max- attribute.\r\n           */\r\n    this.call \x3d () \x3d\x3e {\r\n              // extract current dimensions\r\n      width \x3d this.element.offsetWidth;\r\n      height \x3d this.element.offsetHeight;\r\n\r\n      attrValues \x3d {};\r\n\r\n      for (i \x3d 0, j \x3d this.options.length; i \x3c j; i +\x3d 1) {\r\n        option \x3d this.options[i];\r\n        value \x3d convertToPx(this.element, option.value);\r\n\r\n        actualValue \x3d option.property \x3d\x3d\x3d 'width' ? width : height;\r\n        attrName \x3d `${option.mode}-${option.property}`;\r\n        attrValue \x3d '';\r\n\r\n        if (option.mode \x3d\x3d\x3d 'min' \x26\x26 actualValue \x3e\x3d value) {\r\n          attrValue +\x3d option.value;\r\n        }\r\n\r\n        if (option.mode \x3d\x3d\x3d 'max' \x26\x26 actualValue \x3c\x3d value) {\r\n          attrValue +\x3d option.value;\r\n        }\r\n\r\n        if (!attrValues[attrName]) attrValues[attrName] \x3d '';\r\n        if (attrValue \x26\x26 (` ${attrValues[attrName]} `)\r\n                                            .indexOf(` ${attrValue} `) \x3d\x3d\x3d -1) {\r\n          attrValues[attrName] +\x3d ` ${attrValue}`;\r\n        }\r\n      }\r\n\r\n      for (let k \x3d 0; k \x3c attributes.length; k +\x3d 1) {\r\n        if (attrValues[attributes[k]]) {\r\n          this.element.setAttribute(attributes[k],\r\n                                                attrValues[attributes[k]].substr(1));\r\n        } else {\r\n          this.element.removeAttribute(attributes[k]);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n      /**\r\n       * @param {HTMLElement} element\r\n       * @param {Object}      options\r\n       */\r\n  function setupElement(originalElement, options) {\r\n    const element \x3d originalElement;\r\n    if (element.elementQueriesSetupInformation) {\r\n      element.elementQueriesSetupInformation.addOption(options);\r\n    } else {\r\n      element.elementQueriesSetupInformation \x3d new SetupInformation(element);\r\n      element.elementQueriesSetupInformation.addOption(options);\r\n      element.sensor \x3d new L.ResizeSensor(element, () \x3d\x3e {\r\n        element.elementQueriesSetupInformation.call();\r\n      });\r\n    }\r\n    element.elementQueriesSetupInformation.call();\r\n    return element;\r\n  }\r\n\r\n      /**\r\n       * @param {String} selector\r\n       * @param {String} mode min|max\r\n       * @param {String} property width|height\r\n       * @param {String} value\r\n       */\r\n  function queueQuery(selector, mode, property, value) {\r\n    let query;\r\n    if (document.querySelectorAll) query \x3d document.querySelectorAll.bind(document);\r\n    if (!query \x26\x26 typeof $$ !\x3d\x3d 'undefined') query \x3d $$;\r\n    if (!query \x26\x26 typeof jQuery !\x3d\x3d 'undefined') query \x3d jQuery;\r\n\r\n    if (!query) {\r\n      throw new Error('No document.querySelectorAll, jQuery or Mootools\\'s $$ found.');\r\n    }\r\n\r\n    const elements \x3d query(selector) || [];\r\n    for (let i \x3d 0, j \x3d elements.length; i \x3c j; i +\x3d 1) {\r\n      elements[i] \x3d setupElement(elements[i], {\r\n        mode,\r\n        property,\r\n        value,\r\n      });\r\n    }\r\n  }\r\n\r\n  const regex \x3d /,?([^,\\n]*)\\[[\\s\\t]*(min|max)-(width|height)[\\s\\t]*[~$^]?\x3d[\\s\\t]*\"([^\"]*)\"[\\s\\t]*]([^\\n\\s{]*)/mgi;  // jshint ignore:line\r\n\r\n      /**\r\n       * @param {String} css\r\n       */\r\n  function extractQuery(originalCss) {\r\n    let match;\r\n    const css \x3d originalCss.replace(/'/g, '\"');\r\n    while ((match \x3d regex.exec(css)) !\x3d\x3d null) {\r\n      if (match.length \x3e 5) {\r\n        queueQuery(match[1] || match[5], match[2], match[3], match[4]);\r\n      }\r\n    }\r\n  }\r\n\r\n      /**\r\n       * @param {CssRule[]|String} rules\r\n       */\r\n  function readRules(originalRules) {\r\n    if (!originalRules) {\r\n      return;\r\n    }\r\n    let selector \x3d '';\r\n    let rules \x3d originalRules;\r\n    if (typeof originalRules \x3d\x3d\x3d 'string') {\r\n      rules \x3d originalRules.toLowerCase();\r\n      if (rules.indexOf('min-width') !\x3d\x3d -1 || rules.indexOf('max-width') !\x3d\x3d -1) {\r\n        extractQuery(rules);\r\n      }\r\n    } else {\r\n      for (let i \x3d 0, j \x3d rules.length; i \x3c j; i +\x3d 1) {\r\n        if (rules[i].type \x3d\x3d\x3d 1) {\r\n          selector \x3d rules[i].selectorText || rules[i].cssText;\r\n          if (selector.indexOf('min-height') !\x3d\x3d -1 ||\r\n                          selector.indexOf('max-height') !\x3d\x3d -1) {\r\n            extractQuery(selector);\r\n          } else if (selector.indexOf('min-width') !\x3d\x3d -1 ||\r\n                                 selector.indexOf('max-width') !\x3d\x3d -1) {\r\n            extractQuery(selector);\r\n          }\r\n        } else if (rules[i].type \x3d\x3d\x3d 4) {\r\n          readRules(rules[i].cssRules || rules[i].rules);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n      /**\r\n       * Searches all css rules and setups the event listener\r\n       * to all elements with element query rules..\r\n       */\r\n  this.init \x3d () \x3d\x3e {\r\n    const styleSheets \x3d document.styleSheets || [];\r\n    for (let i \x3d 0, j \x3d styleSheets.length; i \x3c j; i +\x3d 1) {\r\n      if (Object.prototype.hasOwnProperty.call(styleSheets[i], 'cssText')) {\r\n        readRules(styleSheets[i].cssText);\r\n      } else if (Object.prototype.hasOwnProperty.call(styleSheets[i], 'cssRules')) {\r\n        readRules(styleSheets[i].cssRules);\r\n      } else if (Object.prototype.hasOwnProperty.call(styleSheets[i], 'rules')) {\r\n        readRules(styleSheets[i].rules);\r\n      }\r\n    }\r\n  };\r\n};\r\n\r\nfunction init() {\r\n  (new L.ElementQueries()).init();\r\n}\r\n\r\nif (window.addEventListener) {\r\n  window.addEventListener('load', init, false);\r\n} else {\r\n  window.attachEvent('onload', init);\r\n}\r\n\r\n  /**\r\n   * Iterate over each of the provided element(s).\r\n   *\r\n   * @param {HTMLElement|HTMLElement[]} elements\r\n   * @param {Function}                  callback\r\n   */\r\nfunction forEachElement(elements, callback \x3d () \x3d\x3e {}) {\r\n  const elementsType \x3d Object.prototype.toString.call(elements);\r\n  const isCollectionTyped \x3d (elementsType \x3d\x3d\x3d '[object Array]' ||\r\n          (elementsType \x3d\x3d\x3d '[object NodeList]') ||\r\n          (elementsType \x3d\x3d\x3d '[object HTMLCollection]') ||\r\n          (typeof jQuery !\x3d\x3d 'undefined' \x26\x26 elements instanceof jQuery) || // jquery\r\n          (typeof Elements !\x3d\x3d 'undefined' \x26\x26 elements instanceof Elements) // mootools\r\n      );\r\n  let i \x3d 0;\r\n  const j \x3d elements.length;\r\n  if (isCollectionTyped) {\r\n    for (; i \x3c j; i +\x3d 1) {\r\n      callback(elements[i]);\r\n    }\r\n  } else {\r\n    callback(elements);\r\n  }\r\n}\r\n  /**\r\n   * Class for dimension change detection.\r\n   *\r\n   * @param {Element|Element[]|Elements|jQuery} element\r\n   * @param {Function} callback\r\n   *\r\n   * @constructor\r\n   */\r\nL.ResizeSensor \x3d function ResizeSensor(element, callback \x3d () \x3d\x3e {}) {\r\n      /**\r\n       *\r\n       * @constructor\r\n       */\r\n  function EventQueue() {\r\n    let q \x3d [];\r\n    this.add \x3d (ev) \x3d\x3e {\r\n      q.push(ev);\r\n    };\r\n\r\n    let i;\r\n    let j;\r\n    this.call \x3d () \x3d\x3e {\r\n      for (i \x3d 0, j \x3d q.length; i \x3c j; i +\x3d 1) {\r\n        q[i].call();\r\n      }\r\n    };\r\n\r\n    this.remove \x3d (ev) \x3d\x3e {\r\n      const newQueue \x3d [];\r\n      for (i \x3d 0, j \x3d q.length; i \x3c j; i +\x3d 1) {\r\n        if (q[i] !\x3d\x3d ev) newQueue.push(q[i]);\r\n      }\r\n      q \x3d newQueue;\r\n    };\r\n\r\n    this.length \x3d () \x3d\x3e q.length;\r\n  }\r\n\r\n      /**\r\n       *\r\n       * @param {HTMLElement} element\r\n       * @param {Function}    resized\r\n       */\r\n  function attachResizeEvent(htmlElement, resized) {\r\n    // Only used for the dirty checking, so the event callback count is limted\r\n    //  to max 1 call per fps per sensor.\r\n    // In combination with the event based resize sensor this saves cpu time,\r\n    // because the sensor is too fast and\r\n    // would generate too many unnecessary events.\r\n    const customRequestAnimationFrame \x3d window.requestAnimationFrame ||\r\n    window.mozRequestAnimationFrame ||\r\n    window.webkitRequestAnimationFrame ||\r\n    function delay(fn) {\r\n      return window.setTimeout(fn, 20);\r\n    };\r\n\r\n    const newElement \x3d htmlElement;\r\n    if (!newElement.resizedAttached) {\r\n      newElement.resizedAttached \x3d new EventQueue();\r\n      newElement.resizedAttached.add(resized);\r\n    } else if (newElement.resizedAttached) {\r\n      newElement.resizedAttached.add(resized);\r\n      return;\r\n    }\r\n\r\n    newElement.resizeSensor \x3d document.createElement('div');\r\n    newElement.resizeSensor.className \x3d 'resize-sensor';\r\n    const style \x3d 'position: absolute; left: 0; top: 0; right: 0; bottom: 0; ' +\r\n                      'overflow: hidden; z-index: -1; visibility: hidden;';\r\n    const styleChild \x3d 'position: absolute; left: 0; top: 0; transition: 0s;';\r\n\r\n    newElement.resizeSensor.style.cssText \x3d style;\r\n    newElement.resizeSensor.innerHTML \x3d\r\n              `\x3cdiv class\x3d\"resize-sensor-expand\" style\x3d\"${style}\"\x3e` +\r\n                  `\x3cdiv style\x3d\"${styleChild}\"\x3e\x3c/div\x3e` +\r\n              '\x3c/div\x3e' +\r\n              `\x3cdiv class\x3d\"resize-sensor-shrink\" style\x3d\"${style}\"\x3e` +\r\n                  `\x3cdiv style\x3d\"${styleChild} width: 200%; height: 200%\"\x3e\x3c/div\x3e` +\r\n              '\x3c/div\x3e';\r\n    newElement.appendChild(newElement.resizeSensor);\r\n\r\n    if (L.GetComputedStyle(newElement, 'position') \x3d\x3d\x3d 'static') {\r\n      newElement.style.position \x3d 'relative';\r\n    }\r\n\r\n    const expand \x3d newElement.resizeSensor.childNodes[0];\r\n    const expandChild \x3d expand.childNodes[0];\r\n    const shrink \x3d newElement.resizeSensor.childNodes[1];\r\n\r\n    const reset \x3d () \x3d\x3e {\r\n      expandChild.style.width \x3d `${100000}px`;\r\n      expandChild.style.height \x3d `${100000}px`;\r\n\r\n      expand.scrollLeft \x3d 100000;\r\n      expand.scrollTop \x3d 100000;\r\n\r\n      shrink.scrollLeft \x3d 100000;\r\n      shrink.scrollTop \x3d 100000;\r\n    };\r\n\r\n    reset();\r\n    let dirty \x3d false;\r\n\r\n    const dirtyChecking \x3d () \x3d\x3e {\r\n      if (!newElement.resizedAttached) return;\r\n\r\n      if (dirty) {\r\n        newElement.resizedAttached.call();\r\n        dirty \x3d false;\r\n      }\r\n\r\n      customRequestAnimationFrame(dirtyChecking);\r\n    };\r\n\r\n    customRequestAnimationFrame(dirtyChecking);\r\n    let lastWidth;\r\n    let lastHeight;\r\n    let cachedWidth;\r\n    let cachedHeight; // useful to not query offsetWidth twice\r\n\r\n    const onScroll \x3d () \x3d\x3e {\r\n      if ((cachedWidth \x3d newElement.offsetWidth) !\x3d\x3d lastWidth ||\r\n                (cachedHeight \x3d newElement.offsetHeight) !\x3d\x3d lastHeight) {\r\n        dirty \x3d true;\r\n\r\n        lastWidth \x3d cachedWidth;\r\n        lastHeight \x3d cachedHeight;\r\n      }\r\n      reset();\r\n    };\r\n\r\n    const addEvent \x3d (el, name, cb) \x3d\x3e {\r\n      if (el.attachEvent) {\r\n        el.attachEvent(`on${name}`, cb);\r\n      } else {\r\n        el.addEventListener(name, cb);\r\n      }\r\n    };\r\n\r\n    addEvent(expand, 'scroll', onScroll);\r\n    addEvent(shrink, 'scroll', onScroll);\r\n  }\r\n\r\n  forEachElement(element, (elem) \x3d\x3e {\r\n    attachResizeEvent(elem, callback);\r\n  });\r\n\r\n  this.detach \x3d (ev) \x3d\x3e {\r\n    L.ResizeSensor.detach(element, ev);\r\n  };\r\n};\r\n\r\nL.ResizeSensor.detach \x3d (element, ev) \x3d\x3e {\r\n  forEachElement(element, (elem) \x3d\x3e {\r\n    const elementItem \x3d elem;\r\n    if (elementItem.resizedAttached \x26\x26 typeof ev \x3d\x3d\x3d 'function') {\r\n      elementItem.resizedAttached.remove(ev);\r\n      if (elementItem.resizedAttached.length()) return;\r\n    }\r\n    if (elementItem.resizeSensor) {\r\n      if (elementItem.contains(elementItem.resizeSensor)) {\r\n        elementItem.removeChild(elementItem.resizeSensor);\r\n      }\r\n      delete elementItem.resizeSensor;\r\n      delete elementItem.resizedAttached;\r\n    }\r\n  });\r\n};\r\n"},
function(k,n,h){h.r(n);k=h(1);var d=h.n(k),e={addSim:function(a){var b="a\x3dssrc-group:SIM";return a.forEach(function(a){b+=" "+a}),b+"\r\n"},addGroup:function(a,b){return"a\x3dssrc-group:FID "+a+" "+b+"\r\n"},addSpatialLayer:function(a,b,c,d,e,f){return"a\x3dssrc:"+e+" cname:"+a+"\r\n"+("a\x3dssrc:"+e+" msid:"+b+"\r\n")+("a\x3dssrc:"+e+" mslabel:"+c+"\r\n")+("a\x3dssrc:"+e+" label:"+d+"\r\n")+("a\x3dssrc:"+f+" cname:"+a+"\r\n")+("a\x3dssrc:"+f+" msid:"+b+"\r\n")+("a\x3dssrc:"+f+" mslabel:"+c+"\r\n")+
("a\x3dssrc:"+f+" label:"+d+"\r\n")},setMaxBW:function(a,b){if(b.p2p){if(b.video&&b.maxVideoBW){var c=a.getMedia("video");c&&c.setBitrate(b.maxVideoBW)}b.audio&&b.maxAudioBW&&(a=a.getMedia("audio"))&&a.setBitrate(b.maxAudioBW)}},enableOpusNacks:function(a){var b=a.match(/a=rtpmap:(.*)opus.*\r\n/);null!==b&&(a=a.replace(b[0],b[0]+"a\x3drtcp-fb:"+b[1]+"nack\r\n"));return a},setParamForCodecs:function(a,b,c,d){a.medias.forEach(function(a){a.id===b&&a.codecs.forEach(function(a){a.setParam(c,d)})})}},
b=h(0),a=function(a){var c={},f=[],g,h,k,l,B=!1,m=-1;b.a.info("Starting Base stack",a);c.pcConfig={iceServers:[]};c.con={};void 0!==a.iceServers&&(c.pcConfig.iceServers=a.iceServers);!0===a.forceTurn&&(c.pcConfig.iceTransportPolicy="relay");c.audio=a.audio;c.video=a.video;void 0===c.audio&&(c.audio=!0);void 0===c.video&&(c.video=!0);a.remoteCandidates=[];a.localCandidates=[];a.remoteDescriptionSet=!1;c.mediaConstraints={offerToReceiveVideo:void 0!==c.video&&!1!==c.video,offerToReceiveAudio:void 0!==
c.audio&&!1!==c.audio};c.peerConnection=new RTCPeerConnection(c.pcConfig,c.con);var n=function(a,c,d){b.a.error("message:",d,"in baseStack at",a);void 0!==c&&c("error")},p=function(){if(!B&&0<f.length){var a=f.pop();"local"===a[0]?c.createOffer(a[1],a[2],a[3]):r(a[1])}},q=function(f){g=f;k=d.a.SDPInfo.processString(g.sdp);e.setMaxBW(k,a);g.sdp=k.toString();c.localSdp=k;a.callback({type:g.type,sdp:g.sdp,config:{maxVideoBW:a.maxVideoBW}});b.a.info("Setting local description",g);c.peerConnection.setLocalDescription(g).then(function(){B=
!1;p();b.a.info("Success in BaseStack",void 0)}).catch(n)};var r=function(b){B?f.push(["remote",b]):(B=!0,l=d.a.SDPInfo.processString(b.sdp),e.setMaxBW(l,a),b.sdp=l.toString(),c.remoteSdp=l,c.peerConnection.setRemoteDescription(b).then(function(){c.peerConnection.createAnswer(c.mediaConstraints).then(q).catch(n.bind(null,"createAnswer",void 0));a.remoteDescriptionSet=!0}).catch(n.bind(null,"process Offer",void 0)))};return c.peerConnection.onicecandidate=function(c){var d={};(c=c.candidate)?(d={sdpMLineIndex:c.sdpMLineIndex,
sdpMid:c.sdpMid,candidate:c.candidate}).candidate.match(/a=/)||(d.candidate="a\x3d"+d.candidate):(b.a.info("Gathered all candidates. Sending END candidate"),d={sdpMLineIndex:-1,sdpMid:"end",candidate:"end"});a.remoteDescriptionSet?a.callback({type:"candidate",candidate:d}):(a.localCandidates.push(d),b.a.info("Storing candidate: ",a.localCandidates.length,d))},c.setStartVideoBW=function(a){return b.a.error("startVideoBW not implemented for this browser"),a},c.setHardMinVideoBW=function(a){return b.a.error("hardMinVideoBw not implemented for this browser"),
a},c.enableSimulcast=function(a){return b.a.error("Simulcast not implemented"),a},c.close=function(){c.state="closed";c.peerConnection.close()},c.setSimulcast=function(a){c.simulcast=a},c.setVideo=function(a){c.video=a},c.setAudio=function(a){c.audio=a},c.updateSpec=function(f,t,C){C=void 0===C?function(){}:C;var B=!a.p2p&&f.maxVideoBW;(a.p2p&&f.maxVideoBW||f.maxAudioBW)&&(f.maxVideoBW&&(b.a.debug("Maxvideo Requested:",f.maxVideoBW,"limit:",a.limitMaxVideoBW),f.maxVideoBW>a.limitMaxVideoBW&&(f.maxVideoBW=
a.limitMaxVideoBW),a.maxVideoBW=f.maxVideoBW,b.a.debug("Result",a.maxVideoBW)),f.maxAudioBW&&(f.maxAudioBW>a.limitMaxAudioBW&&(f.maxAudioBW=a.limitMaxAudioBW),a.maxAudioBW=f.maxAudioBW),k=d.a.SDPInfo.processString(g.sdp),e.setMaxBW(k,a),g.sdp=k.toString(),c.localSdp=k,f.Sdp||f.maxAudioBW?(b.a.debug("Updating with SDP renegotiation",a.maxVideoBW,a.maxAudioBW),c.peerConnection.setLocalDescription(g).then(function(){return l=d.a.SDPInfo.processString(h.sdp),e.setMaxBW(l,a),h.sdp=l.toString(),c.remoteSdp=
l,c.peerConnection.setRemoteDescription(new RTCSessionDescription(h))}).then(function(){a.remoteDescriptionSet=!0;a.callback({type:"updatestream",sdp:g.sdp},t)}).catch(n.bind(null,"updateSpec",C))):(b.a.debug("Updating without SDP renegotiation, newVideoBW:",a.maxVideoBW,"newAudioBW:",a.maxAudioBW),a.callback({type:"updatestream",sdp:g.sdp},t)));(B||f.minVideoBW||void 0!==f.slideShowMode||void 0!==f.muteStream||void 0!==f.qualityLayer||void 0!==f.minLayer||void 0!==f.video)&&(b.a.debug("MaxVideoBW Changed to ",
f.maxVideoBW),b.a.debug("MinVideo Changed to ",f.minVideoBW),b.a.debug("SlideShowMode Changed to ",f.slideShowMode),b.a.debug("muteStream changed to ",f.muteStream),b.a.debug("Video Constraints",f.video),a.callback({type:"updatestream",config:f},t))},c.createOffer=function(t,h,C){t=void 0===t?!1:t;h=void 0===h?!1:h;C=void 0===C?"":C;t||h||(c.mediaConstraints={offerToReceiveVideo:!1,offerToReceiveAudio:!1});B?f.push(["local",t,h,C]):(B=!0,b.a.debug("Creating offer",c.mediaConstraints,C),c.peerConnection.createOffer(c.mediaConstraints).then(function(b,
f,t){g=t;b||(g.sdp=c.enableSimulcast(g.sdp));k=d.a.SDPInfo.processString(g.sdp);e.setMaxBW(k,a);g.sdp=k.toString();c.localSdp=k;a.callback({type:g.type,sdp:g.sdp,config:{maxVideoBW:a.maxVideoBW}},f)}.bind(null,t,C)).catch(n.bind(null,"Create Offer",void 0)))},c.addStream=function(a){c.peerConnection.addStream(a)},c.removeStream=function(a){c.peerConnection.removeStream(a)},c.processSignalingMessage=function(f){"offer"===f.type?r(f):"answer"===f.type?function(f){var t=(l=d.a.SDPInfo.processString(f.sdp))&&
l.origin&&l.origin.sessionVersion;m>=t||(b.a.info("Set remote and local description"),m=t,e.setMaxBW(l,a),c.setStartVideoBW(l),c.setHardMinVideoBW(l),f.sdp=l.toString(),b.a.debug("Remote Description",f.sdp),b.a.debug("Local Description",g.sdp),c.remoteSdp=l,h=f,c.peerConnection.setLocalDescription(g).then(function(){c.peerConnection.setRemoteDescription(new RTCSessionDescription(f)).then(function(){a.remoteDescriptionSet=!0;for(b.a.info("Candidates to be added: ",a.remoteCandidates.length,a.remoteCandidates);0<
a.remoteCandidates.length;)c.peerConnection.addIceCandidate(a.remoteCandidates.shift());for(b.a.info("Local candidates to send:",a.localCandidates.length);0<a.localCandidates.length;)a.callback({type:"candidate",candidate:a.localCandidates.shift()});B=!1;p()}).catch(n.bind(null,"processAnswer",void 0))}).catch(n.bind(null,"processAnswer",void 0)))}(f):"candidate"===f.type&&function(d){try{var e;if("end"!==(e="object"==typeof d.candidate?d.candidate:JSON.parse(d.candidate)).candidate){e.candidate=
e.candidate.replace(/a=/g,"");e.sdpMLineIndex=parseInt(e.sdpMLineIndex,10);var f=new RTCIceCandidate(e);a.remoteDescriptionSet?c.peerConnection.addIceCandidate(f):a.remoteCandidates.push(f)}}catch(P){b.a.error("Error parsing candidate",d.candidate)}}(f)},c},w=function(c){b.a.info("Starting Chrome stable stack",c);var d=a(c);return d.enableSimulcast=function(a){var b=a;if(!d.simulcast)return b;a=b.match(/a=ssrc-group:FID ([0-9]*) ([0-9]*)\r?\n/);if(!a||0>=a.length)return b;var c=d.simulcast.numSpatialLayers||
2;var f=parseInt(a[1],10),g=parseInt(a[2],10),t=b.match(new RegExp("a\x3dssrc:"+a[1]+" cname:(.*)\r?\n"))[1],h=b.match(new RegExp("a\x3dssrc:"+a[1]+" msid:(.*)\r?\n"))[1],C=b.match(new RegExp("a\x3dssrc:"+a[1]+" mslabel:(.*)\r?\n"))[1],k=b.match(new RegExp("a\x3dssrc:"+a[1]+" label:(.*)\r?\n"))[1];b.match(new RegExp("a\x3dssrc:"+a[1]+".*\r?\n","g")).forEach(function(a){b=b.replace(a,"")});b.match(new RegExp("a\x3dssrc:"+a[2]+".*\r?\n","g")).forEach(function(a){b=b.replace(a,"")});for(var l=[f],B=
[g],m=1;m<c;m+=1)l.push(f+1E3*m),B.push(g+1E3*m);c=e.addSim(l);for(m=0;m<l.length;m+=1)f=l[m],g=B[m],c+=e.addGroup(f,g);for(m=0;m<l.length;m+=1)f=l[m],g=B[m],c+=e.addSpatialLayer(t,h,C,k,f,g);return c+="a\x3dx-google-flag:conference\r\n",b.replace(a[0],c)},d.setStartVideoBW=function(a){d.video&&c.startVideoBW&&(b.a.debug("startVideoBW requested: "+c.startVideoBW),e.setParamForCodecs(a,"video","x-google-start-bitrate",c.startVideoBW))},d.setHardMinVideoBW=function(a){d.video&&c.hardMinVideoBW&&(b.a.debug("hardMinVideoBW requested: "+
c.hardMinVideoBW),e.setParamForCodecs(a,"video","x-google-min-bitrate",c.hardMinVideoBW))},d},g=function(c){b.a.info("Starting Firefox stack");var d=a(c),f=[{rid:"low",scaleResolutionDownBy:3},{rid:"med",scaleResolutionDownBy:2},{rid:"high"}],e=function(){if(!d.simulcast)return[];var a=[];return d.peerConnection.getSenders().forEach(function(b){"video"===b.track.kind&&a.push(function(a){var b=d.simulcast.numSpatialLayers||2,c=f.length;b=b<c?b:c;var e=a.getParameters()||{};e.encodings=[];for(var g=
c-1;g>=c-b;--g)e.encodings.push(f[g]);return a.setParameters(e)}(b))}),a};d.enableSimulcast=function(a){return a};var g=d.createOffer;return d.createOffer=function(a,b,c){b=void 0===b?!1:b;c=void 0===c?"":c;var d=[];!0!==a&&(d=e());Promise.all(d).then(function(){g(a,b,c)})},d},c=function(a){var c={pcConfig:{},peerConnection:{},desc:{},signalCallback:void 0,close:function(){b.a.info("Close FcStack")},createOffer:function(){b.a.debug("FCSTACK: CreateOffer")},addStream:function(a){b.a.debug("FCSTACK: addStream",
a)},processSignalingMessage:function(a){b.a.debug("FCSTACK: processSignaling",a);void 0!==c.signalCallback&&c.signalCallback(a)},sendSignalingMessage:function(c){b.a.debug("FCSTACK: Sending signaling Message",c);a.callback(c)},setSignalingCallback:function(a){a=void 0===a?function(){}:a;b.a.debug("FCSTACK: Setting signalling callback");c.signalCallback=a}};return c},f=function(){var a={},c={};return a.addEventListener=function(a,b){void 0===c[a]&&(c[a]=[]);c[a].push(b)},a.removeEventListener=function(a,
b){c[a]&&(b=c[a].indexOf(b),-1!==b&&c[a].splice(b,1))},a.removeAllListeners=function(){c={}},a.dispatchEvent=function(a){if(!a||!a.type)throw Error("Undefined event");b.a.debug("Event: "+a.type);for(var d=c[a.type]||[],e=0;e<d.length;e+=1)d[e](a)},a.on=a.addEventListener,a.off=a.removeEventListener,a.emit=a.dispatchEvent,a},q=function(a){var b={};return b.type=a.type,b},l=function(a){var b=q(a);return b.stream=a.stream,b.state=a.state,b},u=function(a){var b=q(a);return b.streams=a.streams,b.message=
a.message,b},y=function(a){var b=q(a);return b.stream=a.stream,b.msg=a.msg,b.bandwidth=a.bandwidth,b.attrs=a.attrs,b},x=function(){var a={},b={};return a.add=function(a,c){b[a]=c},a.get=function(a){return b[a]},a.has=function(a){return void 0!==b[a]},a.size=function(){return Object.keys(b).length},a.forEach=function(a){for(var c=Object.keys(b),d=0;d<c.length;d+=1){var e=c[d];a(b[e],e)}},a.keys=function(){return Object.keys(b)},a.remove=function(a){delete b[a]},a.clear=function(){b={}},a},m=h(2);k=
function(){this.emitter=f()};k.prototype.addEventListener=function(a,b){this.emitter.addEventListener(a,b)};k.prototype.removeEventListener=function(a,b){this.emitter.removeEventListener(a,b)};k.prototype.dispatchEvent=function(a){this.emitter.dispatchEvent(a)};k.prototype.on=function(a,b){this.addEventListener(a,b)};k.prototype.off=function(a,b){this.removeEventListener(a,b)};k.prototype.emit=function(a){this.dispatchEvent(a)};var r=103,p=function(a,d){this.emitter=f();b.a.debug("Building a new Connection");
this.stack={};this.erizoId=d;this.streamsMap=x();var e=this;if(r+=1,a.sessionId=r,this.sessionId=r,this.browser=m.a.getBrowser(),"fake"===this.browser)b.a.warning("Publish/subscribe video/audio streams not supported in erizofc yet"),this.stack=c(a);else if("mozilla"===this.browser)b.a.debug("Firefox Stack"),this.stack=g(a);else{if("safari"===this.browser)b.a.debug("Safari using Chrome Stable Stack");else{if("chrome-stable"!==this.browser&&"electron"!==this.browser)throw b.a.error("No stack available for this browser"),
Error("WebRTC stack not available");b.a.debug("Chrome Stable Stack")}this.stack=w(a)}this.stack.updateSpec||(this.stack.updateSpec=function(a,c){c=void 0===c?function(){}:c;b.a.error("Update Configuration not implemented in this browser");c("unimplemented")});this.stack.setSignallingCallback||(this.stack.setSignallingCallback=function(){b.a.error("setSignallingCallback is not implemented in this stack")});this.stack.peerConnection&&(this.peerConnection=this.stack.peerConnection,this.stack.peerConnection.onaddstream=
function(a){e.emit(l({type:"add-stream",stream:a.stream}))},this.stack.peerConnection.onremovestream=function(a){e.emit(l({type:"remove-stream",stream:a.stream}))},this.stack.peerConnection.oniceconnectionstatechange=function(){e.emit(l({type:"ice-state-change",state:e.stack.peerConnection.iceConnectionState}))});return this};$jscomp.inherits(p,k);p.prototype.close=function(){b.a.debug("Closing ErizoConnection");this.streamsMap.clear();this.stack.close()};p.prototype.createOffer=function(a,b,c){this.stack.createOffer(a,
b,c)};p.prototype.addStream=function(a){b.a.debug("message: Adding stream to Connection, streamId: "+a.getID());this.streamsMap.add(a.getID(),a);a.local&&this.stack.addStream(a.stream)};p.prototype.removeStream=function(a){var c=a.getID();this.streamsMap.has(c)?(a.local&&this.stack.removeStream(a.stream),this.streamsMap.remove(c)):b.a.warning("message: Cannot remove stream not in map, streamId: "+c)};p.prototype.processSignalingMessage=function(a){this.stack.processSignalingMessage(a)};p.prototype.sendSignalingMessage=
function(a){this.stack.sendSignalingMessage(a)};p.prototype.setSimulcast=function(a){this.stack.setSimulcast(a)};p.prototype.setVideo=function(a){this.stack.setVideo(a)};p.prototype.setAudio=function(a){this.stack.setAudio(a)};p.prototype.updateSpec=function(a,b,c){this.stack.updateSpec(a,b,c)};var z=function(){this.ErizoConnectionsMap=new Map};k=h(19);var A=h.n(k);z.prototype.getOrBuildErizoConnection=function(a,c,d){d=void 0===d?!1:d;b.a.debug("message: getOrBuildErizoConnection, erizoId: "+c);
if(void 0===c)return new p(a);if(d){var e;this.ErizoConnectionsMap.has(c)?e=this.ErizoConnectionsMap.get(c):(e={},this.ErizoConnectionsMap.set(c,e));e["single-pc"]||(e["single-pc"]=new p(a,c));d=e["single-pc"]}else(d=new p(a,c),this.ErizoConnectionsMap.has(c))?this.ErizoConnectionsMap.get(c)[d.sessionId]=d:(e={},e[d.sessionId]=d,this.ErizoConnectionsMap.set(c,e));return a.simulcast&&d.setSimulcast(a.simulcast),a.video&&d.setVideo(a.video),a.audio&&d.setVideo(a.audio),d};z.prototype.maybeCloseConnection=
function(a){b.a.debug("Trying to remove connection "+a.sessionId+"\n       with erizoId "+a.erizoId);0===a.streamsMap.size()&&(a.close(),void 0!==this.ErizoConnectionsMap.get(a.erizoId)&&delete this.ErizoConnectionsMap.get(a.erizoId)[a.sessionId])};var v=function(a){var c=f(),d=function(){},e=[];$jscomp.initSymbol();$jscomp.initSymbol();$jscomp.initSymbol();c.CONNECTED=Symbol("connected");c.RECONNECTING=Symbol("reconnecting");c.DISCONNECTED=Symbol("disconnected");var g;c.state=c.DISCONNECTED;c.IO=
void 0===a?A.a:a;var h=function(a,b){for(var d=[],e=1;e<arguments.length;++e)d[e-1]=arguments[e];c.emit(function(a,b){a=q({type:a});return a.args=b.args,a}(a,{args:d}))};return c.connect=function(a,f,t,k){t=void 0===t?d:t;k=void 0===k?d:k;var l=1E3,C=(g=c.IO.connect((a.secure?"wss://":"ws://")+a.host,{reconnection:!0,reconnectionAttempts:3,secure:a.secure,forceNew:!0,transports:["websocket"],rejectUnauthorized:!1})).io.engine.transport.ws.onclose;g.io.engine.transport.ws.onclose=function(a){b.a.warning("WebSocket closed, code:",
a.code);l=a.code;C(a)};c.socket=g;g.on("onAddStream",h.bind(c,"onAddStream"));g.on("signaling_message_erizo",h.bind(c,"signaling_message_erizo"));g.on("signaling_message_peer",h.bind(c,"signaling_message_peer"));g.on("publish_me",h.bind(c,"publish_me"));g.on("unpublish_me",h.bind(c,"unpublish_me"));g.on("onBandwidthAlert",h.bind(c,"onBandwidthAlert"));g.on("onDataStream",h.bind(c,"onDataStream"));g.on("onUpdateAttributeStream",h.bind(c,"onUpdateAttributeStream"));g.on("onRemoveStream",h.bind(c,"onRemoveStream"));
g.on("disconnect",function(a){b.a.debug("disconnect",c.id,a);1E3===l?(h("disconnect",a),g.close()):c.state=c.RECONNECTING});g.on("connection_failed",function(a){b.a.error("connection failed, id:",c.id);h("connection_failed",a)});g.on("error",function(a){b.a.warning("socket error, id:",c.id,", error:",a.message);h("error")});g.on("connect_error",function(a){b.a.warning("connect error, id:",c.id,", error:",a.message)});g.on("connect_timeout",function(a){b.a.warning("connect timeout, id:",c.id,", error:",
a.message)});g.on("reconnecting",function(a){b.a.debug("reconnecting, id:",c.id,", attempet:",a)});g.on("reconnect",function(a){b.a.debug("reconnected, id:",c.id,", attempet:",a);c.state=c.CONNECTED;g.emit("reconnected",c.id);c.state===c.CONNECTED&&e.forEach(function(a){c.sendMessage.apply(c,$jscomp.arrayFromIterable(a))})});g.on("reconnect_attempt",function(a){b.a.debug("reconnect attempt, id:",c.id,", attempet:",a)});g.on("reconnect_error",function(a){b.a.debug("error reconnecting, id:",c.id,", error:",
a.message)});g.on("reconnect_failed",function(){b.a.warning("reconnect failed, id:",c.id);c.state=c.DISCONNECTED;h("disconnect","reconnect failed")});f.token=a;c.sendMessage("token",f,function(a){c.state=c.CONNECTED;c.id=a.clientId;t(a)},k)},c.disconnect=function(){c.state=c.DISCONNECTED;g.disconnect()},c.sendMessage=function(a,f,h,t){h=void 0===h?d:h;t=void 0===t?d:t;c.state!==c.DISCONNECTED||"token"===a?c.state!==c.RECONNECTING?g.emit(a,f,function(a,b){"success"===a?h(b):"error"===a?t(b):h(a,b)}):
e.push([a,f,h,t]):b.a.error("Trying to send a message over a disconnected Socket")},c.sendSDP=function(a,e,f,h){h=void 0===h?d:h;c.state!==c.DISCONNECTED?g.emit(a,e,f,function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];h.apply(null,$jscomp.arrayFromIterable(b))}):b.a.error("Trying to send a message over a disconnected Socket")},c},D=function(){var a=f({});return a.url="",a},H=function(a){var b=D({}),c=50;if(b.elementID=a.elementID,b.media=a.media,b.id=a.id,b.stream=a.stream,b.div=
document.createElement("div"),b.div.setAttribute("style","width: 40%; height: 100%; max-width: 32px; position: absolute; right: 0;z-index:0;"),b.icon=document.createElement("img"),b.icon.setAttribute("id","volume_"+b.id),b.icon.setAttribute("src",b.url+"/assets/sound48.png"),b.icon.setAttribute("style","width: 80%; height: 100%; position: absolute;"),b.div.appendChild(b.icon),b.icon.onclick=function(){b.media.muted?(b.media.muted=!1,b.icon.setAttribute("src",b.url+"/assets/sound48.png"),b.stream.local?
b.stream.stream.getAudioTracks()[0].enabled=!0:(b.picker.value=c,b.media.volume=b.picker.value/100)):(b.media.muted=!0,b.icon.setAttribute("src",b.url+"/assets/mute48.png"),b.stream.local?b.stream.stream.getAudioTracks()[0].enabled=!1:(c=b.picker.value,b.picker.value=0,b.media.volume=0))},!b.stream.local){b.picker=document.createElement("input");b.picker.setAttribute("id","picker_"+b.id);b.picker.type="range";b.picker.min=0;b.picker.max=100;b.picker.step=10;b.picker.value=c;b.picker.setAttribute("orient",
"vertical");b.div.appendChild(b.picker);b.media.volume=b.picker.value/100;b.media.muted=!1;b.picker.oninput=function(){0<b.picker.value?(b.media.muted=!1,b.icon.setAttribute("src",b.url+"/assets/sound48.png")):(b.media.muted=!0,b.icon.setAttribute("src",b.url+"/assets/mute48.png"));b.media.volume=b.picker.value/100};var d=function(a){b.picker.setAttribute("style","background: transparent; width: 32px;\n                                         height: 100px; position: absolute; bottom: 90%;\n                                         z-index: 1; right: 0px; -webkit-appearance: slider-vertical;\n                                         bottom: "+
b.div.offsetHeight+"px; display: "+a)};b.div.onmouseover=function(){d("block")};b.div.onmouseout=function(){d("none")};d("none")}return document.getElementById(b.elementID).appendChild(b.div),b},I=function(a){var b=D({}),c;b.elementID=a.elementID;b.id=a.id;b.div=document.createElement("div");b.div.setAttribute("id","bar_"+b.id);b.div.setAttribute("class","licode_bar");b.bar=document.createElement("div");b.bar.setAttribute("style","width: 100%; height: 15%; max-height: 30px; position: absolute; bottom: 0; right: 0; background-color: rgba(255,255,255,0.62)");
b.bar.setAttribute("id","subbar_"+b.id);b.bar.setAttribute("class","licode_subbar");b.link=document.createElement("a");b.link.setAttribute("href","http://www.lynckia.com/");b.link.setAttribute("class","licode_link");b.link.setAttribute("target","_blank");b.logo=document.createElement("img");b.logo.setAttribute("style","width: 100%; height: 100%; max-width: 30px; position: absolute; top: 0; left: 2px;");b.logo.setAttribute("class","licode_logo");b.logo.setAttribute("alt","Lynckia");b.logo.setAttribute("src",
b.url+"/assets/star.svg");var d=function(a){var d=a;"block"!==a?d="none":clearTimeout(c);b.div.setAttribute("style","width: 100%; height: 100%; position: relative; bottom: 0; right: 0; display: "+d)};return b.display=function(){d("block")},b.hide=function(){c=setTimeout(d,1E3)},document.getElementById(b.elementID).appendChild(b.div),b.div.appendChild(b.bar),b.bar.appendChild(b.link),b.link.appendChild(b.logo),a.stream.screen||void 0!==a.options&&void 0!==a.options.speaker&&!0!==a.options.speaker||
(b.speaker=H({elementID:"subbar_"+b.id,id:b.id,stream:a.stream,media:a.media})),b.display(),b.hide(),b},E=function(a){var b=D({});b.id=a.id;b.stream=a.stream.stream;b.elementID=a.elementID;var c=function(){b.bar.display()},d=function(){b.bar.hide()},e=function(a,c,d,e){(e?1/a*c>d:1/a*c<d)?(b.video.style.width=c+"px",b.video.style.height=1/a*c+"px",b.video.style.top=-(1/a*c/2-d/2)+"px",b.video.style.left="0px"):(b.video.style.height=d+"px",b.video.style.width=a*d+"px",b.video.style.left=-(a*d/2-c/
2)+"px",b.video.style.top="0px")};return b.destroy=function(){b.video.pause();delete b.resizer;b.parentNode.removeChild(b.div)},b.resize=function(){var c=b.container.offsetWidth,d=b.container.offsetHeight;a.stream.screen||!1===a.options.crop?e(16/9,c,d,!1):c===b.containerWidth&&d===b.containerHeight||e(4/3,c,d,!0);b.containerWidth=c;b.containerHeight=d},b.div=document.createElement("div"),b.div.setAttribute("id","player_"+b.id),b.div.setAttribute("class","licode_player"),b.div.setAttribute("style",
"width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;"),!1!==a.options.loader&&(b.loader=document.createElement("img"),b.loader.setAttribute("style","width: 16px; height: 16px; position: absolute; top: 50%; left: 50%; margin-top: -8px; margin-left: -8px"),b.loader.setAttribute("id","back_"+b.id),b.loader.setAttribute("class","licode_loader"),b.loader.setAttribute("src",b.url+"/assets/loader.gif")),b.video=document.createElement("video"),b.video.setAttribute("id",
"stream"+b.id),b.video.setAttribute("class","licode_stream"),b.video.setAttribute("style","width: 100%; height: 100%; position: absolute"),b.video.setAttribute("autoplay","autoplay"),b.video.setAttribute("playsinline","playsinline"),a.stream.local&&(b.video.volume=0),void 0!==b.elementID?"object"==typeof b.elementID&&"function"==typeof b.elementID.appendChild?b.container=b.elementID:b.container=document.getElementById(b.elementID):b.container=document.body,b.container.appendChild(b.div),b.parentNode=
b.div.parentNode,b.loader&&b.div.appendChild(b.loader),b.div.appendChild(b.video),b.containerWidth=0,b.containerHeight=0,!1!==a.options.resizer&&(b.resizer=L.ResizeSensor(b.container,b.resize),b.resize()),!1!==a.options.bar?(b.bar=I({elementID:"player_"+b.id,id:b.id,stream:a.stream,media:b.video,options:a.options}),b.div.onmouseover=c,b.div.onmouseout=d):b.media=b.video,b.video.srcObject=b.stream,b},O=function(a){var b=D({}),c,d;return b.id=a.id,b.stream=a.stream.stream,b.elementID=a.elementID,b.audio=
document.createElement("audio"),b.audio.setAttribute("id","stream"+b.id),b.audio.setAttribute("class","licode_stream"),b.audio.setAttribute("style","width: 100%; height: 100%; position: absolute"),b.audio.setAttribute("autoplay","autoplay"),a.stream.local&&(b.audio.volume=0),void 0!==b.elementID?(b.destroy=function(){b.audio.pause();b.parentNode.removeChild(b.div)},c=function(){b.bar.display()},d=function(){b.bar.hide()},b.div=document.createElement("div"),b.div.setAttribute("id","player_"+b.id),
b.div.setAttribute("class","licode_player"),b.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;"),"object"==typeof b.elementID&&"function"==typeof b.elementID.appendChild?b.container=b.elementID:b.container=document.getElementById(b.elementID),b.container.appendChild(b.div),b.parentNode=b.div.parentNode,b.div.appendChild(b.audio),!1!==a.options.bar?(b.bar=I({elementID:"player_"+b.id,id:b.id,stream:a.stream,media:b.audio,options:a.options}),b.div.onmouseover=
c,b.div.onmouseout=d):b.media=b.audio):(b.destroy=function(){b.audio.pause();b.parentNode.removeChild(b.audio)},document.body.appendChild(b.audio),b.parentNode=document.body),b.audio.srcObject=b.stream,b},K=function(a,c){var d=f(c);d.stream=c.stream;d.url=c.url;d.recording=c.recording;d.room=void 0;d.showing=!1;d.local=!1;d.video=c.video;d.audio=c.audio;d.screen=c.screen;d.videoSize=c.videoSize;d.videoFrameRate=c.videoFrameRate;d.extensionId=c.extensionId;d.desktopStreamId=c.desktopStreamId;d.audioMuted=
!1;d.videoMuted=!1;d.p2p=!1;d.ConnectionHelpers=void 0===a?m.a:a;var e=function(a){a.stream.id===d.getLabel()&&d.emit(y({type:"added",stream:a.stream}))},g=function(a){a.stream.id===d.getLabel()&&d.emit(y({type:"removed",stream:d}))},h=function(a){d.emit(y({type:"icestatechanged",msg:a}))};if(!(void 0===d.videoSize||d.videoSize instanceof Array&&4===d.videoSize.length))throw Error("Invalid Video Size");void 0!==c.local&&!0!==c.local||(d.local=!0);d.getID=function(){return d.local&&!c.streamID?"local":
c.streamID};d.getLabel=function(){return d.stream&&d.stream.id?d.stream.id:c.label};d.getAttributes=function(){return c.attributes};d.setAttributes=function(a){d.local?d.emit(y({type:"internal-set-attributes",stream:d,attrs:a})):b.a.error("Failed to set attributes data. This Stream object has not been published.")};d.updateLocalAttributes=function(a){c.attributes=a};d.hasAudio=function(){return!1!==c.audio&&void 0!==c.audio};d.hasVideo=function(){return!1!==c.video&&void 0!==c.video};d.hasData=function(){return!1!==
c.data&&void 0!==c.data};d.hasScreen=function(){return c.screen};d.hasMedia=function(){return c.audio||c.video||c.screen};d.isExternal=function(){return void 0!==d.url||void 0!==d.recording};d.addPC=function(a,b){if(b)return d.p2p=!0,void 0===d.pc&&(d.pc=x()),d.pc.add(b,a),void a.on("ice-state-change",h);d.pc&&(d.pc.off("add-stream",e),d.pc.off("remove-stream",g),d.pc.off("ice-state-change",h));d.pc=a;d.pc.on("add-stream",e);d.pc.on("remove-stream",g);d.pc.on("ice-state-change",h)};d.sendData=function(a){d.local&&
d.hasData()?d.emit(y({type:"internal-send-data",stream:d,msg:a})):b.a.error("Failed to send data. This Stream object has not been published.")};d.init=function(){try{if((c.audio||c.video||c.screen)&&void 0===c.url){b.a.info("Requested access to local media");var a=c.video;!0===a||!0===c.screen?(a=!0===a?{}:a,void 0!==d.videoSize&&(a.width={min:d.videoSize[0],max:d.videoSize[2]},a.height={min:d.videoSize[1],max:d.videoSize[3]}),void 0!==d.videoFrameRate&&(a.frameRate={min:d.videoFrameRate[0],max:d.videoFrameRate[1]})):
!0===c.screen&&void 0===a&&(a=!0);d.ConnectionHelpers.GetUserMedia({video:a,audio:c.audio,fake:c.fake,screen:c.screen,extensionId:d.extensionId,desktopStreamId:d.desktopStreamId},function(a){b.a.info("User has granted access to local media.");d.stream=a;d.dispatchEvent(y({type:"access-accepted"}));d.stream.getTracks().forEach(function(a){b.a.info("getTracks",a);a.onended=function(){d.stream.getTracks().forEach(function(a){a.onended=null});var b=y({type:"stream-ended",stream:d,msg:a.kind});d.dispatchEvent(b)}})},
function(a){b.a.error("Failed to get access to local media. Error code was "+a.code+".");a=y({type:"access-denied",msg:a});d.dispatchEvent(a)})}else{var e=y({type:"access-accepted"});d.dispatchEvent(e)}}catch(N){b.a.error("Failed to get access to local media. Error was "+N+"."),a=y({type:"access-denied",msg:N}),d.dispatchEvent(a)}};d.close=function(){d.local&&(void 0!==d.room&&d.room.unpublish(d),d.hide(),void 0!==d.stream&&d.stream.getTracks().forEach(function(a){a.onended=null;a.stop()}),d.stream=
void 0);d.pc&&!d.p2p?(d.pc.off("add-stream",e),d.pc.off("remove-stream",g),d.pc.off("ice-state-change",h)):d.pc&&d.p2p&&d.pc.forEach(function(a){a.off("add-stream",e);a.off("remove-stream",g);a.off("ice-state-change",h)})};d.play=function(a,b){b=b||{};var c;d.elementID=a;d.hasVideo()||d.hasScreen()?void 0!==a&&(c=E({id:d.getID(),stream:d,elementID:a,options:b}),d.player=c,d.showing=!0):d.hasAudio()&&(c=O({id:d.getID(),stream:d,elementID:a,options:b}),d.player=c,d.showing=!0)};d.stop=function(){d.showing&&
void 0!==d.player&&(d.player.destroy(),d.showing=!1)};d.show=d.play;d.hide=d.stop;var k=function(){if(void 0!==d.player&&void 0!==d.stream){var a=d.player.video,b=document.defaultView.getComputedStyle(a),c=parseInt(b.getPropertyValue("width"),10),e=parseInt(b.getPropertyValue("height"),10),f=parseInt(b.getPropertyValue("left"),10);b=parseInt(b.getPropertyValue("top"),10);var g="object"==typeof d.elementID&&"function"==typeof d.elementID.appendChild?d.elementID:document.getElementById(d.elementID);
var h=document.defaultView.getComputedStyle(g);g=parseInt(h.getPropertyValue("width"),10);h=parseInt(h.getPropertyValue("height"),10);var k=document.createElement("canvas");return k.id="testing",k.width=g,k.height=h,k.setAttribute("style","display: none"),k.getContext("2d").drawImage(a,f,b,c,e),k}return null};d.getVideoFrameURL=function(a){var b=k();return null!==b?a?b.toDataURL(a):b.toDataURL():null};d.getVideoFrame=function(){var a=k();return null!==a?a.getContext("2d").getImageData(0,0,a.width,
a.height):null};d.checkOptions=function(a,c){!0===c?(a.audio||a.screen)&&(b.a.warning("Cannot update type of subscription"),a.audio=void 0,a.screen=void 0):!1===d.local&&(!0===a.video&&!1===d.hasVideo()&&(b.a.warning("Trying to subscribe to video when there is no video, won't subscribe to video"),a.video=!1),!0===a.audio&&!1===d.hasAudio()&&(b.a.warning("Trying to subscribe to audio when there is no audio, won't subscribe to audio"),a.audio=!1));!1===d.local&&(d.hasVideo()||!0!==a.slideShowMode||
(b.a.warning("Cannot enable slideShowMode if it is not a video subscription, please check your parameters"),a.slideShowMode=!1))};var l=function(a){a=void 0===a?function(){}:a;if(d.room&&d.room.p2p)return b.a.warning("muteAudio/muteVideo are not implemented in p2p streams"),void a("error");if(d.stream)for(var c=0;c<d.stream.getVideoTracks().length;c+=1)d.stream.getVideoTracks()[c].enabled=!d.videoMuted;c={muteStream:{audio:d.audioMuted,video:d.videoMuted}};d.checkOptions(c,!0);d.pc&&d.pc.updateSpec(c,
d.getID(),a)};d.muteAudio=function(a,b){d.audioMuted=a;l(void 0===b?function(){}:b)};d.muteVideo=function(a,b){d.videoMuted=a;l(void 0===b?function(){}:b)};d._setStaticQualityLayer=function(a,c,e){e=void 0===e?function(){}:e;if(d.room&&d.room.p2p)return b.a.warning("setStaticQualityLayer is not implemented in p2p streams"),void e("error");a={qualityLayer:{spatialLayer:a,temporalLayer:c}};d.checkOptions(a,!0);d.pc.updateSpec(a,d.getID(),e)};d._setDynamicQualityLayer=function(a){if(d.room&&d.room.p2p)return b.a.warning("setDynamicQualityLayer is not implemented in p2p streams"),
void a("error");var c={qualityLayer:{spatialLayer:-1,temporalLayer:-1}};d.checkOptions(c,!0);d.pc.updateSpec(c,d.getID(),a)};d._setMinSpatialLayer=function(a,c){c=void 0===c?function(){}:c;if(d.room&&d.room.p2p)return b.a.warning("setMinSpatialLayer is not implemented in p2p streams"),void c("error");a={minLayer:{spatialLayer:a}};d.checkOptions(a,!0);b.a.debug("Calling updateSpec with config",a);d.pc.updateSpec(a,d.getID(),c)};var n=function(a,b,c){!0!==b&&(b=!1);0<(a=(a="string"==typeof a?[a]:a)instanceof
Array?a:[]).length&&d.room.sendControlMessage(d,"control",{name:"controlhandlers",enable:c,publisherSide:b,handlers:a})};return d.disableHandlers=function(a,b){n(a,b,!1)},d.enableHandlers=function(a,b){n(a,b,!0)},d.updateConfiguration=function(a,b){b=void 0===b?function(){}:b;if(void 0!==a)if(d.pc)if(d.checkOptions(a,!0),d.local)if(d.room.p2p)for(var c=0;c<d.pc.length;c+=1)d.pc[c].updateSpec(a,d.getID(),b);else d.pc.updateSpec(a,d.getID(),b);else d.pc.updateSpec(a,d.getID(),b);else b("This stream has no peerConnection attached, ignoring")},
d},J=function(){for(var a,b,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),d=[],e=0;e<c.length;e+=1)d[c[e]]=e;var f=function(){if(!a||b>=a.length)return-1;var c=255&a.charCodeAt(b);return b+=1,c},g=function(){if(!a)return-1;for(;;){if(b>=a.length)return-1;var c=a.charAt(b);if(b+=1,d[c])return d[c];if("A"===c)return 0}},h=function(a){a=a.toString(16);return 1===a.length&&(a="0"+a),a="%"+a,unescape(a)};return{encodeBase64:function(d){var e;a=d;b=0;d="";var g=Array(3);
var h=0;for(e=!1;!e&&-1!==(g[0]=f());)g[1]=f(),g[2]=f(),d+=c[g[0]>>2],-1!==g[1]?(d+=c[g[0]<<4&48|g[1]>>4],-1!==g[2]?(d+=c[g[1]<<2&60|g[2]>>6],d+=c[63&g[2]]):(d=(d+=c[g[1]<<2&60])+"\x3d",e=!0)):(d=(d=(d+=c[g[0]<<4&48])+"\x3d")+"\x3d",e=!0),76<=(h+=4)&&(d+="\n",h=0);return d},decodeBase64:function(c){var d;a=c;b=0;c="";var e=Array(4);for(d=!1;!d&&-1!==(e[0]=g())&&-1!==(e[1]=g());)e[2]=g(),e[3]=g(),c+=h(e[0]<<2&255|e[1]>>4),-1!==e[2]?(c+=h(e[1]<<4&255|e[2]>>2),-1!==e[3]?c+=h(e[2]<<6&255|e[3]):d=!0):
d=!0;return c}}}();h(28);h(30);h={Room:function(a,c,d,e){var g=f(e);g.remoteStreams=x();g.localStreams=x();g.roomID="";g.state=0;g.p2p=!1;g.ConnectionHelpers=void 0===c?m.a:c;g.erizoConnectionManager=void 0===d?new z:new d.ErizoConnectionManager;var h=v(a);g.socket=h;var k=g.remoteStreams,l=g.localStreams,n=function(a){a.removeAllListeners();a.pc&&!g.p2p&&a.pc.removeStream(a);b.a.debug("Removed stream");a.stream&&(a.hide(),a.stop(),a.close(),delete a.stream);a.pc&&(a.local&&g.p2p?a.pc.forEach(function(b,
c){b.close();a.pc.remove(c)}):(g.erizoConnectionManager.maybeCloseConnection(a.pc),delete a.pc))},p=function(a,b){0!==g.state&&a&&!a.failed&&(a.failed=!0,b=y({type:"stream-failed",msg:b||"Stream failed after connection",stream:a}),g.dispatchEvent(b),a.local?g.unpublish(a):g.unsubscribe(a))},q=function(a,c){b.a.info("Stream subscribed");a.stream=c.stream;g.p2p||a.pc.addStream(a);a=y({type:"stream-subscribed",stream:a});g.dispatchEvent(a)},r=function(a,b){return{callback:function(c){h.sendSDP("signaling_message",
{streamId:a.getID(),peerSocket:b,msg:c})},audio:a.hasAudio(),video:a.hasVideo(),iceServers:g.iceServers,maxAudioBW:a.maxAudioBW,maxVideoBW:a.maxVideoBW,limitMaxAudioBW:e.maxAudioBW,limitMaxVideoBW:e.maxVideoBW,forceTurn:a.forceTurn,p2p:!0}},t=function(a,c,d){var f={callback:function(c,d){d=void 0===d?a.getID():d;b.a.info("Sending message",c,a.getID(),d);h.sendSDP("signaling_message",{streamId:d,msg:c,browser:a.pc&&a.pc.browser},void 0,function(){})},nop2p:!0,audio:c.audio&&a.hasAudio(),video:c.video&&
a.hasVideo(),maxAudioBW:c.maxAudioBW,maxVideoBW:c.maxVideoBW,limitMaxAudioBW:e.maxAudioBW,limitMaxVideoBW:e.maxVideoBW,label:a.getLabel(),iceServers:g.iceServers,forceTurn:a.forceTurn,p2p:!1};return d||(f.simulcast=c.simulcast,f.startVideoBW=c.startVideoBW,f.hardMinVideoBW=c.hardMinVideoBW),f},w=function(a){var c=a.stream;a=a.msg;c.local?h.sendMessage("sendDataStream",{id:c.getID(),msg:a}):b.a.error("You can not send data through a remote stream")},B=function(a){var c=a.stream;a=a.attrs;c.local?(c.updateLocalAttributes(a),
h.sendMessage("updateStreamAttributes",{id:c.getID(),attrs:a})):b.a.error("You can not update attributes in a remote stream")};a=function(a,b){b.args?a.apply(null,$jscomp.arrayFromIterable(b.args)):a()};var A=function(a,b,c){return{state:a,data:b.hasData(),audio:b.hasAudio(),video:b.hasVideo(),label:b.getLabel(),screen:b.hasScreen(),attributes:b.getAttributes(),metadata:c.metadata,createOffer:c.createOffer,muteStream:c.muteStream}},C=function(a,c,d,e){e=void 0===e?function(){}:e;if(null===a)return b.a.error("Error when publishing the stream",
d),void e(void 0,d);b.a.info("Stream published");c.getID=function(){return a};c.on("internal-send-data",w);c.on("internal-set-attributes",B);l.add(a,c);c.room=g;e(a)},D=function(a,c,d){d=void 0===d?function(){}:d;b.a.info("Publishing to Erizo Normally, is createOffer",c.createOffer);var f=A("erizo",a,c);f.minVideoBW=c.minVideoBW;f.maxVideoBW=c.maxVideoBW;f.scheme=c.scheme;h.sendSDP("publish",f,void 0,function(f,h,k){if(null===f)return b.a.error("Error publishing stream",k),void d(void 0,k);C(f,a,
k,void 0);(function(a,c,d){a.addPC(g.erizoConnectionManager.getOrBuildErizoConnection(t(a,d),c,e.singlePC));a.on("icestatechanged",function(c){b.a.info(a.getID()+" - iceConnectionState: "+c.msg.state);"failed"===c.msg.state&&p(a)});a.pc.addStream(a);d.createOffer||a.pc.createOffer(!1,e.singlePC,a.getID())})(a,h,c);d(f)})},E=function(a,c,d){d=void 0===d?function(){}:d;c.maxVideoBW=c.maxVideoBW||e.defaultVideoBW;c.maxVideoBW>e.maxVideoBW&&(c.maxVideoBW=e.maxVideoBW);c.audio=void 0===c.audio||c.audio;
c.video=void 0===c.video||c.video;c.data=void 0===c.data||c.data;a.checkOptions(c);var f={streamId:a.getID(),audio:c.audio&&a.hasAudio(),video:function(a,b){a=b&&a.hasVideo();var c=b&&b.width,d=b&&b.height;b=b&&b.frameRate;return c||d||b?{width:c,height:d,frameRate:b}:a}(a,c.video),maxVideoBW:c.maxVideoBW,data:c.data&&a.hasData(),browser:g.ConnectionHelpers.getBrowser(),createOffer:c.createOffer,metadata:c.metadata,muteStream:c.muteStream,slideShowMode:c.slideShowMode};h.sendSDP("subscribe",f,void 0,
function(f,h,k){if(null===f)return b.a.error("Error subscribing to stream ",k),void d(void 0,k);b.a.info("Subscriber added");(function(a,c,d){a.addPC(g.erizoConnectionManager.getOrBuildErizoConnection(t(a,d,!0),c,e.singlePC));a.on("added",q.bind(null,a));a.on("icestatechanged",function(c){b.a.info(a.getID()+" - iceConnectionState: "+c.msg.state);"failed"===c.msg.state&&p(a)});a.pc.createOffer(!0,!1,a.getID())})(a,h,c);d(!0)})};return g.connect=function(a){a=void 0===a?{}:a;var c=J.decodeBase64(e.token);
0!==g.state&&b.a.warning("Room already connected");g.state=1;h.connect(JSON.parse(c),a,function(a){var c=[],d=a.streams||[],f=a.id;g.p2p=a.p2p;g.iceServers=a.iceServers;g.state=2;e.singlePC=a.singlePC;e.defaultVideoBW=a.defaultVideoBW;e.maxVideoBW=a.maxVideoBW;for(var h=Object.keys(d),l=0;l<h.length;l+=1){var m=d[h[l]];(a=K(g.ConnectionHelpers,{streamID:m.id,local:!1,audio:m.audio,video:m.video,data:m.data,label:m.label,screen:m.screen,attributes:m.attributes})).room=g;c.push(a);k.add(m.id,a)}g.roomID=
f;b.a.info("Connected to room "+g.roomID);c=u({type:"room-connected",streams:c});g.dispatchEvent(c)},function(a){b.a.error("Not Connected! Error: "+a);a=u({type:"room-error",message:a});g.dispatchEvent(a)})},g.disconnect=function(){b.a.debug("Disconnection requested");var a=u({type:"room-disconnected",message:"expected-disconnection"});g.dispatchEvent(a)},g.publish=function(a,c,d){c=void 0===c?{}:c;d=void 0===d?function(){}:d;c.maxVideoBW=c.maxVideoBW||e.defaultVideoBW;c.maxVideoBW>e.maxVideoBW&&
(c.maxVideoBW=e.maxVideoBW);void 0===c.minVideoBW&&(c.minVideoBW=0);c.minVideoBW>e.defaultVideoBW&&(c.minVideoBW=e.defaultVideoBW);a.forceTurn=c.forceTurn;c.simulcast=c.simulcast||!1;c.muteStream={audio:a.audioMuted,video:a.videoMuted};a&&a.local&&!a.failed&&!l.has(a.getID())?a.hasMedia()?a.isExternal()?function(a,c,d){d=void 0===d?function(){}:d;var e,f;a.url?(e="url",f=a.url):(e="recording",f=a.recording);b.a.info("Checking publish options for",a.getID());a.checkOptions(c);h.sendSDP("publish",A(e,
a,c),f,function(b,c){C(b,a,c,d)})}(a,c,d):g.p2p?function(a,b,c){c=void 0===c?function(){}:c;a.maxAudioBW=b.maxAudioBW;a.maxVideoBW=b.maxVideoBW;h.sendSDP("publish",A("p2p",a,b),void 0,function(b,d){C(b,a,d,c)})}(a,c,d):D(a,c,d):a.hasData()&&function(a,b,c){c=void 0===c?function(){}:c;h.sendSDP("publish",A("data",a,b),void 0,function(b,d){C(b,a,d,c)})}(a,c,d):(b.a.error("Trying to publish invalid stream"),d(void 0,"Invalid Stream"))},g.startRecording=function(a,c){c=void 0===c?function(){}:c;if(void 0===
a)return b.a.error("Trying to start recording on an invalid stream",a),void c(void 0,"Invalid Stream");b.a.debug("Start Recording stream: "+a.getID());h.sendMessage("startRecorder",{to:a.getID()},function(a,d){if(null===a)return b.a.error("Error on start recording",d),void c(void 0,d);b.a.info("Start recording",a);c(a)})},g.stopRecording=function(a,c){c=void 0===c?function(){}:c;h.sendMessage("stopRecorder",{id:a},function(d,e){if(null===d)return b.a.error("Error on stop recording",e),void c(void 0,
e);b.a.info("Stop recording",a);c(!0)})},g.unpublish=function(a,c){c=void 0===c?function(){}:c;if(a&&a.local){if(h.sendMessage("unpublish",a.getID(),function(d,e){if(null===d)return b.a.error("Error unpublishing stream",e),void c(void 0,e);delete a.failed;c(!0)}),b.a.info("Stream unpublished"),a.room=void 0,a.hasMedia()&&!a.isExternal()){var d=l.has(a.getID())?l.get(a.getID()):a;n(d)}l.remove(a.getID());a.getID=function(){};a.off("internal-send-data",w);a.off("internal-set-attributes",B)}else b.a.error("Cannot unpublish, stream does not exist or is not local"),
c(void 0,"Cannot unpublish, stream does not exist or is not local")},g.sendControlMessage=function(a,b,c){a&&a.getID()&&(b={type:"control",action:c},h.sendSDP("signaling_message",{streamId:a.getID(),msg:b}))},g.subscribe=function(a,c,d){c=void 0===c?{}:c;d=void 0===d?function(){}:d;if(!a||a.local||a.failed)c="Error on subscribe",a?a.local?(b.a.warning("Cannot subscribe to local stream, you should subscribe to the remote version of your local stream"),c="Local copy of stream"):a.failed&&(b.a.warning("Cannot subscribe to failed stream."),
c="Failed stream"):(b.a.warning("Cannot subscribe to invalid stream"),c="Invalid or undefined stream"),d(void 0,c);else{if(a.hasMedia())a.hasVideo()||a.hasScreen()||(c.video=!1),a.hasAudio()||(c.audio=!1),c.muteStream={audio:a.audioMuted,video:a.videoMuted},a.forceTurn=c.forceTurn,g.p2p?(h.sendSDP("subscribe",{streamId:a.getID(),metadata:c.metadata}),d(!0)):E(a,c,d);else{if(!a.hasData()||!1===c.data)return b.a.warning("There's nothing to subscribe to"),void d(void 0,"Nothing to subscribe to");(function(a,
c,d){d=void 0===d?function(){}:d;h.sendSDP("subscribe",{streamId:a.getID(),data:c.data,metadata:c.metadata},void 0,function(c,e){if(null===c)return b.a.error("Error subscribing to stream ",e),void d(void 0,e);b.a.info("Stream subscribed");c=y({type:"stream-subscribed",stream:a});g.dispatchEvent(c);d(!0)})})(a,c,d)}b.a.info("Subscribing to: "+a.getID())}},g.unsubscribe=function(a,c){c=void 0===c?function(){}:c;void 0!==h&&a&&!a.local&&h.sendMessage("unsubscribe",a.getID(),function(b,d){null!==b?(n(a),
delete a.failed,c(!0)):c(void 0,d)},function(){b.a.error("Error calling unsubscribe.")})},g.getStreamStats=function(a,b){b=void 0===b?function(){}:b;return h?a?void h.sendMessage("getStreamStats",a.getID(),function(a){a&&b(a)}):"Error getting stats - no stream":"Error getting stats - no socket"},g.getStreamsByAttribute=function(a,b){var c=[];return k.forEach(function(d){void 0!==d.getAttributes()&&d.getAttributes()[a]===b&&c.push(d)}),c},g.on("room-disconnected",function(){g.state=0;h.state=h.DISCONNECTED;
k.forEach(function(a,b){if(n(a),k.remove(b),a&&!a.failed)a=y({type:"stream-removed",stream:a}),g.dispatchEvent(a)});k=x();l.forEach(function(a,b){n(a);l.remove(b)});l=x();try{h.disconnect()}catch(Q){b.a.debug("Socket already disconnected")}h=void 0}),h.on("onAddStream",a.bind(null,function(a){if(!k.has(a.id)){var b=K(g.Connection,{streamID:a.id,local:l.has(a.id),audio:a.audio,video:a.video,data:a.data,label:a.label,screen:a.screen,attributes:a.attributes});b.room=g;k.add(a.id,b);a=y({type:"stream-added",
stream:b});g.dispatchEvent(a)}})),h.on("signaling_message_erizo",a.bind(null,function(a){var b;(b=a.peerId?k.get(a.peerId):l.get(a.streamId))&&b.pc&&!b.failed&&b.pc.processSignalingMessage(a.mess)})),h.on("signaling_message_peer",a.bind(null,function(a){var c=l.get(a.streamId);c&&!c.failed?c.pc.get(a.peerSocket).processSignalingMessage(a.msg):((c=k.get(a.streamId)).pc||function(a,c){a.addPC(g.erizoConnectionManager.getOrBuildErizoConnection(r(a,c)));a.on("added",q.bind(null,a));a.on("icestatechanged",
function(c){b.a.info(a.getID()+" - iceConnectionState: "+c.msg.state);"failed"===c.msg.state&&p(a)})}(c,a.peerSocket),c.pc.processSignalingMessage(a.msg))})),h.on("publish_me",a.bind(null,function(a){(function(a,c){var d=g.erizoConnectionManager.getOrBuildErizoConnection(r(a,c));a.addPC(d,c);a.on("icestatechanged",function(d){b.a.info(a.getID()+" - iceConnectionState: "+d.msg.state);"failed"===d.msg.state&&(a.pc.get(c).close(),a.pc.remove(c))});d.addStream(a);d.createOffer()})(l.get(a.streamId),a.peerSocket)})),
h.on("unpublish_me",a.bind(null,function(a){var b=l.get(a.streamId);b&&(a=a.peerSocket,void 0!==b.pc&&b.pc.has(a)&&(b.pc.get(a).close(),b.pc.remove(a)))})),h.on("onBandwidthAlert",a.bind(null,function(a){if(b.a.info("Bandwidth Alert on",a.streamID,"message",a.message,"BW:",a.bandwidth),a.streamID){var c=k.get(a.streamID);c&&!c.failed&&(a=y({type:"bandwidth-alert",stream:c,msg:a.message,bandwidth:a.bandwidth}),c.dispatchEvent(a))}})),h.on("onDataStream",a.bind(null,function(a){var b=k.get(a.id);a=
y({type:"stream-data",msg:a.msg,stream:b});b.dispatchEvent(a)})),h.on("onUpdateAttributeStream",a.bind(null,function(a){var b=k.get(a.id),c=y({type:"stream-attributes-update",attrs:a.attrs,stream:b});b.updateLocalAttributes(a.attrs);b.dispatchEvent(c)})),h.on("onRemoveStream",a.bind(null,function(a){var b=l.get(a.id);if(b)p(b);else if(b=k.get(a.id))n(b),k.remove(a.id),a=y({type:"stream-removed",stream:b}),g.dispatchEvent(a)})),h.on("disconnect",a.bind(null,function(){if(b.a.info("Socket disconnected, lost connection to ErizoController"),
0!==g.state){b.a.error("Unexpected disconnection from ErizoController");var a=u({type:"room-disconnected",message:"unexpected-disconnection"});g.dispatchEvent(a)}})),h.on("connection_failed",a.bind(null,function(a){if(a.streamId){var c="ICE Connection Failed on "+a.type+" "+a.streamId+" "+g.state;b.a.error(c);a="publish"===a.type?l.get(a.streamId):k.get(a.streamId);p(a,c)}})),h.on("error",a.bind(null,function(a){b.a.error("Cannot connect to erizo Controller");a=u({type:"room-error",message:a});g.dispatchEvent(a)})),
g}.bind(null,void 0,void 0,void 0),LicodeEvent:q,RoomEvent:u,StreamEvent:y,Stream:K.bind(null,void 0),Logger:b.a};n.default=h}]).default;
//# sourceMappingURL=erizo.js.map
